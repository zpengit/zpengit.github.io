<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>ZpengBlog</title>
  
  <subtitle>Java</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://zpengit.github.io/"/>
  <updated>2020-06-11T10:46:36.649Z</updated>
  <id>https://zpengit.github.io/</id>
  
  <author>
    <name>Zpeng</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>14-springmvc框架</title>
    <link href="https://zpengit.github.io/2020/06/11/14-springmvc%E6%A1%86%E6%9E%B6/"/>
    <id>https://zpengit.github.io/2020/06/11/14-springmvc%E6%A1%86%E6%9E%B6/</id>
    <published>2020-06-11T10:53:07.908Z</published>
    <updated>2020-06-11T10:46:36.649Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="14-springmvc框架"><a href="#14-springmvc框架" class="headerlink" title="14-springmvc框架"></a>14-springmvc框架</h1><h1 id="unit14-springmvc框架"><a href="#unit14-springmvc框架" class="headerlink" title="unit14-springmvc框架"></a>unit14-springmvc框架</h1><h2 id="MVC设计模式"><a href="#MVC设计模式" class="headerlink" title="MVC设计模式"></a>MVC设计模式</h2><h3 id="什么是设计模式"><a href="#什么是设计模式" class="headerlink" title="什么是设计模式"></a>什么是设计模式</h3><p>设计模式（Design Pattern）是一套被反复使用、多数人知晓的、经过分类的、代码设计经验的总结。</p><p>使用设计模式的目的：为了代码可重用性、让代码更容易被他人理解、保证代码可靠性。</p><p>设计模式使代码编写真正工程化；</p><p>设计模式是软件工程的基石脉络，如同大厦的结构一样。</p><p>设计模式就是一种模子，经过多年实践锤炼形成一套行之有效的完成某个特定任务的步骤和方式。</p><p>例如：西凤酒的酿造过程，酿造工序，前后不能变，温差不能变，这样做就是好喝，稍微改动就变味道了。</p><p>再如，北京烤鸭，就是那样做，就是那些调料腌制，变量配比，味道口感就是不如人家。</p><h3 id="MVC设计模式-1"><a href="#MVC设计模式-1" class="headerlink" title="MVC设计模式"></a>MVC设计模式</h3><p>MVC设计模式是一种通用的软件编程思想</p><p>在MVC设计模式中认为, 任何软件都可以分为三部分组成：</p><p>(1)控制程序流转的控制器（<strong>Controller</strong>）</p><p>(2)封装数据处理数据的模型（<strong>Model</strong>）</p><p>(3)负责展示数据的视图（<strong>view</strong>）</p><p>并且在MVC设计思想中要求一个符合MVC设计思想的软件应该保证上面这三部分相互独立，互不干扰，每一个部分只负责自己擅长的部分。</p><p>如果某一个模块发生变化，应该尽量做到不影响其他两个模块。这样做的好处是，软件的结构会变得更加的清晰，可读性强。有利于后期的扩展和维护，并且代码可以实现复用。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/20e60e831a34d3a4a68805e386aa1779-8fa3ff93261c49cb9f4a0c0e2c6a9c89.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-f2a1029f89277d189d598d1a3351a6e0.png" alt="20e60e831a34d3a4a68805e386aa1779"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/20e60e831a34d3a4a68805e386aa1779-8fa3ff93261c49cb9f4a0c0e2c6a9c89.png" target="_blank" rel="noopener">20e60e831a34d3a4a68805e386aa1779</a></p><h2 id="初识SpringMVC"><a href="#初识SpringMVC" class="headerlink" title="初识SpringMVC"></a>初识SpringMVC</h2><h3 id="Servlet的缺点"><a href="#Servlet的缺点" class="headerlink" title="Servlet的缺点"></a>Servlet的缺点</h3><p>1、通常情况下，一个Servlet类只负责处理一个请求，若项目中有成百上千个请求需要处理，就需要有成百上千个Servlet类，这样会使得项目中Servlet类的个数暴增；</p><p>2、在Servlet3.0版本之前，每一个Servlet都需要在web.xml文件中至少做八行配置信息，配置内容多且繁琐。当Servlet特别多时，web.xml配置量太多，不利于团队开发；</p><p>3、当通过客户端提交参数到服务器，通过Servlet进行接收时，无论数据本身是什么格式，在Servlet中一律按照字符串进行接收，后期需要进行类型转换，复杂类型还需要特殊处理，特别麻烦！</p><p><code>String value = request.getParameter(String name);</code></p><p>4、servlet具有容器依赖性，必须放在服务器中运行，不利于单元测试；</p><p>…</p><h3 id="SpringMVC简介"><a href="#SpringMVC简介" class="headerlink" title="SpringMVC简介"></a>SpringMVC简介</h3><p>Springmvc是spring框架的一个模块，spring和springmvc无需中间整合层整合</p><p>Springmvc是一个基于mvc的web框架</p><h3 id="spring执行原理"><a href="#spring执行原理" class="headerlink" title="spring执行原理"></a>spring执行原理</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/14c0c2f53620fb0e29c11170729226f0-538d782aedbf4211884c882e14452a89.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-30637a43c8bd13b1a4158087ee462ebe.png" alt="14c0c2f53620fb0e29c11170729226f0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/14c0c2f53620fb0e29c11170729226f0-538d782aedbf4211884c882e14452a89.png" target="_blank" rel="noopener">14c0c2f53620fb0e29c11170729226f0</a></p><p><code>(1)</code>.用户发送请求 至 前端控制器(DispatcherServlet)；</p><p>提示：DispatcherServlet的作用：接收请求，调用其它组件处理请求，响应结果，相当于转发器、中央处理器，是整个流程控制的中心</p><p><code>(2)</code>.前端控制器(DispatcherServlet)收到请求后调用处理器映射器(HandlerMapping)</p><p>处理器映射器(HandlerMapping)找到具体的Controller(可以根据xml配置、注解进行查找)，并将Controller返回给DispatcherServlet；</p><p><code>(3)</code>.前端控制器(DispatcherServlet)调用处理器适配器(HandlerAdapter)。处理器适配器经过适配调用具体的Controller；(Controller–&gt; service –&gt; Dao –&gt; 数据库)</p><p>Controller执行完成后返回ModelAndView，</p><p>提示：Model(模型数据，即Controller处理的结果，Map) View(逻辑视图名，即负责展示结果的JSP页面的名字)</p><p>处理器适配器(HandlerAdapter)将controller执行的结果(ModelAndView)返回给前端控制器(DispatcherServlet)；</p><p><code>(4)</code>.前端控制器(DispatcherServlet)将执行的结果(ModelAndView)传给视图解析器(ViewReslover)</p><p>视图解析器(ViewReslover)根据View(逻辑视图名)解析后返回具体JSP页面</p><p><code>(5)</code>.前端控制器(DispatcherServlet)根据Model对View进行渲染（即将模型数据填充至视图中）；</p><p>前端控制器(DispatcherServlet)将填充了数据的网页响应给用户。</p><p>其中整个过程中需要开发人员编写的部分有<strong>Controller</strong>、<strong>Service</strong>、<strong>Dao</strong>、<strong>View；</strong></p><h2 id="springmvc入门案例"><a href="#springmvc入门案例" class="headerlink" title="springmvc入门案例"></a>springmvc入门案例</h2><p><strong>需求：</strong></p><p>(1)通过浏览器访问 <code>http://localhost/项目名称/hello</code> 地址，在控制台输出 “hello springmvc”</p><p>(2)将请求转向（跳转到） <code>/WEB-INF/pages/home.jsp</code> 页面</p><h3 id="创建Maven—web工程"><a href="#创建Maven—web工程" class="headerlink" title="创建Maven—web工程"></a>创建Maven—web工程</h3><p><strong>1、通过Maven创建web工程</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410140300719-6e66072b3b254abd9a1fd24645f05b73.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-e70576f4af6be4def179a56ff597d2dd.png" alt="image-20200410140300719"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410140300719-6e66072b3b254abd9a1fd24645f05b73.png" target="_blank" rel="noopener">image-20200410140300719</a></p><p><strong>2、在pom.xml中引入springmvc所需jar包</strong>：将下面的配置直接拷贝到pom.xml中的根标签内</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 单元测试 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- SpringMVC的jar包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- servlet 和 jsp的jar包 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- java对象转换json的工具类 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="在web-xml中配置前端控制器"><a href="#在web-xml中配置前端控制器" class="headerlink" title="在web.xml中配置前端控制器"></a>在web.xml中配置前端控制器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span></span></span><br><span class="line"><span class="tag"><span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"2.5"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置springmvc前端控制器, 将所有请求交给springmvc来处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 配置springmvc核心配置文件的位置，默认Springmvc的配置文件是在WEB-INF目录下，默认的名字为springmvc-servlet.xml，如果要放在其他目录，则需要指定如下配置：</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-config.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 其中的斜杠（/）表示拦截所有请求（除JSP以外）, 所有请求都要经过springmvc前端控制器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建并配置springmvc-config-xml"><a href="#创建并配置springmvc-config-xml" class="headerlink" title="创建并配置springmvc-config.xml"></a>创建并配置springmvc-config.xml</h3><p>直接复制下面配置文件的内容即可！</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xmlns:mvc</span>=<span class="string">"http://www.springframework.org/schema/mvc"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">          http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 1.配置前端控制器放行静态资源(html/css/js等，否则静态资源将无法访问) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.配置注解驱动，用于识别注解（比如@Controller） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 3.配置需要扫描的包：spring自动去扫描 base-package 下的类，</span></span><br><span class="line"><span class="comment">如果扫描到的类上有 @Controller、@Service、@Component等注解，</span></span><br><span class="line"><span class="comment">将会自动将类注册为bean </span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.tedu.controller"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 4.配置内部资源视图解析器</span></span><br><span class="line"><span class="comment">prefix:配置路径前缀</span></span><br><span class="line"><span class="comment">suffix:配置文件后缀</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/pages/"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建并实现HelloController类"><a href="#创建并实现HelloController类" class="headerlink" title="创建并实现HelloController类"></a>创建并实现HelloController类</h3><p>1、创建com.tedu.controller.HelloController类</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411120818696-f7d9e3c7def24f588bfbc480e66c789a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-e45fe176815c39e440df078922ef67a2.png" alt="image-20200411120818696"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411120818696-f7d9e3c7def24f588bfbc480e66c789a.png" target="_blank" rel="noopener">image-20200411120818696</a></p><p>2、实现HelloController类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* @Controller作用: 表示当前类属于controller层</span></span><br><span class="line"><span class="comment"> * 同时标识将当前类的对象的创建交给spring容器负责</span></span><br><span class="line"><span class="comment"> * http://localhost/day16-springmvc/hello</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"><span class="comment">/* @RequestMapping("/hello") 用于配置当前方法的访问路径，不能省略，且不能重复！</span></span><br><span class="line"><span class="comment"> * @RequestMapping注解在当前方法上声明的访问路径, 在当前controller类中不能重复！</span></span><br><span class="line"><span class="comment"> * 如果controller类上没有访问路径，当前方法上的访问路径在所有controller类中都不能重复！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>) </span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println( <span class="string">"hello springmvc...."</span> );</span><br><span class="line"><span class="comment">//跳转到哪一个路径/WEB-INF/pages/home.jsp</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建并实现home-jsp"><a href="#创建并实现home-jsp" class="headerlink" title="创建并实现home.jsp"></a>创建并实现home.jsp</h3><p>在WEB-INF/pages/目录下，创建home.jsp页面。</p><p><strong>WEB-INF/pages/home.jsp</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%@</span> <span class="attr">page</span> <span class="attr">pageEncoding</span>=<span class="string">"UTF-8"</span>%&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>day16-springmvc...home.jsp....<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="访问测试"><a href="#访问测试" class="headerlink" title="访问测试"></a>访问测试</h3><p>打开浏览器，输入url地址：<a href="http://localhost/day16-springmv/hello" target="_blank" rel="noopener">http://localhost/day16-springmv/hello</a> 地址，访问结果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411120516046-6d83f83ba59c4d99b06214d826d2c94a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-56f65bacc7467b41fa4824a7bcd73d61.png" alt="image-20200411120516046"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411120516046-6d83f83ba59c4d99b06214d826d2c94a.png" target="_blank" rel="noopener">image-20200411120516046</a></p><h2 id="springmvc参数绑定"><a href="#springmvc参数绑定" class="headerlink" title="springmvc参数绑定"></a>springmvc参数绑定</h2><p>当项目中引入springmvc框架后，所有的请求流转将由springmvc进行控制，当客户端发送的请求中包含数据（也就是请求参数）时，那么该如何在controller层获取这些参数呢？</p><p>springmvc会自动的将请求中包含的参数和方法的参数进行匹配，也就是说只要保证，请求中的参数名称和方法中的参数名称相对应（另，参数的格式也要正确），在方法中就可以使用这些参数—即请求中的参数。</p><h3 id="基本类型参数绑定"><a href="#基本类型参数绑定" class="headerlink" title="基本类型参数绑定"></a>基本类型参数绑定</h3><p>当需要获取客户端发送过来的少量数据时，可以在Controller中声明的方法上，通过声明方法参数对这些参数一个一个进行接收，具体示例如下：</p><p><strong>需求：通过浏览器发请求访问Controller，并在请求中携带name、age数据访问服务器，在服务器端的<br>Controller中获取这些数据。</strong></p><p>1、在HelloController类中添加testParam1方法，用于接收基本类型的参数，代码实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span> <span class="comment">/* 这个注解表示当前类是属于控制层 */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 1、测试springmvc的简单类型参数绑定</span></span><br><span class="line"><span class="comment"> * ../testParam1?name=张飞&amp;age=20&amp;addr=河北</span></span><br><span class="line"><span class="comment"> * 如何获取请求中name、age、addr的参数值？</span></span><br><span class="line"><span class="comment"> * request.getParameter("name") -- 张飞</span></span><br><span class="line"><span class="comment"> * 在方法上添加三个同类型、同名的形参分别为 name、age、addr</span></span><br><span class="line"><span class="comment"> * 用于接收请求中name、age、addr参数的值  */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testParam1"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam1</span><span class="params">(String name, Integer age, String addr)</span> </span>&#123;</span><br><span class="line">System.out.println( <span class="string">"name="</span>+name );</span><br><span class="line">System.out.println( <span class="string">"age="</span>+age );</span><br><span class="line">System.out.println( <span class="string">"addr="</span>+addr );</span><br><span class="line"><span class="keyword">return</span> <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、访问HelloController中的testParam1方法，在访问时，注意将name、age、addr参数一起发送给服务器:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411121233000-10d240d6c7e24a9f93e357baeaa7c7f3.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-1658f5db1f0b6b250d841b77f5c59518.png" alt="image-20200411121233000"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411121233000-10d240d6c7e24a9f93e357baeaa7c7f3.png" target="_blank" rel="noopener">image-20200411121233000</a></p><p>控制台输出结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411121322974-1193a05b4f86423c86d823208e206495.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-aa251f0d93dc2dc20f0881f7f1d05dc5.png" alt="image-20200411121322974"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411121322974-1193a05b4f86423c86d823208e206495.png" target="_blank" rel="noopener">image-20200411121322974</a></p><h3 id="包装类型参数绑定"><a href="#包装类型参数绑定" class="headerlink" title="包装类型参数绑定"></a>包装类型参数绑定</h3><p>当需要获取客户端发送过来的多个数据时，可以在Controller中声明的方法上，通过声明方法参数对这些数据一个一个进行接收较麻烦，可以在方法上声明对象类型的参数，通过对这些数据统一进行接受，springmvc会自动将接收过来的参数封装在对象中，具体示例如下：</p><p>1、在HelloController类中添加param2方法，用于接收对象类型的参数，代码实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span> <span class="comment">/* 这个注解表示当前类是属于控制层 */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 2、测试springmvc的包装类型参数绑定</span></span><br><span class="line"><span class="comment"> * ../testParam2?name=关羽&amp;age=30&amp;addr=北京</span></span><br><span class="line"><span class="comment"> * 如何获取请求中name、age、addr的参数值？</span></span><br><span class="line"><span class="comment"> * 提供一个User类,在类中添加和请求参数同名的属性</span></span><br><span class="line"><span class="comment"> * 底层通过调用setName、setAge、setAddr方法将参数值封装到User对象中 */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testParam2"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam2</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">System.out.println( <span class="string">"user.name="</span>+user.getName() );</span><br><span class="line">System.out.println( <span class="string">"user.age="</span>+user.getAge() );</span><br><span class="line">System.out.println( <span class="string">"user.addr="</span>+user.getAddr() );</span><br><span class="line"><span class="keyword">return</span> <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、创建User类，声明name、age、addr属性，提供对应的set和get方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.pojo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 封装用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Integer age;</span><br><span class="line"><span class="keyword">private</span> String addr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;&#125; <span class="comment">//无参构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, Integer age, String addr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>();</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line"><span class="keyword">this</span>.addr = addr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//get、set方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getAddr</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> addr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddr</span><span class="params">(String addr)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.addr = addr;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、访问HelloController中的param2方法，在访问时，注意将name和age参数一起发送给服务器:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125305873-4802569ff4bd496ca4c640a1f03b80d6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-cea84568f2cbba98f9e8527b62eb9da4.png" alt="image-20200411125305873"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125305873-4802569ff4bd496ca4c640a1f03b80d6.png" target="_blank" rel="noopener">image-20200411125305873</a></p><p>控制台输出结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125340557-3985177bee224b439cefcb867f34f4c0.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-c52609126e62d45a11ce2811bf196387.png" alt="image-20200411125340557"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125340557-3985177bee224b439cefcb867f34f4c0.png" target="_blank" rel="noopener">image-20200411125340557</a></p><h3 id="日期类型参数绑定"><a href="#日期类型参数绑定" class="headerlink" title="日期类型参数绑定"></a>日期类型参数绑定</h3><p>1、在HelloController类中添加testParam3方法，代码实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span> <span class="comment">/* 这个注解表示当前类是属于控制层 */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 3、测试springmvc的日期类型参数绑定</span></span><br><span class="line"><span class="comment"> * ../testParam3?date=2020-4-10 16:40:39报400错误,表示参数类型不匹配</span></span><br><span class="line"><span class="comment"> * ../testParam3?date=2020/4/10 16:40:39</span></span><br><span class="line"><span class="comment"> * 如何获取请求中date参数的值？</span></span><br><span class="line"><span class="comment"> * springmvc默认是以斜杠接收日期类型的参数, 如果提交的日期就是以斜杠</span></span><br><span class="line"><span class="comment"> * 分隔的, springmvc就可以接收这个日期类型的参数, 否则将无法接收</span></span><br><span class="line"><span class="comment"> * 如果提交的日期参数就是以横杠分隔, 也可以修改springmvc默认的接收格式</span></span><br><span class="line"><span class="comment"> * 改为以横杠分隔!!</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testParam3"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testParam3</span><span class="params">(Date date)</span> </span>&#123;</span><br><span class="line">System.out.println( <span class="string">"date="</span>+date );</span><br><span class="line"><span class="keyword">return</span> <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、访问HelloController中的testParam3方法，在访问时，注意将date参数一起发送给服务器:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165200699-49c00d44e2d244a2bd6f45b233860360.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-d8d1b93df478014439abf4448acd6d80.png" alt="image-20200410165200699"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165200699-49c00d44e2d244a2bd6f45b233860360.png" target="_blank" rel="noopener">image-20200410165200699</a></p><p>控制台输出结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165311287-8bb4e105ea42415f84aeaaf4cfae1f80.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-84fac5addd6f626d994b3841b297dc45.png" alt="image-20200410165311287"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165311287-8bb4e105ea42415f84aeaaf4cfae1f80.png" target="_blank" rel="noopener">image-20200410165311287</a></p><p><strong>常见问题：</strong></p><p>1、当访问HelloController中的testParam3方法，如果传递给服务器的日期数据是如下格式：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165410638-dfa2a240c82947c4a6bbbbbe4af4b168.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-0ae0ab066ee57186c59d1adb1cb5ba9a.png" alt="image-20200410165410638"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200410165410638-dfa2a240c82947c4a6bbbbbe4af4b168.png" target="_blank" rel="noopener">image-20200410165410638</a></p><p>从图中可以看出，如果日期参数是 yyyy-MM-dd格式（以横杠分隔）就会出现400错误，其实是因为参数格式匹配错误，由于springmvc默认的日期格式是yyyy/MM/dd（以斜杠分隔），因此如果日期参数不是yyyy/MM/dd 格式，就会出现400错误！！</p><p><strong>2、解决方案：</strong></p><p>在springmvc中，提供了@InitBinder注解，用于指定自定义的日期转换格式，因此，我们只需要在Controller类中添加下面的代码即可，在接受日期类型的参数时，会自动按照自定义的日期格式进行转换。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 自定义日期格式转换器</span></span><br><span class="line"><span class="comment"> * 将springmvc默认以斜杠(/)分隔日期改为以横杠分隔(-)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@InitBinder</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InitBinder</span> <span class="params">(ServletRequestDataBinder binder)</span></span>&#123;</span><br><span class="line">binder.registerCustomEditor(java.util.Date<span class="class">.<span class="keyword">class</span>, </span></span><br><span class="line">new CustomDateEditor(new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"), true)</span><br><span class="line">);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、再次测试：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125752937-1a79d343c639415e9545ffd4f4e91e78.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-f82616e37dd8cf2885b82edcce9d8172.png" alt="image-20200411125752937"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125752937-1a79d343c639415e9545ffd4f4e91e78.png" target="_blank" rel="noopener">image-20200411125752937</a></p><p>控制台输出结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125827915-60033b5caefe4bcfa949c121ca7b817a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-44d0fe587abb9e26661bace1f076dc4e.png" alt="image-20200411125827915"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125827915-60033b5caefe4bcfa949c121ca7b817a.png" target="_blank" rel="noopener">image-20200411125827915</a></p><h2 id="跳转和乱码处理"><a href="#跳转和乱码处理" class="headerlink" title="跳转和乱码处理"></a>跳转和乱码处理</h2><h3 id="实现转发-forward"><a href="#实现转发-forward" class="headerlink" title="实现转发(forward)"></a>实现转发(forward)</h3><p>在前面request对象的学习中，通过request对象可以实现请求转发（即资源的跳转）。同样的，springmvc也提供了请求转发的方式，具体实现如下：</p><p>需求：通过浏览器访问 testForward方法，执行testForward方法后，将请求转发到（HelloController）hello， 也就是home.jsp页面。</p><p>1、在HelloController中，提供testForward方法，代码实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 测试请求转发(forward) */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"testForward"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testForward</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"测试请求转发(forward)..."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"forward:hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、打开浏览器，在浏览器中输入：<a href="http://localhost/day16-springmvc/testForward" target="_blank" rel="noopener">http://localhost/day16-springmvc/testForward</a>地址，访问效果如下:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125952494-b6801772df9749cba6ac298f1d77483a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-1380b418ac5c1f329f77e6578a5f6174.png" alt="image-20200411125952494"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411125952494-b6801772df9749cba6ac298f1d77483a.png" target="_blank" rel="noopener">image-20200411125952494</a></p><p>forward方式相当于:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getRequestDispatcher(<span class="string">"url"</span>).forward(request,response);</span><br></pre></td></tr></table></figure><p>转发是一次请求，一次响应；</p><p>转发后地址栏地址没有发生变化（还是访问testForward的地址）；</p><p>转发前后的request和response对象也是同一个。</p><h3 id="实现重定向-redirect"><a href="#实现重定向-redirect" class="headerlink" title="实现重定向(redirect)"></a>实现重定向(redirect)</h3><p>在前面response对象的学习中，通过response对象可以实现请求重定向（即资源的跳转）。</p><p>同样的，springmvc也提供了请求重定向的方式，具体实现如下：</p><p>需求：通过浏览器访问 testRedirect方法，执行testRedirect方法后，将请求重定向到<br>（HelloController）hello， 也就是home.jsp页面。</p><p>1、在HelloController中，提供testRedirect方法，代码实现如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 测试请求重定向(redirect) */</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"testRedirect"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRedirect</span><span class="params">()</span></span>&#123;</span><br><span class="line">System.out.println(<span class="string">"测试请求重定向(redirect)..."</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"redirect:hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、打开浏览器，在浏览器中输入：<a href="http://localhost/day16-springmvc/testRedirect" target="_blank" rel="noopener">http://localhost/day16-springmvc/testRedirect</a>地址，访问效果如下:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411130114886-65e5e03a1f254560b16b8f6ba52aea88.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-5907e799f51f6f3af14098486e0a99cb.png" alt="image-20200411130114886"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200411130114886-65e5e03a1f254560b16b8f6ba52aea88.png" target="_blank" rel="noopener">image-20200411130114886</a></p><p>redirect方式相当于：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(url);</span><br></pre></td></tr></table></figure><p>重定向是两次请求，两次响应；</p><p>重定向后地址栏地址发生了变化(变为转发后的地址)；</p><p>并且在重定向前后，request和response对象不是同一个。</p><h3 id="乱码处理"><a href="#乱码处理" class="headerlink" title="乱码处理"></a>乱码处理</h3><p>在前面的Servlet学习中，我们学习了GET和POST请求参数乱码如何解决。</p><p>springmvc也提供了解决请求参数乱码的方案，就是在web.xml中加入如下代码（配置请求参数乱码过滤器），可以解决POST提交的中文参数乱码问题！</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置过滤器,解决POST提交的中文参数乱码问题 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>encodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Servlet中，两种请求方式乱码解决方案回顾：</p><p>(1)如果请求方式为<strong>POST</strong>提交，必然会出现乱码，解决方式是在任何获取参数的代码之前，添加如下代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br></pre></td></tr></table></figure><p>(2)如果请求方式为<strong>GET</strong>提交，tomcat8及之后的版本已经解决了GET提交的中文参数乱码问题，因此不需要处理；在 tomcat7 及之前的版本中，获取GET提交的中文参数仍有乱码，解决方法是：只需要在[tomcat]/conf/server.xml中添加如下配置也可以解决乱码问题。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/31a1d635302b07dcec001a8cb8a27a4f-f8f8aa790a02496d876fc80adc1f87b8.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-80af1d45db50e1f6aca07e4f7685f0c1.png" alt="31a1d635302b07dcec001a8cb8a27a4f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/31a1d635302b07dcec001a8cb8a27a4f-f8f8aa790a02496d876fc80adc1f87b8.png" target="_blank" rel="noopener">31a1d635302b07dcec001a8cb8a27a4f</a></p><h2 id="springmvc响应数据"><a href="#springmvc响应数据" class="headerlink" title="springmvc响应数据"></a>springmvc响应数据</h2><h3 id="Model的使用"><a href="#Model的使用" class="headerlink" title="Model的使用"></a>Model的使用</h3><p>当请求发起访问Controller中的方法时，可以通过参数声明，在方法内使用Model。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/doorList"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">doorList</span><span class="params">(Model model)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>Model对象实际上是一个Map集合，例如：往model中添加一个属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.addAttribute(String name, Object value);</span><br></pre></td></tr></table></figure><p>其中，addAttribute方法会将属性保存到request域中，再通过转发将属性数据带到相应的JSP中，通过${}取出并显示。</p><p>示例，往Model中添加属性：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/testModel"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testModel</span><span class="params">(Model model)</span></span>&#123;</span><br><span class="line"><span class="comment">/* 往Model添加属性 */</span></span><br><span class="line">model.addAttribute(<span class="string">"name"</span>, <span class="string">"马云"</span>);</span><br><span class="line">model.addAttribute(<span class="string">"age"</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"home"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在home.jsp中取出属性并显示：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello springmvc~~~<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">$&#123; name &#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">$&#123; age &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><h3 id="springmvc前端控制器放行静态资源的解决办法"><a href="#springmvc前端控制器放行静态资源的解决办法" class="headerlink" title="springmvc前端控制器放行静态资源的解决办法"></a>springmvc前端控制器放行静态资源的解决办法</h3><p>在配置SpringMVC开发环境时，会在web.xml文件中配置SpringMVC的前端控制器，将所有请求交给前端控制器处理，因此在url-pattern中配置了斜杠（/）:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1.配置springmvc前端控制器, 并将所有请求交给springmvc处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置springmvc核心配置文件的位置，默认Springmvc的配置文件是在WEB-INF目录下，默认的名字为springmvc-servlet.xml，如果要放在其他目录，则需要指定如下配置：</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc-config.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 斜杠表示拦截所有请求（除JSP以外） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>url-pattern中配置的斜杠（/）表示将除了JSP以外的其他请求都拦截下来，交给spring的前端控制器来处理。</p><p>但是这样配置，会将对静态资源的访问也拦截下来，导致访问静态资源时，出现404（资源找不到），因为spring的前端控制器将对静态资源的访问也当成了一个controller请求，去配置对应的映射路径，这当然找不到。</p><p>比如访问：<a href="http://localhost/day15-springmvc/home.html" target="_blank" rel="noopener">http://localhost/day15-springmvc/home.html</a>，由于配置的是斜杠（/），所以此时会拦截静态资源，到controller中匹配路径为/home.html的方法，此时自然是匹配不到的。</p><p>如果需要访问到静态资源，让前端控制器对静态资源的请求放行。此时可以在springmvc-config.xml文件中添加放行静态资源的配置:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1.配置前端控制器放行静态资源(html/css/js等，否则静态资源将无法访问) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="applicationContext-xml没有提示的解决方法"><a href="#applicationContext-xml没有提示的解决方法" class="headerlink" title="applicationContext.xml没有提示的解决方法"></a>applicationContext.xml没有提示的解决方法</h3><p>1、配置spring-beans-4.1.xsd文件</p><p>(1)找到spring-beans-4.1.xsd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3526b8f7cb18db7def8c59c6b8f5a8c6-ffa1a72b2f064feaa2f6827a9baa26db.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-749b06b8e357308ef7d085b0e25e9e86.png" alt="3526b8f7cb18db7def8c59c6b8f5a8c6"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3526b8f7cb18db7def8c59c6b8f5a8c6-ffa1a72b2f064feaa2f6827a9baa26db.png" target="_blank" rel="noopener">3526b8f7cb18db7def8c59c6b8f5a8c6</a></p><p>(2)复制下面的url地址：</p><p><a href="http://www.springframework.org/schema/beans/spring-beans-4.0.xsd" target="_blank" rel="noopener">http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</a></p><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ]</p><p>XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-9e686056fb2642589f8dca20b73e4efc.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-b49a7e7646df9cc3d447c014e24a61b3.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-9e686056fb2642589f8dca20b73e4efc.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/10a6f5e3901af4d2fd9cba0d644e00bd-113bea79f0ec4812b46dd20dd3031b2e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-92e920b98046ad4c27e44a1be155bac7.png" alt="10a6f5e3901af4d2fd9cba0d644e00bd"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/10a6f5e3901af4d2fd9cba0d644e00bd-113bea79f0ec4812b46dd20dd3031b2e.png" target="_blank" rel="noopener">10a6f5e3901af4d2fd9cba0d644e00bd</a></p><p>2、配置spring-context-4.0.xsd文件</p><p>(1)找到spring-context-4.0.xsd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f88878c81816bfccdaf534b48ecbf37d-e69940eaa4574e7ca19eca368e72be02.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-a6b69131e4100b7bdb04ba56af579c0f.png" alt="f88878c81816bfccdaf534b48ecbf37d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f88878c81816bfccdaf534b48ecbf37d-e69940eaa4574e7ca19eca368e72be02.png" target="_blank" rel="noopener">f88878c81816bfccdaf534b48ecbf37d</a></p><p>(2)复制下面的url地址：</p><p><a href="http://www.springframework.org/schema/context/spring-context-4.0.xsd" target="_blank" rel="noopener">http://www.springframework.org/schema/context/spring-context-4.0.xsd</a></p><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ]</p><p>XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-9e686056fb2642589f8dca20b73e4efc.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-b49a7e7646df9cc3d447c014e24a61b3.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-9e686056fb2642589f8dca20b73e4efc.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bab1eb1bf264e64de4a3672c96f23e8b-d98e8d94be54439ea263bd207d76a0ff.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871282-0149e70d411f76ba3fce4c8f33f9e4ac.png" alt="bab1eb1bf264e64de4a3672c96f23e8b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bab1eb1bf264e64de4a3672c96f23e8b-d98e8d94be54439ea263bd207d76a0ff.png" target="_blank" rel="noopener">bab1eb1bf264e64de4a3672c96f23e8b</a></p><h1 id="springmvc-javaweb"><a href="#springmvc-javaweb" class="headerlink" title="springmvc   javaweb"></a><a href="https://www.zhangpeng.fun/tags/springmvc" target="_blank" rel="noopener">springmvc</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="springmvc" scheme="https://zpengit.github.io/tags/springmvc/"/>
    
  </entry>
  
  <entry>
    <title>13-spring框架</title>
    <link href="https://zpengit.github.io/2020/06/11/13-spring%E6%A1%86%E6%9E%B6/"/>
    <id>https://zpengit.github.io/2020/06/11/13-spring%E6%A1%86%E6%9E%B6/</id>
    <published>2020-06-11T10:53:03.475Z</published>
    <updated>2020-06-11T10:46:22.492Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="13-spring框架"><a href="#13-spring框架" class="headerlink" title="13-spring框架"></a>13-spring框架</h1><h1 id="unit13-spring框架"><a href="#unit13-spring框架" class="headerlink" title="unit13-spring框架"></a>unit13-spring框架</h1><h2 id="spring简介"><a href="#spring简介" class="headerlink" title="spring简介"></a>spring简介</h2><h3 id="什么是Spring？"><a href="#什么是Spring？" class="headerlink" title="什么是Spring？"></a>什么是Spring？</h3><p>spring是分层的JavaSE及JavaEE应用于全栈的轻量级开源框架，以IoC（Inverse Of Control：控制反转/反转控制）和AOP（Aspact Oriented Programming：面向切面编程）为核心，提供了表现层SpringMVC和持久层Spring<br>JDBC以及业务层事务管理等众多模块的企业级应用技术，还能整合开源世界中众多著名的第三方框架和类库，逐渐成为使用最多的JavaEE企业应用开源框架。</p><p>SSH(struts2 spring hibernate)</p><p>SSM(springmvc spring mybatis)</p><p>Spring的本质是管理软件中的对象，即<strong>创建对象</strong>和<strong>维护对象之间的关系</strong></p><h3 id="Spring的发展历程"><a href="#Spring的发展历程" class="headerlink" title="Spring的发展历程"></a>Spring的发展历程</h3><p>1997 年 IBM提出了EJB 的思想</p><p>1998 年，SUN制定开发标准规范 EJB1.0</p><p>1999 年，EJB1.1 发布</p><p>2001 年，EJB2.0 发布</p><p>2003 年，EJB2.1 发布</p><p>2006 年，EJB3.0 发布</p><p><strong>Rod Johnson</strong> （罗德·约翰逊，spring 之父）</p><blockquote><p>Expert One-to-One J2EE Development without EJB(2004)</p><p>阐述了 J2EE 开发不使用 EJB的解决方式（Spring 雏形）</p></blockquote><p>2017年9月份发布了spring的最新版本<strong>spring 5.0</strong>通用版</p><h3 id="Spring的优势"><a href="#Spring的优势" class="headerlink" title="Spring的优势"></a>Spring的优势</h3><p><strong>1).方便解耦，简化开发</strong></p><p>通过 Spring提供的 IoC容器，可以将对象间的依赖关系交由Spring进行控制，避免硬编码所造成的过度程序耦合。用户也不必再为较为底层的需求编写代码，可以更专注于上层的应用。</p><p><strong>2).AOP 编程的支持</strong></p><p>通过 Spring的 AOP 功能，方便进行面向切面的编程，许多不容易用传统OOP（Object Oriented Programming：面向对象编程） 实现的功能可以通过 AOP 轻松应付。</p><p><strong>3).声明式事务的支持</strong></p><p>可以将我们从单调烦闷的事务管理代码中解脱出来，通过声明式方式灵活的进行事务的管理，提高开发效率和质量。</p><p><strong>4).方便程序的测试</strong></p><p>可以用非容器依赖的编程方式进行几乎所有的测试工作，测试不再是昂贵的操作，而是随手可做的事情。</p><p><strong>5).方便集成各种优秀框架</strong></p><p>Spring可以降低各种框架的使用难度，提供了对各种优秀框架（Struts、Hibernate、Hessian、Quartz等）的直接支持。</p><p><strong>6).降低 JavaEE API 的使用难度。</strong></p><p>Spring对 JavaEE API（如 JDBC、JavaMail、远程调用等）进行了薄薄的封装层，使这些API 的使用难度大为降低。</p><p><strong>7).Spring框架源码是经典学习范例</strong></p><p>Spring的源代码设计精妙、结构清晰、匠心独用，处处体现着大师对Java设计模式灵活运用以及对 Java技术的高深造诣。它的源代码无疑是Java技术的最佳实践的范例。</p><h3 id="spring的架构"><a href="#spring的架构" class="headerlink" title="spring的架构"></a>spring的架构</h3><p>Spring 最初的目标就是要整合一切优秀资源,然后对外提供一个统一的服务。Spring 模块构建在核心容器之上，核心容器定义了创建、配置和管理 bean 的方式，如下图所示：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf0676465991176183ba7d0765728e57-d3f19206246c4d1aae6ee97834a1e32b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-7066b832305efaa261bdc94d58e0c7b1.png" alt="bf0676465991176183ba7d0765728e57"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf0676465991176183ba7d0765728e57-d3f19206246c4d1aae6ee97834a1e32b.png" target="_blank" rel="noopener">bf0676465991176183ba7d0765728e57</a></p><p>组成 Spring 框架的每个模块（或组件）都可以单独存在，或者与其他一个或多个模块联合实现。每个模块的功能如下：</p><table><thead><tr><th></th><th>模块</th><th>说明</th></tr></thead><tbody><tr><td></td><td>核心容器Spring Core</td><td>核心容器，提供Spring框架的基本功能。核心容器的主要组件是BeanFactory，它是工厂模式的实现。BeanFactory 使用控制反转（IOC）模式，将应用程序的配置和依赖性规范与实际的应用程序代码分开。</td></tr><tr><td></td><td>Spring Context</td><td>Spring上下文，是一个配置文件，向 Spring 框架提供上下文信息。Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</td></tr><tr><td></td><td>Spring AOP</td><td>通过配置管理特性，Spring AOP 模块直接将面向切面的编程功能集成到了 Spring 框架中。可以很容易地使 Spring框架管理的任何对象支持AOP。Spring AOP模块为基于 Spring 的应用程序中的对象提供了事务管理服务。通过使用 Spring AOP，就可以将声明性事务管理集成到应用程序中。</td></tr><tr><td></td><td>Spring DAO</td><td>JDBC DAO 抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。Spring DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</td></tr><tr><td></td><td>Spring ORM</td><td>Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具，其中包括JDO、Hibernate和iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</td></tr><tr><td></td><td>Spring Web</td><td>Web上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。所以Spring 框架支持与 Jakarta Struts的集成。Web模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</td></tr><tr><td></td><td>Spring MVC框架</td><td>MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</td></tr></tbody></table><h2 id="程序中的耦合和解耦"><a href="#程序中的耦合和解耦" class="headerlink" title="程序中的耦合和解耦"></a>程序中的耦合和解耦</h2><h3 id="什么是程序的耦合"><a href="#什么是程序的耦合" class="headerlink" title="什么是程序的耦合"></a>什么是程序的耦合</h3><p>耦合性(Coupling)，也叫耦合度，是对模块间关联程度的度量。耦合的强弱取决于模块间接口的复杂性、调用模块的方式以及通过界面传送数据的多少。模块间的耦合度是指模块之间的依赖关系，包括控制关系、调用关系、数据传递关系。<strong>模块间联系越多，其耦合性越强</strong>，同时表明其独立性越差（降低耦合性，可以提高其独立性）。耦合性存在于各个领域，而非软件设计中独有的，但是我们只讨论软件工程中的耦合。</p><p>总结：在软件工程中，<strong>耦合指的就是指对象之间的依赖关系。对象之间的依赖程度越高，耦合度就越高。对象之间的耦合越高，维护成本越高</strong>。因此对象的设计应使类和构件之间的耦合最小。</p><p>降低程序之间的依赖程度，即降低程序之间的耦合度的过程就叫做解耦。</p><p>例如：早期的Jdbc操作中，在注册数据库驱动时，为什么采用的是Class.forName的方式，而不是采用DriverManager.registerDriver的方式?</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJdbc</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//1.注册数据库驱动</span></span><br><span class="line">    <span class="comment">// DriverManager.registerDriver( new Driver() );</span></span><br><span class="line">    Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">    <span class="comment">//2.获取数据库连接</span></span><br><span class="line">    <span class="comment">//3.获取传输器</span></span><br><span class="line">    <span class="comment">//4.发送sql到服务器执行并返回执行结果</span></span><br><span class="line">    <span class="comment">//5.处理结果</span></span><br><span class="line">    <span class="comment">//6.释放资源</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>除了<code>DriverManager.registerDriver</code>会导致驱动注册两次外，更重要的是，如果使用这种方式，JDBC程序就会依赖于数据库的驱动类（MySQL的Driver类），如果后期程序因数据量和性能原因升级到Oracle数据库，就需要修改程序源代码——重新导入新的驱动类，这会增加很多不必要的麻烦！</p><p>而是用<code>Class.forName</code>方式注册驱动，这样的好处是Jdbc程序不再依赖具体的驱动类，即使删除（或不导入）mysql驱动包，程序依然可以编译（当然不可能运行，因为运行时肯定需要依赖驱动）。</p><p>此时类中仅仅是将mysql驱动类的全限定类名写死在程序中（只是一个字符串），可以将这个字符串提取到配置文件中，后期可以通过修改配置文件（而不用修改程序代码）轻松的替换数据库产品。</p><h3 id="工厂模式解耦介绍"><a href="#工厂模式解耦介绍" class="headerlink" title="工厂模式解耦介绍"></a>工厂模式解耦介绍</h3><p>在实际开发中可以将三层（表现层、业务层、持久层）的对象都使用配置文件配置起来，当启动服务器加载应用时，可以通过工厂读取配置文件，根据配置文件中的配置将这些对象创建出来，在接下来使用的时候，直接拿过来使用即可。</p><p>那么，这个负责读取配置文件，根据配置文件创建并返回这些对象的类就是工厂。</p><p>可以通过【工厂+接口+配置文件】的方式解除程序中的耦合。</p><h3 id="工厂模式解耦示例"><a href="#工厂模式解耦示例" class="headerlink" title="工厂模式解耦示例"></a>工厂模式解耦示例</h3><hr><p>解耦程序编写步骤：</p><hr><p>1、创建一个Maven的Java工程（day16-spring）</p><p>2、创建持久层接口和接口实现类</p><blockquote><p>com.tedu.dao.EmpDao （接口）</p></blockquote><blockquote><p>com.tedu.dao.EmpDaoImpl （实现类）</p></blockquote><p>3、创建业务层接口和接口实现类</p><blockquote><p>com.tedu.service.EmpService （接口）</p></blockquote><blockquote><p>com.tedu.service.EmpServiceImpl （实现类）</p></blockquote><p>4、创建表现层测试程序（com.tedu.controller.EmpController）并运行测试程序</p><p>5、通过工程+配置文件+接口（已有）方式解耦</p><blockquote><p>(1)创建工厂类（com.tedu.factory.BeanFactory）并实现</p></blockquote><blockquote><p>(2)提供配置文件，将service接口和dao接口的实现类的全限定类名编写到配置文件中。</p></blockquote><p>6、使用工厂获取service接口和dao接口的实例，替换使用new的方式获取接口的实例。</p><hr><p>详细代码如下：</p><hr><p><strong>1、创建持久层接口（com.tedu.dao.EmpDao）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.dao;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工模块的Dao(持久层)接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpDao</span> </span>&#123;</span><br><span class="line"><span class="comment">/** 添加员工信息 */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEmp</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、创建持久层接口实现类（com.tedu.dao.EmpDaoImpl）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.dao;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工模块的Dao(持久层)接口实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmpDaoImpl</span> <span class="keyword">implements</span> <span class="title">EmpDao</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(</span><br><span class="line"><span class="string">"Dao层的addEmp()方法执行了..成功保存了一条员工信息.."</span></span><br><span class="line">);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3、创建业务层接口（com.tedu.service.EmpService）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.service;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工模块的service(业务层)接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpService</span> </span>&#123;</span><br><span class="line"><span class="comment">/** 添加员工信息 */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEmp</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4、创建业务层接口实现类（com.tedu.service.EmpServiceImpl）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.service;</span><br><span class="line"><span class="keyword">import</span> com.tedu.dao.EmpDao;</span><br><span class="line"><span class="keyword">import</span> com.tedu.dao.EmpDaoImpl;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 员工模块的service(业务层)接口实现类</span></span><br><span class="line"><span class="comment"> * service层 ---&gt; dao层</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmpServiceImpl</span> <span class="keyword">implements</span> <span class="title">EmpService</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 获取Dao接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="keyword">private</span> EmpDao dao = <span class="keyword">new</span> EmpDaoImpl();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addEmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"调用dao层的方法添加员工信息..."</span>);</span><br><span class="line">dao.addEmp();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5、创建表现层测试类（com.tedu.controller.EmpController）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.controller;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> com.tedu.service.EmpService;</span><br><span class="line"><span class="keyword">import</span> com.tedu.service.EmpServiceImpl;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟表现层 </span></span><br><span class="line"><span class="comment"> * controller --&gt; service --&gt; dao</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmpController</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 获取Service接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="keyword">private</span> EmpService service = <span class="keyword">new</span> EmpServiceImpl();</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAddEmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"调用service层的方法添加员工信息..."</span>);</span><br><span class="line">service.addEmp();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的程序中，EmpController中要调用Service层的方法，所以通过new对象的形式获取了EmpService接口子类的实例，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> EmpService service = <span class="keyword">new</span> EmpServiceImpl();</span><br></pre></td></tr></table></figure><p>在EmpService的实现类中要调用Dao层的方法，所以通过new对象的形式获取了EmpDao接口子类的实例，代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> EmpDao dao = <span class="keyword">new</span> EmpDaoImpl();</span><br></pre></td></tr></table></figure><p>如果在上面的程序中将EmpDaoImpl或者EmpServiceImpl移除，会导致其他类中的代码编译错误。此时表现层和业务层，及业务层和持久层之间的依赖程度过高，如果将来替换某一层，很可能会造成其他层无法运行，只能通过修改程序代码保证程序运行，这样依赖就会提高维护成本以及造成不必要的麻烦。</p><p>而在程序中new对象的方式造成了这种程序之间的依赖程度提升，即提升了程序之间的耦合性。</p><p>使用工厂+配置文件+接口解耦代码如下：</p><hr><p>6、创建com.tedu.factory.BeanFactory类，用于创建各个层所需要的对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.factory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ---------------------------------------------------------</span></span><br><span class="line"><span class="comment"> * Bean: 可重用组件(计算机英语)</span></span><br><span class="line"><span class="comment"> * JavaBean：使用Java语言编写的可重用组件，例如：service层、dao层等</span></span><br><span class="line"><span class="comment"> * JavaBean：通常分为业务Bean和实体Bean</span></span><br><span class="line"><span class="comment"> * 业务Bean：处理业务逻辑，service层、dao层</span></span><br><span class="line"><span class="comment"> * 实体Bean：封装数据，例如，为了封装员工信息而编写的Emp实体类.</span></span><br><span class="line"><span class="comment"> * ---------------------------------------------------------</span></span><br><span class="line"><span class="comment"> * 解除耦合:</span></span><br><span class="line"><span class="comment"> * (1)需要提供配置文件，在配置文件中配置service和dao的实现类</span></span><br><span class="line"><span class="comment"> * 配置内容为：唯一标识=实现类的全限定类名（key=value结构）</span></span><br><span class="line"><span class="comment"> * (2)通过工厂读取配置文件中配置的全限定类名，利用反射创建对象。</span></span><br><span class="line"><span class="comment"> * xml配置文件、properties配置文件</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactory</span> </span>&#123;</span><br><span class="line"><span class="comment">//声明一个Properties对象，在静态代码块中对其进行初始化</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Properties prop;</span><br><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//为prop进行实例化</span></span><br><span class="line">prop = <span class="keyword">new</span> Properties();</span><br><span class="line"><span class="comment">//获取配置文件的流对象</span></span><br><span class="line">InputStream in = BeanFactory<span class="class">.<span class="keyword">class</span>.<span class="title">getClassLoader</span>()</span></span><br><span class="line">.getResourceAsStream("config.properties");</span><br><span class="line"><span class="comment">//将配置文件中的内容读取到Properties对象中</span></span><br><span class="line">prop.load( in );</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"初始化Properties对象失败!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据config.xml文件中的key获取对应class类的实例</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> key </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getBean</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">Object bean = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">String className = prop.getProperty( key );</span><br><span class="line">bean = Class.forName(className).newInstance();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bean;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>7、在源码目录下创建一个config.properties文件，文件内容配置如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">EmpService</span>=<span class="string">com.tedu.service.EmpServiceImpl</span></span><br><span class="line"><span class="attr">EmpDao</span>=<span class="string">com.tedu.dao.EmpDaoImpl</span></span><br></pre></td></tr></table></figure><p><strong>8、将EmpController类中通过 “new对象的形式获取了EmpService接口子类的实例” 以及在EmpServiceImpl类中通过 “new对象的形式获取了EmpDao接口子类的实例” 改为使用BeanFactory工厂获取Service和Dao层的实例。如下：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 获取Service接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="comment">//private EmpService service = new EmpServiceImpl();</span></span><br><span class="line"><span class="keyword">private</span> EmpService service = (EmpService)BeanFactory.getBean(<span class="string">"EmpService"</span>);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 获取Dao接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="comment">//private EmpDao dao = new EmpDaoImpl();</span></span><br><span class="line"><span class="keyword">private</span> EmpDao dao = (EmpDao)BeanFactory.getBean( <span class="string">"EmpDao"</span> );</span><br></pre></td></tr></table></figure><h2 id="Spring-IOC控制反转"><a href="#Spring-IOC控制反转" class="headerlink" title="Spring IOC控制反转"></a>Spring IOC控制反转</h2><h3 id="什么是控制反转"><a href="#什么是控制反转" class="headerlink" title="什么是控制反转"></a>什么是控制反转</h3><p><strong>IOC</strong>（Inverse Of Control）<strong>控制反转</strong>，即，把创建对象的权利交给框架。</p><p>也就是指将对象的创建、对象的存储、对象的管理交给了spring容器。</p><p>（spring容器是spring中的一个核心模块，用于管理对象，底层可以理解为是一个map集合）</p><hr><p><a href="https://www.zhangpeng.fun/upload/2020/06/0a11c44a30f5a7328589e4031d624ffd-221f83a278544a97a475c1d85cbf89cb.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-60a3fc57832fc7d150a9a5655df6da9f.png" alt="0a11c44a30f5a7328589e4031d624ffd"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0a11c44a30f5a7328589e4031d624ffd-221f83a278544a97a475c1d85cbf89cb.png" target="_blank" rel="noopener">0a11c44a30f5a7328589e4031d624ffd</a></p><hr><p>在此之前，当需要对象时，通常是利用new关键字创建一个对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 获取Service接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="keyword">private</span> EmpService service = <span class="keyword">new</span> EmpServiceImpl();</span><br><span class="line"><span class="comment">//private EmpService service = (EmpService)BeanFactory.getBean("EmpService");</span></span><br></pre></td></tr></table></figure><p>但由于new对象，会提高类和类之间的依赖关系，即代码之间的耦合性。</p><p>而现在我们可以将对象的创建交给框架来做：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 获取Service接口的子类实例</span></span><br><span class="line"><span class="comment"> * ——这里使用new对象的方式造成了程序之间的耦合性提升 */</span></span><br><span class="line"><span class="comment">//private EmpService service = new EmpServiceImpl();</span></span><br><span class="line"><span class="keyword">private</span> EmpService service = (EmpService)BeanFactory.getBean(<span class="string">"EmpService"</span>);</span><br></pre></td></tr></table></figure><p>只需要将类提前配置在配置文件中，就可以将对象的创建交给框架来做。当需要对象时，不需要自己创建，而是通过框架直接获取即可，省去了new对象的过程，自然就降低类和类之间的依赖关系，也就是耦合性。</p><h2 id="IOC入门案例"><a href="#IOC入门案例" class="headerlink" title="IOC入门案例"></a>IOC入门案例</h2><p>下面将使用spring的IOC解决程序间的耦合</p><h3 id="创建工程，引入jar包"><a href="#创建工程，引入jar包" class="headerlink" title="创建工程，引入jar包"></a>创建工程，引入jar包</h3><p>创建Maven工程，引入spring相关依赖包</p><p>1、创建Maven—Java工程</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e38fbdb8819178517de105a52e112a84-7c55b08b4c93490b8d3da570d8a8071b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-169992d43c0087ef00bf01f5dec15959.png" alt="e38fbdb8819178517de105a52e112a84"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e38fbdb8819178517de105a52e112a84-7c55b08b4c93490b8d3da570d8a8071b.png" target="_blank" rel="noopener">e38fbdb8819178517de105a52e112a84</a></p><p>2、引入junit、spring的jar包：在maven工程的pom.xml文件的根标签（project）内添加如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 添加junit的jar包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 添加spring的jar包 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>导入后保存pom文件，项目如图所示：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ffe9287f31af4c4bf68f5d098b1d2039-60055999e39b4a1085039cf1e1e7a67d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-6f4d339a5f47619e71c7dc0eb2a221c8.png" alt="ffe9287f31af4c4bf68f5d098b1d2039"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ffe9287f31af4c4bf68f5d098b1d2039-60055999e39b4a1085039cf1e1e7a67d.png" target="_blank" rel="noopener">ffe9287f31af4c4bf68f5d098b1d2039</a></p><h3 id="创建spring配置文件"><a href="#创建spring配置文件" class="headerlink" title="创建spring配置文件"></a>创建spring配置文件</h3><p>创建spring核心配置文件—applicationContext.xml</p><p>1、在工程的src/main/resources源码目录下，创建applicationContext.xml文件:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3b521e8ba5d563ec21a2e142fa6cf623-6c3c460ed840496d826b08f14a49ba40.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-c2deb9bd3fc9dd01cc50678bd6420a89.png" alt="3b521e8ba5d563ec21a2e142fa6cf623"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3b521e8ba5d563ec21a2e142fa6cf623-6c3c460ed840496d826b08f14a49ba40.png" target="_blank" rel="noopener">3b521e8ba5d563ec21a2e142fa6cf623</a></p><p>2、在applicationContext.xml中添加文件头信息：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3、将EmpService接口的实现类的实例<br>以及EmpDao接口的实现类的实例交给Spring容器创建，在核心配置文件中添加如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 将EmpService接口的实现类的实例交给spring创建 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"empService"</span> <span class="attr">class</span>=<span class="string">"com.tedu.service.EmpServiceImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 将EmpDao接口的实现类的实例交给spring创建 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"empDao"</span> <span class="attr">class</span>=<span class="string">"com.tedu.dao.EmpDaoImpl"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="创建测试类进行解耦"><a href="#创建测试类进行解耦" class="headerlink" title="创建测试类进行解耦"></a>创建测试类进行解耦</h3><p>创建测试类—TestSpring，通过spring的IOC解决程序中的耦合问题</p><p>1、创建测试类</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/30070bf2108c5dcd69ad97c00021d08b-d9c3b11f9a294efb901b3c31f13a6e8c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-464256493fe46c4b4a9c58df93c0ebba.png" alt="30070bf2108c5dcd69ad97c00021d08b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/30070bf2108c5dcd69ad97c00021d08b-d9c3b11f9a294efb901b3c31f13a6e8c.png" target="_blank" rel="noopener">30070bf2108c5dcd69ad97c00021d08b</a></p><p>2、测试步骤及代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 使用spring的IOC解决程序中的耦合问题</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testIOC</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//获取spring的核心容器对象</span></span><br><span class="line">ApplicationContext ac = </span><br><span class="line"><span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line"><span class="string">"applicationContext.xml"</span>);</span><br><span class="line"><span class="comment">//通过spring的核心容器获取EmpService接口的子类实例</span></span><br><span class="line">EmpService service = (EmpService) ac.getBean(<span class="string">"empService"</span>);</span><br><span class="line">EmpDao dao = (EmpDao) ac.getBean(<span class="string">"empDao"</span>);</span><br><span class="line">System.out.println( service );</span><br><span class="line">System.out.println( dao );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3、运行结果：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/96cee091183ae525af0bf5314bf057c1-a8b7a70e13c040339333820a636b0734.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-f362f2684cec3acc9f8150bf61b45ca2.png" alt="96cee091183ae525af0bf5314bf057c1"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/96cee091183ae525af0bf5314bf057c1-a8b7a70e13c040339333820a636b0734.png" target="_blank" rel="noopener">96cee091183ae525af0bf5314bf057c1</a></p><p><strong>4、入门案例总结：</strong></p><p>这就是spring框架的IOC——控制反转。之前我们自己new对象，例如：</p><blockquote><p>User u = new User();</p></blockquote><p>而现在，变成由一个初始化的xml配置文件来创建，也就是由spring容器来创建。</p><blockquote><p>User user = (User) ac.getBean(“user”);</p></blockquote><p>当程序运行，spring开始工作后，会加载整个xml核心配置文件，读取到，获取到class属性中类的全路径，利用反射创建该类的对象。</p><h2 id="Bean对象的单例和多例"><a href="#Bean对象的单例和多例" class="headerlink" title="Bean对象的单例和多例"></a>Bean对象的单例和多例</h2><h3 id="Bean对象的单例和多例概述"><a href="#Bean对象的单例和多例概述" class="headerlink" title="Bean对象的单例和多例概述"></a>Bean对象的单例和多例概述</h3><p>在Spring容器中管理的Bean对象的作用域，可以通过<strong>scope属性</strong>或用相关注解指定其作用域。</p><p>最常用是singleton（单例）或prototype（多例）。其含义如下：</p><p><strong>1) singleton</strong>：单实例，是默认值。这个作用域标识的对象具备全局唯一性。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">当把一个 bean 定义设置scope为singleton作用域时，那么Spring IOC容器只会创建该bean定义的唯一实例。也就是说，整个Spring IOC容器中只会创建当前类的唯一一个对象。</span><br><span class="line">这个单一实例会被存储到单例缓存（singleton cache）中，并且所有针对该bean的后续请求和引用都 将返回被缓存的、唯一的这个对象实例。</span><br><span class="line">singleton负责对象的创建、初始化、销毁。</span><br></pre></td></tr></table></figure><p><strong>2) prototype</strong>：多实例。这个作用域标识的对象每次获取都会创建新的对象。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">当把一个 bean 定义设置scope为singleton作用域时，Spring IOC容器会在每一次获取当前Bean时，都会产生一个新的Bean实例（相当于new的操作）</span><br><span class="line">prototype只负责对象的创建和初始化，不负责销毁。</span><br></pre></td></tr></table></figure><h3 id="为什么用单实例或多实例？"><a href="#为什么用单实例或多实例？" class="headerlink" title="为什么用单实例或多实例？"></a>为什么用单实例或多实例？</h3><p>之所以用单实例，在没有线程安全问题的前提下，没必要每个请求都创建一个对象，这样子既浪费CPU又浪费内存；</p><p>之所以用多例，是为了防止并发问题；即一个请求改变了对象的状态(例如，可改变的成员变量)，此时对象又处理另一个请求，而之前请求对对象状态的改变导致了对象对另一个请求做了错误的处理；</p><p>用单例和多例的标准只有一个：当对象含有可改变的状态时（更精确的说就是在实际应用中该状态会改变），使用多实例，否则单实例；</p><p>在Spring中配置Bean实例是单例还是多例方法是：</p><p><strong>单例：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>多例：</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="测试spring的单实例和多实例"><a href="#测试spring的单实例和多实例" class="headerlink" title="测试spring的单实例和多实例"></a>测试spring的单实例和多实例</h3><p>1、创建TestIOC2类，测试代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.spring;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestIOC2</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 通过spring容器创建创建User对象,</span></span><br><span class="line"><span class="comment"> * 并调用User中的sayHi方法  */</span></span><br><span class="line"><span class="comment">//1.加载spring的核心配置文件</span></span><br><span class="line">ClassPathXmlApplicationContext ac = </span><br><span class="line"><span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line"><span class="string">"applicationContext.xml"</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//2.从spring容器中获取bean对象(而不是自己new)</span></span><br><span class="line">User user1 = (User) ac.getBean(<span class="string">"user"</span>);</span><br><span class="line">User user2 = (User) ac.getBean(<span class="string">"user"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.测试</span></span><br><span class="line"><span class="keyword">if</span>(user1 == user2)&#123;</span><br><span class="line">System.out.println(<span class="string">"当前实例为单实例..."</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">System.out.println(<span class="string">"当前实例为多实例..."</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3、将applicationContext.xml中，User类bean标签的scope值设置为singleton：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行TestIOC2，运行结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f79acd66228d70451ef21a27911d21b-d2f259825365438ebc7767a8b730f075.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-b46216bebe738c38171b3b04d40f45c4.png" alt="4f79acd66228d70451ef21a27911d21b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f79acd66228d70451ef21a27911d21b-d2f259825365438ebc7767a8b730f075.png" target="_blank" rel="noopener">4f79acd66228d70451ef21a27911d21b</a></p><p>4、将applicationContext.xml中，User类bean标签的scope值修改为prototype</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>再次运行TestIOC2，运行结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/805f9db5f3eed078dc77876db32298ac-d73d5cb8b5fe4b68af3b56cebb6baab9.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-1c5e1f1a34f8ec215c5c1e6689422ab2.png" alt="805f9db5f3eed078dc77876db32298ac"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/805f9db5f3eed078dc77876db32298ac-d73d5cb8b5fe4b68af3b56cebb6baab9.png" target="_blank" rel="noopener">805f9db5f3eed078dc77876db32298ac</a></p><h2 id="Spring-DI依赖注入"><a href="#Spring-DI依赖注入" class="headerlink" title="Spring DI依赖注入"></a>Spring DI依赖注入</h2><h3 id="两种注入方式介绍"><a href="#两种注入方式介绍" class="headerlink" title="两种注入方式介绍"></a>两种注入方式介绍</h3><p>DI（Dependency Injection）依赖注入 。</p><p>依赖注入，即组件之间的依赖关系由容器在应用系统运行期来决定，也就是由容器动态地将某种依赖关系的目标对象实例注入到应用系统中的各个关联的组件之中。</p><hr><p>简单来说，所谓的依赖注入其实就是，在创建对象的同时或之后，如何给对象的属性赋值。</p><p>如果对象由我们自己创建，这一切都变得很简单，例如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setName(<span class="string">"韩少云"</span>);</span><br><span class="line">user.setAge(<span class="number">18</span>);</span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">"韩少云"</span>, <span class="number">18</span>);</span><br></pre></td></tr></table></figure><p>如果对象由spring创建，那么spring是怎么给属性赋值的？spring提供两种方式为属性赋值：</p><p><strong>(1).Set方式注入</strong></p><p><strong>(2).构造方法注入</strong></p><h2 id="set方式注入"><a href="#set方式注入" class="headerlink" title="set方式注入"></a>set方式注入</h2><h3 id="普通属性注入"><a href="#普通属性注入" class="headerlink" title="普通属性注入"></a>普通属性注入</h3><p><strong>需求：通过Spring创建User实例，并为User实例的name和age属性（普通属性）赋值</strong></p><p><strong>1、创建User类，声明name和age属性，并添加对应的setter和getter方法，以及toString方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.spring;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"User [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、在applicationContext.xml中声明User类的bean实例</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 声明User类的bean实例 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3、创建测试类—TestDI</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.spring;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestDI</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">//1.加载applicationContext.xml核心配置文件</span></span><br><span class="line">ClassPathXmlApplicationContext ac = </span><br><span class="line"><span class="keyword">new</span> ClassPathXmlApplicationContext(</span><br><span class="line"><span class="string">"applicationContext.xml"</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//2.获取User类的实例</span></span><br><span class="line">User user = (User) ac.getBean(<span class="string">"user"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.输出User实例</span></span><br><span class="line">System.out.println( user );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于这里没有为User对象的属性赋值，所以此时运行测试，结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1175a00c572e203e5413862754583a75-16ec07d867134c9681bebc389d3e1cc6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-67d749786e544695c59635d2286d614d.png" alt="1175a00c572e203e5413862754583a75"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1175a00c572e203e5413862754583a75-16ec07d867134c9681bebc389d3e1cc6.png" target="_blank" rel="noopener">1175a00c572e203e5413862754583a75</a></p><p><strong>4、修改applicationContext.xml中User实例的声明，为User实例注入属性</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 声明User类的bean实例 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过set方式为普通属性赋值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"韩少云"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中name属性的值，必须要和User类中所注入属性对应的get方法的名字去掉get后首字母变为小写的名字相同。</p><p>例如：为 User类中的age属性赋值，由于name属性对应的get方法名字为getAge，当去调用get和首字母变为小写后的名称为age，因此为age属性注入的配置内容为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>普通属性直接通过value注入即可。</p><p><strong>5、运行测试类TestDI，结果为：</strong></p><p>上面通过spring提供的set方式对User对象的属性进行了赋值赋值，所以此时运行测试，结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/abda0664c744fdef3e8ece4ea2db2a45-bb9ed6cbb939426988a9eb6c7452f755.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-e1d92925ce23e0b0f08de81de129414a.png" alt="abda0664c744fdef3e8ece4ea2db2a45"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/abda0664c744fdef3e8ece4ea2db2a45-bb9ed6cbb939426988a9eb6c7452f755.png" target="_blank" rel="noopener">abda0664c744fdef3e8ece4ea2db2a45</a></p><h3 id="对象属性注入"><a href="#对象属性注入" class="headerlink" title="对象属性注入"></a>对象属性注入</h3><p><strong>需求：通过Spring创建User实例，并为User对象的userInfo属性(对象属性)赋值</strong></p><p>1、创建UserInfo类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.spring;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、在applicationContext.xml中，声明UserInfo类的bean实例</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 声明UserInfo类的bean实例 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userInfo"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.UserInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3、修改User类，声明userInfo属性，添加对应的setter和getter方法，并重新生成toString方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">private</span> UserInfo userInfo;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> UserInfo <span class="title">getUserInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> userInfo;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserInfo</span><span class="params">(UserInfo userInfo)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.userInfo = userInfo;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"User [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">", userInfo="</span> + userInfo + <span class="string">"]"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4、在applicationContext.xml中，将UserInfo对象作为值，赋值给User对象的userInfo属性</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 声明User类的bean实例 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过set方式为普通属性赋值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"韩少云"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"20"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过set方式为对象属性赋值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userInfo"</span> <span class="attr">ref</span>=<span class="string">"userInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>由于此处是将UserInfo对象作为值赋值给另一个对象的属性，因此ref属性的值，为UserInfo对象bean标签的id值。</p><p>对象属性通过ref属性注入。</p><p>5、运行测试类TestDI，结果为：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/62c1243d1a13010db1a3c3cd8b116759-e72f4ccc2eff49359fbf0b715707f5c1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-bf0ee0494328f791d153cb246546e1c1.png" alt="62c1243d1a13010db1a3c3cd8b116759"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/62c1243d1a13010db1a3c3cd8b116759-e72f4ccc2eff49359fbf0b715707f5c1.png" target="_blank" rel="noopener">62c1243d1a13010db1a3c3cd8b116759</a></p><h2 id="构造方法注入"><a href="#构造方法注入" class="headerlink" title="构造方法注入"></a>构造方法注入</h2><p><strong>需求：通过Spring创建User对象，并为User对象的属性（name、age、UserInfo属性）赋值</strong></p><p><strong>1、为User类声明构造函数</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明无参构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//声明有参构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, Integer age, UserInfo userInfo)</span> </span>&#123;</span><br><span class="line"><span class="keyword">super</span>();</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line"><span class="keyword">this</span>.age = age;</span><br><span class="line"><span class="keyword">this</span>.userInfo = userInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、修改applicationContext.xml文件，将set方式修改为构造方法注入。</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.User"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过set方式为普通属性赋值</span></span><br><span class="line"><span class="comment">&lt;property name="name" value="韩少云"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">&lt;property name="age" value="20"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment">&lt;property name="userInfo" ref="userInfo"&gt;&lt;/property&gt;</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过构造器中参数为属性赋值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"马云"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"35"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"userInfo"</span> <span class="attr">ref</span>=<span class="string">"userInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 声明UserInfo类的bean实例 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userInfo"</span> <span class="attr">class</span>=<span class="string">"com.tedu.spring.UserInfo"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中，constructor-arg标签name属性的值必须和构造函数中参数的名字相同!</p><p>同样的，普通属性直接通过value注入即可；</p><p>对象属性通过ref属性注入。</p><p><strong>3、运行测试类TestDI，结果为：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b1ba956af8e1244bd1a30553f4fe6bf-a480c822140941cf8af5ca0ec3e70087.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-16edd43d95d677e71a90f665dffa50b4.png" alt="4b1ba956af8e1244bd1a30553f4fe6bf"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b1ba956af8e1244bd1a30553f4fe6bf-a480c822140941cf8af5ca0ec3e70087.png" target="_blank" rel="noopener">4b1ba956af8e1244bd1a30553f4fe6bf</a></p><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><h3 id="applicationContext-xml没有提示的解决办法"><a href="#applicationContext-xml没有提示的解决办法" class="headerlink" title="applicationContext.xml没有提示的解决办法"></a>applicationContext.xml没有提示的解决办法</h3><p><strong>1、配置spring-beans-4.1.xsd文件</strong></p><p>(1)找到spring-beans-4.1.xsd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3526b8f7cb18db7def8c59c6b8f5a8c6-c1e23c7540a54f4b93593f86d5de0598.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-ac03239e9b4a83ff65dec7ddb794ffe6.png" alt="3526b8f7cb18db7def8c59c6b8f5a8c6"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3526b8f7cb18db7def8c59c6b8f5a8c6-c1e23c7540a54f4b93593f86d5de0598.png" target="_blank" rel="noopener">3526b8f7cb18db7def8c59c6b8f5a8c6</a></p><p>(2)复制下面的url地址：</p><p><a href="http://www.springframework.org/schema/beans/spring-beans-4.0.xsd" target="_blank" rel="noopener">http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</a></p><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ]</p><p>XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-2abb2831056a467ea0e402114919ae7b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-9da2d74788244d266b058b39bcf25b51.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-2abb2831056a467ea0e402114919ae7b.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/10a6f5e3901af4d2fd9cba0d644e00bd-567300686a1e4b2b8abb54e00c14927b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-8a57d339be1440cfd3ac2a258e062648.png" alt="10a6f5e3901af4d2fd9cba0d644e00bd"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/10a6f5e3901af4d2fd9cba0d644e00bd-567300686a1e4b2b8abb54e00c14927b.png" target="_blank" rel="noopener">10a6f5e3901af4d2fd9cba0d644e00bd</a></p><p><strong>2、配置spring-context-4.1.xsd文件</strong></p><p>(1)找到spring-context-4.1.xsd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f88878c81816bfccdaf534b48ecbf37d-6e1f88beb10d460f93f2f8c7cb530fae.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-db52729fe354acd3f1f710c9b05158ce.png" alt="f88878c81816bfccdaf534b48ecbf37d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f88878c81816bfccdaf534b48ecbf37d-6e1f88beb10d460f93f2f8c7cb530fae.png" target="_blank" rel="noopener">f88878c81816bfccdaf534b48ecbf37d</a></p><p>(2)复制下面的url地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.springframework.org&#x2F;schema&#x2F;context&#x2F;spring-context-4.0.xsd</span><br></pre></td></tr></table></figure><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ] XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-2abb2831056a467ea0e402114919ae7b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-9da2d74788244d266b058b39bcf25b51.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-2abb2831056a467ea0e402114919ae7b.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bab1eb1bf264e64de4a3672c96f23e8b-87ddf7fa6d4f4c9b89aaf2384ba1bfe2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871240-61a9ed1c87f109e75bb05a89a2f73c12.png" alt="bab1eb1bf264e64de4a3672c96f23e8b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bab1eb1bf264e64de4a3672c96f23e8b-87ddf7fa6d4f4c9b89aaf2384ba1bfe2.png" target="_blank" rel="noopener">bab1eb1bf264e64de4a3672c96f23e8b</a></p><h1 id="spring-javaweb"><a href="#spring-javaweb" class="headerlink" title="spring    javaweb"></a><a href="https://www.zhangpeng.fun/tags/spring-" target="_blank" rel="noopener">spring</a>    <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="spring" scheme="https://zpengit.github.io/tags/spring/"/>
    
  </entry>
  
  <entry>
    <title>12-mybatis框架</title>
    <link href="https://zpengit.github.io/2020/06/11/12-mybatis%E6%A1%86%E6%9E%B6/"/>
    <id>https://zpengit.github.io/2020/06/11/12-mybatis%E6%A1%86%E6%9E%B6/</id>
    <published>2020-06-11T10:52:58.734Z</published>
    <updated>2020-06-11T10:46:10.893Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="12-mybatis框架"><a href="#12-mybatis框架" class="headerlink" title="12-mybatis框架"></a>12-mybatis框架</h1><h1 id="unit12-mybatis框架"><a href="#unit12-mybatis框架" class="headerlink" title="unit12-mybatis框架"></a>unit12-mybatis框架</h1><p><a href="https://www.zhangpeng.fun/upload/2020/06/a0a2eb9fa872009998f7cd818925095d-6b1b0b9006c9415f9b5cd8eb016ad6fe.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-75c77a26cbf5168d293d6a589e465b33.png" alt="a0a2eb9fa872009998f7cd818925095d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a0a2eb9fa872009998f7cd818925095d-6b1b0b9006c9415f9b5cd8eb016ad6fe.png" target="_blank" rel="noopener">a0a2eb9fa872009998f7cd818925095d</a></p><p><strong>课程计划：</strong></p><p>1、MyBatis快速入门</p><p>2、MyBatis对数据库中数据的增删改查操作</p><p>3、#{}占位符的应用</p><p>4、动态SQL的应用</p><p>5、MyBatis的Mapper接口开发</p><h2 id="MyBatis简介-了解"><a href="#MyBatis简介-了解" class="headerlink" title="MyBatis简介(了解)"></a>MyBatis简介(了解)</h2><h3 id="什么是MyBatis"><a href="#什么是MyBatis" class="headerlink" title="什么是MyBatis"></a>什么是MyBatis</h3><p>MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis 。2013年11月迁移到Github。</p><p>MyBatis是一个优秀的持久层框架，它对jdbc的操作数据库的过程进行封装，使开发者只需要关注SQL本身，而不需要花费精力去处理例如注册驱动、创建connection、创建statement、手动设置参数、结果集检索等jdbc繁杂的过程代码。</p><p>Mybatis通过xml或注解的方式将要执行的各种statement（statement、preparedStatemnt）配置起来，并通过java对象和statement中的sql进行映射生成最终执行的sql语句，最后由mybatis框架执行sql并将结果映射成java对象并返回。</p><p>总之，Mybatis对JDBC访问数据库的过程进行了封装，简化了JDBC代码，解决JDBC将结果集封装为Java对象的麻烦。</p><p>下图是MyBatis架构图：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f6d67734982f864da415a2a9cc4908a5-6f8d6ddd9a1a443493e920402464c88a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-b4e28a478a564166a0712d2a2f55a35a.png" alt="f6d67734982f864da415a2a9cc4908a5"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f6d67734982f864da415a2a9cc4908a5-6f8d6ddd9a1a443493e920402464c88a.png" target="_blank" rel="noopener">f6d67734982f864da415a2a9cc4908a5</a></p><p>(1)mybatis-config.xml是Mybatis的核心配置文件，通过其中的配置可以生成SqlSessionFactory,也就是SqlSession工厂</p><p>(2)基于SqlSessionFactory可以生成SqlSession对象</p><p>(3)SqlSession是一个既可以发送SQL去执行，并返回结果，类似于JDBC中的Connection对象，也是Mybatis中至关重要的一个对象。</p><p>(4)Executor是SqlSession底层的对象，用于执行SQL语句</p><p>(5)MapperStatement对象也是SqlSession底层的对象，用于接收输入映射（SQL语句中的参数），以及做输出映射（即将SQL查询的结果映射成相应的结果）</p><h3 id="为什么要使用MyBatis"><a href="#为什么要使用MyBatis" class="headerlink" title="为什么要使用MyBatis"></a>为什么要使用MyBatis</h3><p><em>思考：在开始之前，思考下如何通过JDBC查询Emp表中的所有记录，并封装到一个List集合中返回。（演示：准备数据、导包、导入JDBC程序）</em></p><p><code>1、使用传统方式JDBC访问数据库：</code></p><p>(1)使用JDBC访问数据库有大量重复代码（比如注册驱动、获取连接、获取传输器、释放资源等）；</p><p>(2)JDBC自身没有连接池，会频繁的创建连接和关闭连接，效率低；</p><p>(3)SQL是写死在程序中，一旦修改SQL，需要对类重新编译；</p><p>(4)对查询SQL执行后返回的ResultSet对象，需要手动处理，有时会特别麻烦；</p><p>…</p><p><code>2、使用mybatis框架访问数据库：</code></p><p>(1)Mybatis对JDBC对了封装，可以简化JDBC代码；</p><p>(2)Mybatis自身支持连接池（也可以配置其他的连接池），因此可以提高程序的效率；</p><p>(3)Mybatis是将SQL配置在mapper文件中，修改SQL只是修改配置文件，类不需要重新编译。</p><p>(4)对查询SQL执行后返回的ResultSet对象，Mybatis会帮我们处理，转换成Java对象。</p><p>…</p><p>总之，JDBC中所有的问题（代码繁琐、有太多重复代码、需要操作太多对象、释放资源、对结果的处理太麻烦等），在Mybatis框架中几乎都得到了解决！！</p><h2 id="MyBatis快速入门"><a href="#MyBatis快速入门" class="headerlink" title="MyBatis快速入门"></a>MyBatis快速入门</h2><h3 id="准备数据，创建库和表"><a href="#准备数据，创建库和表" class="headerlink" title="准备数据，创建库和表"></a>准备数据，创建库和表</h3><p>创建yonghedb库、emp表，并插入若干条记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、创建数据库 yonghedb 数据库</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> yonghedb <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="keyword">use</span> yonghedb; <span class="comment">-- 选择yonghedb数据库</span></span><br><span class="line"><span class="comment">-- 2、删除emp表（如果存在）</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> emp;</span><br><span class="line"><span class="comment">-- 3、在 yonghedb 库中创建 emp 表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    job <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    salary <span class="keyword">double</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 4、往 emp 表中, 插入若干条记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'王海涛'</span>, <span class="string">'程序员'</span>, <span class="number">3300</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'齐雷'</span>, <span class="string">'程序员'</span>, <span class="number">2800</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'刘沛霞'</span>, <span class="string">'程序员鼓励师'</span>, <span class="number">2700</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'陈子枢'</span>, <span class="string">'部门总监'</span>, <span class="number">4200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'刘昱江'</span>, <span class="string">'程序员'</span>, <span class="number">3000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'董长春'</span>, <span class="string">'程序员'</span>, <span class="number">3500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'苍老师'</span>, <span class="string">'程序员'</span>, <span class="number">3700</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'韩少云'</span>, <span class="string">'CEO'</span>, <span class="number">5000</span>);</span><br></pre></td></tr></table></figure><h3 id="创建工程，导入所需jar包、创建测试类"><a href="#创建工程，导入所需jar包、创建测试类" class="headerlink" title="创建工程，导入所需jar包、创建测试类"></a>创建工程，导入所需jar包、创建测试类</h3><p><code>1、创建Maven的java工程</code></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/313e2677abaf6d235c0f8603165739fc-a2a4dd4714274759bd587c4caf933829.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-e021e5968a64ee913dc37f498e677b68.png" alt="313e2677abaf6d235c0f8603165739fc"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/313e2677abaf6d235c0f8603165739fc-a2a4dd4714274759bd587c4caf933829.png" target="_blank" rel="noopener">313e2677abaf6d235c0f8603165739fc</a></p><p><code>2、导入junit、mysql、mybaits等开发包</code></p><p>在pom.xml文件中引入相关依赖包即可</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- junit单元测试 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 整合log4j --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3、创建com.tedu.mybatis.TestMybatis01测试类，并提供findAll方法（查询emp表中所有的员工信息），开发步骤如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200403151610907-29d0f7809cae4a2cb753c6fdc3098603.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-c898767a508896489fed9f66ee8660f9.png" alt="image-20200403151610907"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200403151610907-29d0f7809cae4a2cb753c6fdc3098603.png" target="_blank" rel="noopener">image-20200403151610907</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习1(快速入门): 查询emp表中的所有员工, 返回一个List&lt;Emp&gt;集合</span></span><br><span class="line"><span class="comment">* <span class="doctag">@throws</span> IOException */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="comment">//1.读取mybatis的核心配置文件(mybatis-config.xml)</span></span><br><span class="line">    <span class="comment">//2.通过配置信息获取一个SqlSessionFactory工厂对象</span></span><br><span class="line">    <span class="comment">//3.通过工厂获取一个SqlSession对象</span></span><br><span class="line">    <span class="comment">//4.通过namespace+id找到要执行的sql语句并执行sql语句</span></span><br><span class="line">    <span class="comment">//5.输出结果</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="添加mybatis-config-xml文件"><a href="#添加mybatis-config-xml文件" class="headerlink" title="添加mybatis-config.xml文件"></a>添加mybatis-config.xml文件</h3><p><strong>1、在src/main/resources目录下，创建mybatis-config.xml文件</strong>（MyBatis的核心配置文件）</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3e84b2af713f0ddea7c6164f57806c60-e2b8ff1d02174e1b9b583fd0ea9d172a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-5f0b41001e860e228cf9ebfa17227a38.png" alt="3e84b2af713f0ddea7c6164f57806c60"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3e84b2af713f0ddea7c6164f57806c60-e2b8ff1d02174e1b9b583fd0ea9d172a.png" target="_blank" rel="noopener">3e84b2af713f0ddea7c6164f57806c60</a></p><p><strong>2、mybatis-config.xml文件配置如下:</strong></p><p><code>mybatis-config文件头信息如下：</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- MyBatis的全局配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> &gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>mybatis-config文件详细配置如下：</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- MyBatis的全局配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> &gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 1.配置环境，可配置多个环境（比如：develop开发、test测试） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"develop"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"develop"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 1.1.配置事务管理方式：JDBC/MANAGED</span></span><br><span class="line"><span class="comment">JDBC：将事务交给JDBC管理（推荐）</span></span><br><span class="line"><span class="comment">MANAGED：自己管理事务</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 1.2.配置数据源，即连接池 JNDI/POOLED/UNPOOLED</span></span><br><span class="line"><span class="comment">JNDI：已过时</span></span><br><span class="line"><span class="comment">POOLED：使用连接池（推荐）</span></span><br><span class="line"><span class="comment">UNPOOLED：不使用连接池</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/yonghedb?characterEncoding=utf-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.导入Mapper配置文件，如果mapper文件有多个，可以通过多个mapper标签导入 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"EmpMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="添加EmpMapper-xml文件"><a href="#添加EmpMapper-xml文件" class="headerlink" title="添加EmpMapper.xml文件"></a>添加EmpMapper.xml文件</h3><p><strong>1、在src/main/resources目录下，创建EmpMapper.xml文件 （实体类的映射文件）</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf0e887dec06ea62dbad0673fe4b2730-3cc8150553244e1aa023202dc5de3db7.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-dd5d2ad4f5c1adb06953a23d53cbd344.png" alt="bf0e887dec06ea62dbad0673fe4b2730"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf0e887dec06ea62dbad0673fe4b2730-3cc8150553244e1aa023202dc5de3db7.png" target="_blank" rel="noopener">bf0e887dec06ea62dbad0673fe4b2730</a></p><p><strong>2、EmpMapper.xml文件配置如下:</strong></p><p><code>EmpMapper文件头信息如下：</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta"><span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">不同Mapper文件的namespace值应该保证唯一</span></span><br><span class="line"><span class="comment">在程序中通过[ namespace + id ]定位到要执行哪一条SQL语句</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>EmpMapper文件详细配置如下：</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta"><span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">不同Mapper文件的namespace值应该保证唯一</span></span><br><span class="line"><span class="comment">在程序中通过[ namespace + id ]定位到要执行哪一条SQL语句</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"EmpMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过select、insert、update、delete标签声明要执行的SQL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 练习1: 查询emp表中的所有员工信息</span></span><br><span class="line"><span class="comment">resultType指定查询的结果将会封装到什么类型中</span></span><br><span class="line"><span class="comment">即使最终返回的结果是集合(List&lt;Emp&gt;),resultType也只需要指定集合中的泛型即可!</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="添加并编写Emp实体类"><a href="#添加并编写Emp实体类" class="headerlink" title="添加并编写Emp实体类"></a>添加并编写Emp实体类</h3><p>注意：在当前实例中，Emp类中的属性和数据库表的字段名称必须一致，否则将会无法将结果集封装到Java对象中。</p><p>在src/main/java目录下创建 com.tedu.pojo.Emp类，并编辑Emp类：提供私有属性以及对应的getter方法、setter方法，并重写toString方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.pojo;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实体类,用于封装Emp表中的一条用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line"><span class="comment">//1.声明实体类中的属性</span></span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> String job;</span><br><span class="line"><span class="keyword">private</span> Double salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.提供对应的getter和setter方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJob</span><span class="params">(String job)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.job = job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Double <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> salary;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(Double salary)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.salary = salary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.重写toString方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"Emp [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", job="</span> + job + <span class="string">", salary="</span> + salary + <span class="string">"]"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="实现测试类-并测试"><a href="#实现测试类-并测试" class="headerlink" title="实现测试类,并测试"></a>实现测试类,并测试</h3><p><strong>1、实现findAll方法，代码如下：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习1(快速入门):  查询emp表中的所有员工, 返回一个List&lt;Emp&gt;集合</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> IOException */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"><span class="comment">//1.读取mybatis的核心配置文件(mybatis-config.xml)</span></span><br><span class="line">InputStream in = Resources</span><br><span class="line">.getResourceAsStream(<span class="string">"mybatis-config.xml"</span>);</span><br><span class="line"><span class="comment">//2.通过配置信息获取一个SqlSessionFactory工厂对象</span></span><br><span class="line">SqlSessionFactory fac = </span><br><span class="line"><span class="keyword">new</span> SqlSessionFactoryBuilder().build( in );</span><br><span class="line"><span class="comment">//3.通过工厂获取一个SqlSession对象</span></span><br><span class="line">SqlSession session = fac.openSession();</span><br><span class="line"><span class="comment">//4.通过namespace+id找到要执行的sql语句并执行sql语句</span></span><br><span class="line">List&lt;Emp&gt; list = session</span><br><span class="line">.selectList(<span class="string">"EmpMapper.findAll"</span>);</span><br><span class="line"><span class="comment">//5.输出结果</span></span><br><span class="line"><span class="keyword">for</span>(Emp e : list) &#123;</span><br><span class="line">System.out.println( e );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、执行findAll方法，输出结果为：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Emp [id&#x3D;1, name&#x3D;王海涛, job&#x3D;程序员, salary&#x3D;3300.0]</span><br><span class="line">Emp [id&#x3D;2, name&#x3D;齐雷, job&#x3D;程序员, salary&#x3D;2800.0]</span><br><span class="line">Emp [id&#x3D;3, name&#x3D;刘沛霞, job&#x3D;程序员鼓励师, salary&#x3D;2700.0]</span><br><span class="line">Emp [id&#x3D;4, name&#x3D;陈子枢, job&#x3D;部门总监, salary&#x3D;4200.0]</span><br><span class="line">Emp [id&#x3D;5, name&#x3D;刘昱江, job&#x3D;程序员, salary&#x3D;3000.0]</span><br><span class="line">Emp [id&#x3D;6, name&#x3D;董长春, job&#x3D;程序员, salary&#x3D;3500.0]</span><br><span class="line">Emp [id&#x3D;7, name&#x3D;苍老师, job&#x3D;程序员, salary&#x3D;3700.0]</span><br><span class="line">Emp [id&#x3D;8, name&#x3D;韩少云, job&#x3D;CEO, salary&#x3D;5000.0]</span><br></pre></td></tr></table></figure><h2 id="MyBatis入门细节"><a href="#MyBatis入门细节" class="headerlink" title="MyBatis入门细节"></a>MyBatis入门细节</h2><h3 id="mybatis-config-xml配置文件"><a href="#mybatis-config-xml配置文件" class="headerlink" title="mybatis-config.xml配置文件"></a>mybatis-config.xml配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">    <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Config 3.0//EN"</span></span></span><br><span class="line"><span class="meta">    <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!-- MyBatis的全局配置文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> &gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 1.配置环境，可配置多个环境（比如：develop开发、test测试） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"develop"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"develop"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 1.1.配置事务管理方式：JDBC/MANAGED</span></span><br><span class="line"><span class="comment">JDBC：将事务交给JDBC管理（推荐）</span></span><br><span class="line"><span class="comment">MANAGED：自己管理事务</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>&gt;</span><span class="tag">&lt;/<span class="name">transactionManager</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 1.2.配置数据源，即连接池 JNDI/POOLED/UNPOOLED</span></span><br><span class="line"><span class="comment">JNDI：已过时</span></span><br><span class="line"><span class="comment">POOLED：使用连接池（推荐）</span></span><br><span class="line"><span class="comment">UNPOOLED：不使用连接池</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"com.mysql.jdbc.Driver"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/yonghedb?characterEncoding=utf-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 2.导入Mapper配置文件，如果mapper文件有多个，可以通过多个mapper标签导入 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"EmpMapper.xml"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>environments</code>标签：该标签内部可以配置多个environment，即多种环境，每种环境可以做不同配置或连接不同数据库。例如，开发、测试、生产环境可能需要不同的配置，连接的数据库可能也不相同，因此我们可以配置三个environment，分别对应上面三种不同的环境。</p><p>但是要记住，environment可以配置多个，但是最终要使用的只能是其中一个！</p><p><code>environment</code>标签：内部可以配置多种配置信息，下面介绍事务管理配置和数据源配置。</p><p><code>transactionManage</code>标签：事务管理配置，mybatis中有两种事务管理方式，也就是</p><p>type=”[JDBC|MANAGED]。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JDBC：这个配置就是直接使用了 JDBC的提交和回滚设置，它依赖于从数据源得到的连接来管理事务范围。推荐使用。</span><br><span class="line">MANAGED：这个配置几乎没做什么。它从来不提交或回滚一个连接。需要自己手动添加并管理。不推荐使用。</span><br></pre></td></tr></table></figure><p><code>dataSource</code>标签：数据源，也就是连接池配置。这里type指定数据源类型，有三种内建的类型：JNDI、POOLED、UNPOOLED</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JNDI：已过时，不推荐使用！</span><br><span class="line">POOLED：使用连接池，mybatis会创建连接池，并从连接池中获取连接访问数据库，在操作完成后，将会把连接返回连池。</span><br><span class="line">UNPOOLED：不使用连接池，该方式适用于只有小规模数量并发用户的简单应用程序上。</span><br></pre></td></tr></table></figure><p><code>mappers</code>标签：用于导入mapper文件的位置，其中可以配置多个mapper，即可以导入多个mapper文件。</p><h3 id="EmpMapper-xml配置文件"><a href="#EmpMapper-xml配置文件" class="headerlink" title="EmpMapper.xml配置文件"></a>EmpMapper.xml配置文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta"><span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">不同Mapper文件的namespace值应该保证唯一</span></span><br><span class="line"><span class="comment">在程序中通过[ namespace + id ]定位到要执行哪一条SQL语句</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"EmpMapper"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 通过select、insert、update、delete标签声明要执行的SQL --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 练习1: 查询emp表中的所有员工信息</span></span><br><span class="line"><span class="comment">resultType指定查询的结果将会封装到什么类型中</span></span><br><span class="line"><span class="comment">即使最终返回的结果是集合(List&lt;Emp&gt;),resultType也只需要指定集合中的泛型即可!</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>(1)第1行是xml的文档声明，用于声明xml的版本和编码</p><p>(2)第2、3、4行，引入了xml约束文档，当前xml文档将会按照mybatis-3-mapper.dtd文件所要求的规则进行书写。</p><p>(3)Mapper标签：根标签，其中namespace(名称空间，也叫命名空间)，要求不能重复。在程序中通过【namespace + id 】定位到要执行哪一条SQL语句</p><p>(4)select标签：用于指定将来要执行的各种SQL语句。标签上可以声明属性，下面介绍常用的属性：id、resultType、resultMap</p><ul><li><p>id属性：要求值不能重复。将来在执行SQL时，可以通过【namespace + id】找到指定SQL并执行。</p></li><li><p>resultType属性：从这条SQL语句中返回所期望类型的类的完全限定名称（包名+类名）。注意如果是集合情形，那应该是集合可以包含的类型，而不能是集合本身。</p><p>简而言之，resultType控制查询SQL执行后返回值的类型或集合中的泛型，例如查询emp表中的单条记录，返回值是一个Emp对象，因此，resultType=”com.tedu.pojo.Emp”；</p><p>如果查询emp表中的多条记录，返回值是一个List，此时resultType的值应该集合中的泛型，因此resultType=”com.tedu.pojo.Emp”；</p></li><li><p>resultMap属性：复杂对象结构（例如多表关联查询等）。 使用 resultType 或 resultMap，但不能同时使用。</p></li></ul><h2 id="MyBatis增删改查"><a href="#MyBatis增删改查" class="headerlink" title="MyBatis增删改查"></a>MyBatis增删改查</h2><h3 id="新增员工"><a href="#新增员工" class="headerlink" title="新增员工"></a>新增员工</h3><p><strong>1、编辑EmpMapper.xml文件, 添加新增员工对应的sql.</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习2: 新增员工信息: 赵云 保安 6000</span></span><br><span class="line"><span class="comment">增删改的标签上不用指定resultType, 因为返回值都是int类型</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"insert"</span> &gt;</span></span><br><span class="line">insert into emp value(null, '赵云', '保安', 6000)</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、编写TestMybatis类，添加testInsert方法，实现新增员工操作。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习2: 新增员工信息: 赵云 保安 6000 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//执行sql语句, 返回执行结果</span></span><br><span class="line">  <span class="keyword">int</span> rows = session.update(<span class="string">"EmpMapper.insert"</span>);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println(<span class="string">"影响的行数: "</span>+rows);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修改员工"><a href="#修改员工" class="headerlink" title="修改员工"></a>修改员工</h3><p><strong>1、编辑EmpMapper.xml文件, 添加新增员工对应的sql。</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习3：修改员工信息：赵云 保镖 20000 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span>&gt;</span></span><br><span class="line">update emp set job='保镖', salary=20000 where name='赵云'</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、编写TestMybatis类，添加testUpdate方法，实现修改员工信息。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习3: 修改员工信息, 将赵云的job改为'保镖'，salary改为20000 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//执行sql语句, 返回执行结果</span></span><br><span class="line">  <span class="keyword">int</span> rows = session.update(<span class="string">"EmpMapper.update"</span>);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println(<span class="string">"影响行数:"</span>+rows);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="删除员工"><a href="#删除员工" class="headerlink" title="删除员工"></a>删除员工</h3><p><strong>1、编辑EmpMapper.xml文件, 添加新增员工对应的sql。</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习4: 删除name为'赵云'的记录 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"delete"</span>&gt;</span></span><br><span class="line">delete from emp where name='赵云'</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、编写TestMybatis类，添加</strong>testDelete<strong>方法，实现删除员工。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习4: 删除name为'赵云'的记录 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//执行sql语句, 返回执行结果</span></span><br><span class="line">  <span class="keyword">int</span> rows = session.update(<span class="string">"EmpMapper.delete"</span>);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println(<span class="string">"影响行数:"</span>+rows);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mybatis中的占位符"><a href="#mybatis中的占位符" class="headerlink" title="mybatis中的占位符"></a>mybatis中的占位符</h2><h3 id="占位符"><a href="#占位符" class="headerlink" title="#{}占位符"></a>#{}占位符</h3><p>在上面的增删改查操作中，SQL语句中的值是写死在SQL语句中的，而在实际开发中，此处的值往往是用户提交过来的值，因此这里我们需要将SQL中写死的值替换为占位符。</p><p>在mybatis中占位符有两个，分别是 <code>#{}</code> 占位符 和 <code>${}</code> 占位符：</p><ul><li><p><code>#{}：</code>相当于JDBC中的问号（?）占位符,是为SQL语句中的参数值进行占位,大部分情况下都是使用#{}占位符; 并且当#{}占位符是为字符串或者日期类型的值进行占位时,在参数值传过来替换占位符的同时,会进行转义处理(在字符串或日期类型的值的两边加上单引号)</p></li><li><p><code>${}</code>：是为SQL片段进行占位，将传过来的SQL片段直接拼接在${}占位符所在的位置,不会进行任何的转义处理。（由于是直接将参数拼接在SQL语句中，因此可能会引发SQL注入攻击问题）</p></li></ul><p><strong>练习5：查询emp表中指定id的员工信息</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习5: 查询emp表中指定id的员工信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习5: 查询emp表中指定id的员工信息 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//执行sql语句, 返回执行结果</span></span><br><span class="line">  Emp emp = session.selectOne( <span class="string">"EmpMapper.findById"</span>, <span class="number">1</span> );</span><br><span class="line">  System.out.println( emp );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习6：新增员工信息: 张飞 Java开发工程师 15000</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习6: 新增员工信息: 张飞 Java开发工程师 15000</span></span><br><span class="line"><span class="comment">  如果通过map集合传输参数, 需要保证占位符中的变量名</span></span><br><span class="line"><span class="comment">  和map集合中的key保持一致</span></span><br><span class="line"><span class="comment">  如果通过pojo对象传输参数, 需要保证占位符中的变量名</span></span><br><span class="line"><span class="comment">  和对象中的属性名保持一致, 或者在pojo中有对应的</span></span><br><span class="line"><span class="comment">  getXxx方法</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"insert2"</span>&gt;</span></span><br><span class="line">insert into emp values (null, #&#123;name&#125;, #&#123;job&#125;, #&#123;salary&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习6: 新增员工信息: 张飞 Java开发工程师 15000 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//将要传输的参数封装到map集合中</span></span><br><span class="line">  <span class="comment">//Map map = new HashMap();</span></span><br><span class="line">  <span class="comment">//map.put("name", "张飞");</span></span><br><span class="line">  <span class="comment">//map.put("job", "Java开发工程师");</span></span><br><span class="line">  <span class="comment">//map.put("salary", 15000);</span></span><br><span class="line">  <span class="comment">//也可以将要传输的参数封装到Emp对象中</span></span><br><span class="line">  Emp emp = <span class="keyword">new</span> Emp();</span><br><span class="line">  emp.setName(<span class="string">"关羽123"</span>);</span><br><span class="line">  emp.setJob(<span class="string">"保安"</span>);</span><br><span class="line">  emp.setSalary(<span class="number">8000.0</span>);</span><br><span class="line">  <span class="comment">//执行sql语句</span></span><br><span class="line">  intsession rows = session.update(<span class="string">"EmpMapper.insert2"</span>, emp);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println( <span class="string">"影响的行数: "</span>+rows );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习7：修改员工信息: 张飞 架构师 25000</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习7: 修改员工信息: 张飞 架构师 25000 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update2"</span>&gt;</span></span><br><span class="line">  update emp set job=#&#123;job&#125;, salary=#&#123;salary&#125;</span><br><span class="line">  where name=#&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习7: 修改员工信息: 张飞 架构师 25000 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//将参数封装到Emp对象中</span></span><br><span class="line">  Emp emp = <span class="keyword">new</span> Emp();</span><br><span class="line">  emp.setName(<span class="string">"张飞"</span>);</span><br><span class="line">  emp.setJob(<span class="string">"架构师"</span>);</span><br><span class="line">  emp.setSalary(<span class="number">25000.0</span>);</span><br><span class="line">  <span class="comment">//执行sql语句</span></span><br><span class="line">  intsession rows = session.update(<span class="string">"EmpMapper.update2"</span>, emp);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println(<span class="string">"影响的行数: "</span>+rows);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习8：删除emp表中指定id的员工信息</strong></p><p>mapper文件配置:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习8：删除emp表中指定id的员工信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"delete2"</span> <span class="attr">parameterType</span>=<span class="string">"String"</span>&gt;</span></span><br><span class="line">delete from emp where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><p>java代码示例:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  练习8：删除emp表中指定id的员工信息 */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete2</span><span class="params">()</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">  ......</span><br><span class="line">  <span class="comment">//执行SQL语句</span></span><br><span class="line">  <span class="keyword">int</span> rows = session.delete(<span class="string">"EmpMapper.delete2"</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="comment">//提交事务</span></span><br><span class="line">  session.commit();</span><br><span class="line">  System.out.println(<span class="string">"影响行数:"</span>+rows);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的增删改查练习中，当SQL语句中包含的参数值是传递过来的，在SQL语句中我们会通过<code>#{}</code>占位符进行占位，在SQL语句真正执行时，再将传递过来的值替换SQL语句中的占位符。</p><p>其实，<code>#{}</code>就是JDBC中的问号（<strong>?</strong>）占位符，因此为了安全考虑，在执行时会对传递过来的字符串和日期类型高的值进行转译处理。</p><p>例如：查询指定name的员工信息，SQL语句为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span>=<span class="comment">#&#123;name&#125;</span></span><br></pre></td></tr></table></figure><p>其实就等价于JDBC中： <code>select * from emp where name=?</code>，</p><p>如果传过来的参数值为：王海涛，那么最终执行的SQL语句为：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在参数替换占位符的同时进行了转义处理(在值的两边加上了单引号)</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> emp <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'王海涛'</span></span><br></pre></td></tr></table></figure><h3 id="占位符-1"><a href="#占位符-1" class="headerlink" title="${}占位符"></a>${}占位符</h3><p>那么如果我们在传递的时候不是一个参数值，而是一个SQL片段呢？</p><p>例如：在查询时，我们想动态的传递查询的列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="comment">#&#123;columns&#125; from emp</span></span><br></pre></td></tr></table></figure><p>此时传递过来的应该是一个SQL片段，不同于上面的参数值，如果此时还用<code>#{}</code>，也会像上面一样被转译处理：<code>select &#39;id,name,job&#39; from emp</code>，这不是我们希望看到的！</p><p>如果不想让传过来的SQL片段被转译处理，而是直接拼接在SQL语句中，那么这里可以使用<code>${}</code>，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> $&#123;<span class="keyword">columns</span>&#125; <span class="keyword">from</span> emp</span><br></pre></td></tr></table></figure><p>拼接之后：<code>select id,name,job from emp</code></p><p><strong>练习9：动态指定要查询的列</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习9: 动态指定要查询的列 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll2"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select $&#123;cols&#125; from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>java代码示例:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习9: 动态指定要查询的列 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  <span class="comment">//map.put("cols", "id, name");</span></span><br><span class="line">  <span class="comment">//map.put("cols", "id, name, salary");</span></span><br><span class="line">  map.put(<span class="string">"cols"</span>, <span class="string">"id,name,job,salary"</span>);</span><br><span class="line">  <span class="comment">//执行sql语句, 返回结果</span></span><br><span class="line">  List&lt;Emp&gt; list = session.selectList(<span class="string">"EmpMapper.findAll2"</span>, map);</span><br><span class="line">  <span class="comment">//输出结果</span></span><br><span class="line">  <span class="keyword">for</span> ( Emp e : list ) &#123;</span><br><span class="line">  System.out.println( e );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>示例2: 根据name模糊查询emp表</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习10: 根据name模糊查询emp表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll3"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">  select * from emp</span><br><span class="line">  where name like '%$&#123;name&#125;%'</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习11: 根据name模糊查询emp表 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll4"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">  select * from emp</span><br><span class="line">  where name like #&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 练习10: 根据name模糊查询emp表</span></span><br><span class="line"><span class="comment"> * '%王%' '%刘%'</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//将参数封装到map集合中</span></span><br><span class="line">  Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  map.put(<span class="string">"name"</span>, <span class="string">"涛"</span>);</span><br><span class="line">  <span class="comment">//执行sql, 返回结果</span></span><br><span class="line">  List&lt;Emp&gt; list = session.selectList(<span class="string">"EmpMapper.findAll3"</span>, map);</span><br><span class="line">  <span class="comment">//输出结果</span></span><br><span class="line">  <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">  System.out.println( emp );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 练习11: 根据name模糊查询emp表</span></span><br><span class="line"><span class="comment"> * '%王%' '%刘%'</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll4</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//将参数封装到map集合中</span></span><br><span class="line">  Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  map.put(<span class="string">"name"</span>, <span class="string">"%刘%"</span>);</span><br><span class="line">  <span class="comment">//执行sql, 返回结果</span></span><br><span class="line">  List&lt;Emp&gt; list = session.selectList(<span class="string">"EmpMapper.findAll4"</span>, map);</span><br><span class="line">  <span class="comment">//输出结果</span></span><br><span class="line">  <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">  System.out.println( emp );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意的是，在传递 <code>${}</code> 对应的值时，即使只有一个参数，也需要将值存入<strong>map</strong>集合中！！</p><p>总结：在大多数情况下还是使用#{}占位符，而${}多用于为SQL片段进行占位！</p><h2 id="动态SQL标签"><a href="#动态SQL标签" class="headerlink" title="动态SQL标签"></a>动态SQL标签</h2><h3 id="if、where标签"><a href="#if、where标签" class="headerlink" title="if、where标签"></a>if、where标签</h3><ul><li><p><code>&lt;if&gt;</code>标签：是根据<code>test属性</code>中的布尔表达式的值，从而决定是否执行包含在其中的SQL片段。如果判断结果为true，则执行其中的SQL片段；如果结果为false，则不执行其中的SQL片段</p></li><li><p><code>&lt;where&gt;</code>标签：用于对包含在其中的SQL片段进行检索，在需要时可以生成where关键字，并且在需要时会剔除多余的连接词（比如and或者or）</p></li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/f06a2a2de234a540b189b15d65943989-eb68759a231843fa9d43a07c9c7363c6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-f50f6006b7c7da84f00abe26ef094214.png" alt="f06a2a2de234a540b189b15d65943989"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f06a2a2de234a540b189b15d65943989-eb68759a231843fa9d43a07c9c7363c6.png" target="_blank" rel="noopener">f06a2a2de234a540b189b15d65943989</a></p><p><strong>练习12：根据薪资查询员工信息（if标签）</strong></p><ul><li><code>&lt;if&gt;</code>标签：是根据<code>test属性</code>中的布尔表达式的值，从而决定是否执行包含在其中的SQL片段。如果判断结果为true，则执行其中的SQL片段；如果结果为false，则不执行其中的SQL片段</li></ul><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习12: 根据薪资查询员工信息</span></span><br><span class="line"><span class="comment">* 如果没有参数, 则不执行where子句, 默认查询所有员工：</span></span><br><span class="line"><span class="comment">* select * from emp</span></span><br><span class="line"><span class="comment">* 如果参数中只有minSal(即minSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &gt; minSal</span></span><br><span class="line"><span class="comment">* 如果参数中只有maxSal(即maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &lt; maxSal</span></span><br><span class="line"><span class="comment">* 如果参数有 minSal、maxSal(即minSal、maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">*... where salary &gt; minSal and salary &lt; maxSal  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllBySal"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">  select * from emp</span><br><span class="line">  where 1=1</span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minSal != null"</span>&gt;</span></span><br><span class="line">  and salary&gt;#&#123;minSal&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"maxSal != null"</span>&gt;</span></span><br><span class="line">  and salary &lt;![CDATA[ &lt; ]]&gt; #&#123;maxSal&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 练习12: 根据薪资查询员工信息</span></span><br><span class="line"><span class="comment">* 如果没有参数, 则不执行where子句, 默认查询所有员工：</span></span><br><span class="line"><span class="comment">* select * from emp</span></span><br><span class="line"><span class="comment">* 如果参数中只有minSal(即minSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &gt; minSal</span></span><br><span class="line"><span class="comment">* 如果参数中只有maxSal(即maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &lt; maxSal</span></span><br><span class="line"><span class="comment">* 如果参数有 minSal、maxSal(即minSal、maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">*... where salary &gt; minSal and salary &lt; maxSal  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindBySal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"><span class="comment">//map.put( "minSal" , 3000 );</span></span><br><span class="line"><span class="comment">//map.put( "maxSal", 4000 );</span></span><br><span class="line">List&lt;Emp&gt; list = session.selectList( <span class="string">"EmpMapper.findBySal"</span>, map );</span><br><span class="line"><span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">System.out.println( emp );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习13：根据薪资查询员工信息(where标签)</strong></p><ul><li><code>&lt;where&gt;</code>标签：用于对包含在其中的SQL片段进行检索，在需要时可以生成where关键字，并且在需要时会剔除多余的连接词（比如and或者or）</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习13: 根据薪资查询员工信息</span></span><br><span class="line"><span class="comment">* 如果没有参数, 则不执行where子句, 默认查询所有员工：</span></span><br><span class="line"><span class="comment">* select * from emp</span></span><br><span class="line"><span class="comment">* 如果参数中只有minSal(即minSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &gt; minSal</span></span><br><span class="line"><span class="comment">* 如果参数中只有maxSal(即maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &lt; maxSal</span></span><br><span class="line"><span class="comment">* 如果参数有 minSal、maxSal(即minSal、maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">*... where salary &gt; minSal and salary &lt; maxSal  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAllBySal2"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">  select * from emp</span><br><span class="line">  <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minSal != null"</span>&gt;</span></span><br><span class="line">    and salary&gt;#&#123;minSal&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"maxSal != null"</span>&gt;</span></span><br><span class="line">    and salary &lt;![CDATA[ &lt; ]]&gt; #&#123;maxSal&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 练习13: 根据薪资查询员工信息</span></span><br><span class="line"><span class="comment">* 如果没有参数, 则不执行where子句, 默认查询所有员工：</span></span><br><span class="line"><span class="comment">* select * from emp</span></span><br><span class="line"><span class="comment">* 如果参数中只有minSal(即minSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &gt; minSal</span></span><br><span class="line"><span class="comment">* 如果参数中只有maxSal(即maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">* ... where salary &lt; maxSal</span></span><br><span class="line"><span class="comment">* 如果参数有 minSal、maxSal(即minSal、maxSal不为null), 则：</span></span><br><span class="line"><span class="comment">*... where salary &gt; minSal and salary &lt; maxSal  */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAllBySal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">//封装参数到map集合中</span></span><br><span class="line">  Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">  map.put(<span class="string">"minSal"</span>, <span class="number">3000</span>);</span><br><span class="line">  map.put(<span class="string">"maxSal"</span>, <span class="number">4000.0</span>);</span><br><span class="line">  List&lt;Emp&gt; list = session.selectList(<span class="string">"EmpMapper.findAllBySal2"</span>, map);</span><br><span class="line">  <span class="keyword">for</span> (Emp emp : list) &#123;</span><br><span class="line">  System.out.println( emp );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="foreach元素"><a href="#foreach元素" class="headerlink" title="foreach元素"></a>foreach元素</h3><p>foreach标签：可以对传过来的参数数组或集合进行遍历，以下是foreach标签上的各个属性介绍：</p><table><thead><tr><th>属性</th><th>属性描述</th></tr></thead><tbody><tr><td>collection</td><td>必需，值为遍历的集合类型，例如：如果参数只是一个数组或List集合，则collection的值为array或list；如果传的是多个参数，用map封装，collection则指定为map中的key。</td></tr><tr><td>item</td><td>必需，若collection为数组或List集合时，item表示其中的元素，若collection为map中的key，item表示map中value（集合或数组）中的元素</td></tr><tr><td>open</td><td>可选，表示遍历生成的SQL片段以什么开始，最常用的是左括号’(‘</td></tr><tr><td>close</td><td>可选，表示遍历生成的SQL片段以什么结束，最常用的是右括号’)’</td></tr><tr><td>separator</td><td>可选，每次遍历后给生成的SQL片段后面指定间隔符</td></tr></tbody></table><p><strong>练习14: 根据员工的id批量删除员工信息</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习14: 根据员工的id批量删除员工信息</span></span><br><span class="line"><span class="comment">delete from emp where id in (1,3,5,7)</span></span><br><span class="line"><span class="comment">collection: 如果传的参数仅仅是一个数组或者List集合, collection可以指定为</span></span><br><span class="line"><span class="comment">array或list; 如果传的是多个参数，用map封装，collection则指定为map中的key</span></span><br><span class="line"><span class="comment">open: 指定生成的SQL片段以什么符号开始</span></span><br><span class="line"><span class="comment">close: 指定生成的SQL片段以什么符号结束</span></span><br><span class="line"><span class="comment">item: 指定变量接收数组或集合中的元素</span></span><br><span class="line"><span class="comment">separator: 指定一个间隔符, 在将数组或集合中的每个元素拼接到SQL片段之后, </span></span><br><span class="line"><span class="comment">在后面拼接一个间隔符</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteByIds"</span>&gt;</span></span><br><span class="line">delete from emp where id in</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"array"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 练习14: 根据员工的id批量删除员工信息 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//获取所要删除的员工的id数组</span></span><br><span class="line">Integer[] ids = &#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> rows = session.delete( <span class="string">"EmpMapper.deleteByIds"</span>, ids );</span><br><span class="line">System.out.println( <span class="string">"影响行数: "</span>+rows );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习15：根据员工的id批量更新员工信息</strong></p><p>在mapper文件中编写SQL语句：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习15: 根据员工的id批量更新员工信息</span></span><br><span class="line"><span class="comment"> 将id为 2、4、6、8的员工的薪资在原有基础上增加1000</span></span><br><span class="line"><span class="comment"> update emp set salary=salary + 1000</span></span><br><span class="line"><span class="comment">where id in(2,4,6,8);</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateByIds"</span>&gt;</span></span><br><span class="line">update emp set salary=salary + #&#123;sal&#125;</span><br><span class="line">where id in</span><br><span class="line"><span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"arrIds"</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">item</span>=<span class="string">"id"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java代码实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 练习15: 根据员工的id批量更新员工信息</span></span><br><span class="line"><span class="comment"> * 将id为 2、4、6、8的员工的薪资在原有基础上增加1000</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Integer[] ids = &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;; <span class="comment">//获取所要更新的员工的id数组</span></span><br><span class="line">Double sal = <span class="number">1000.0</span>; <span class="comment">//要涨的薪资</span></span><br><span class="line"><span class="comment">//传递的参数超过1个, 将参数封装到map集合中再传递</span></span><br><span class="line">Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">map.put( <span class="string">"arrIds"</span> , ids );</span><br><span class="line">map.put( <span class="string">"sal"</span>, sal );</span><br><span class="line"><span class="keyword">int</span> rows = session.update( <span class="string">"EmpMapper.updateByIds"</span>, map );</span><br><span class="line">System.out.println( <span class="string">"影响行数: "</span>+rows );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下面练习自己完成：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 练习16：根据员工的id批量查询指定id的员工信息</span></span><br><span class="line"><span class="comment"> * 查询id为 2、4、6、8的员工的信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindByIds</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure><h2 id="Mapper接口开发"><a href="#Mapper接口开发" class="headerlink" title="Mapper接口开发"></a>Mapper接口开发</h2><h3 id="Mapper接口开发介绍"><a href="#Mapper接口开发介绍" class="headerlink" title="Mapper接口开发介绍"></a>Mapper接口开发介绍</h3><p>在上面的Mybatis案例中, 通过SqlSession对象调用方法进行增删改查操作时，方法中需要传入的第一个参数是一个字符串值，该值对应的内容为: (Mapper文件中的)namespace + id, 通过这种方式，找到Mapper文件中映射的SQL语句并执行!!</p><p>这种方式由于传入的是字符串值, 很容易发生字符串拼写错误且编译时期不会提示。</p><p>这里我们将会讲解比上面更加简单的方式，也是我们企业开发中最常用的方式，即使用mapper接口开发。使用mapper接口开发需要注意以下几点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、创建一个接口，接口的全路径名和mapper文件的namespace值要相同</span><br><span class="line">2、mapper文件中每条要执行的SQL语句，在接口中要添加一个对应的方法，并且接口中的方法名和SQL标签上的id值相同</span><br><span class="line">3、Mapper接口中方法接收的参数类型，和mapper.xml中定义的sql的接收的参数类型要相同</span><br><span class="line">4、接口中方法的返回值类型和SQL标签上的resultType即返回值类型相同(如果方法返回值是集合,resultType只需要指定集合中的泛型)</span><br></pre></td></tr></table></figure><h3 id="Mapper接口开发实现"><a href="#Mapper接口开发实现" class="headerlink" title="Mapper接口开发实现"></a>Mapper接口开发实现</h3><p>下面将使用mapper接口开发的方式，实现根据id查询指定的员工信息</p><p><strong>1、创建com.tedu.dao.EmpMapper接口</strong></p><p>由于接口的全路径名(com.tedu.dao.EmpMapper)要和EmpMapper.xml的namespace值保持一致，因此, 这里将namespace的值改为com.tedu.dao.EmpMapper：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">  <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span></span></span><br><span class="line"><span class="meta">  <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.tedu.dao.EmpMapper"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、在接口中提供findById方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 根据id查询员工信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> Emp</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Emp <span class="title">findById</span><span class="params">(Integer id)</span></span>;</span><br></pre></td></tr></table></figure><p>注意:方法的名字要和映射的sql标签的id值保持一致</p><p>方法的返回值类型和resultType的类型要一致</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 1.查询：查询Emp表中指定id的员工信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findById"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3、提供实现类，测试Emp接口中的根据id查询员工的方法</strong></p><p>(1)创建com.tedu.test.TestMybatisInf类, 并提供testFindById方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatisInf</span> </span>&#123;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindById</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4、实现testFindById方法并测试</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindById</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">  ......</span><br><span class="line">  <span class="comment">//3.获取Mapper接口对象</span></span><br><span class="line">  EmpMapper map = session.getMapper(EmpMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  <span class="comment">//4.调用接口对象的方法进行查询</span></span><br><span class="line">  Emp e = map.findById(<span class="number">2</span>);</span><br><span class="line">  <span class="comment">//5.输出结果</span></span><br><span class="line">  System.out.println(e);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5、在接口中提供findAll方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 查询所有的员工信息</span></span><br><span class="line"><span class="comment">* <span class="doctag">@return</span> List&lt;Emp&gt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Emp&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><p>注意:方法的名字要和映射的sql标签的id值保持一致</p><p>方法的返回值类型和resultType的类型要一致, 例如:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 2.查询Emp表中所有员工的信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findAll"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>6、提供实现类，测试Emp接口中的查询所有员工的方法</strong></p><p>(1)创建com.tedu.test.TestMybatisInf类, 并提供testFindAll方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMybatisInf</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span> <span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实现testFindAll方法并测试</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  <span class="comment">//3.获取Mapper接口对象</span></span><br><span class="line">  EmpMapper map = session.getMapper(EmpMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  <span class="comment">//4.调用接口对象的方法进行查询</span></span><br><span class="line">  List&lt;Emp&gt; list = map.findAll();</span><br><span class="line">  <span class="comment">//5.输出结果</span></span><br><span class="line">  <span class="keyword">for</span> (Emp e : list) &#123;</span><br><span class="line">  System.out.println(e);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="几个可以优化的地方"><a href="#几个可以优化的地方" class="headerlink" title="几个可以优化的地方"></a>几个可以优化的地方</h2><h3 id="加入log4j日志框架"><a href="#加入log4j日志框架" class="headerlink" title="加入log4j日志框架"></a>加入log4j日志框架</h3><p>在项目中加入log4j的配置文件，用于打印日志信息，便于开发调试。</p><p>在src（或相似的目录）下创建log4j.properties如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Global logging configuration</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span>=<span class="string">DEBUG, stdout</span></span><br><span class="line"><span class="comment"># Console output...</span></span><br><span class="line"><span class="meta">log4j.appender.stdout</span>=<span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="string">%5p [%t] - %m%n</span></span><br></pre></td></tr></table></figure><p>mybatis默认使用log4j作为输出日志信息。</p><p>只要将该文件放在指定的位置，log4j工具会自动到指定位置加载上述文件，读取文件中的配置信息并使用！</p><h3 id="SQL语句中的特殊符号"><a href="#SQL语句中的特殊符号" class="headerlink" title="SQL语句中的特殊符号"></a>SQL语句中的特殊符号</h3><p><strong>示例：添加一个查询功能：查询薪资小于3500的所有员工。</strong></p><p>1、编辑EmpMapper.xml文件, 添加查询对应的sql.</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 练习12: 根据薪资查询员工信息 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findBySal"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line">where 2=2 </span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minSal != null"</span>&gt;</span></span><br><span class="line">and salary &gt;= #&#123;minSal&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"maxSal != null"</span>&gt;</span></span><br><span class="line">and salary <span class="tag">&lt;<span class="name">=</span> #&#123;<span class="attr">maxSal</span>&#125;</span></span><br><span class="line">&lt;/if&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、但在书写完后，xml文件提示有错误：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200407172154514-eb86f89feeb547af8a44ee3e6c438920.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-584a65a0940df9728034f7df216dc7dc.png" alt="image-20200407172154514"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200407172154514-eb86f89feeb547af8a44ee3e6c438920.png" target="_blank" rel="noopener">image-20200407172154514</a></p><p>原来，小于号（&lt;）在xml文件中是特殊字符，被xml文件当成了标签的开始符号。</p><p>3、解决方法：可以使用 <code>&amp;lt;</code>代替 <code>&lt;</code>，例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findBySal"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line">where 2=2 </span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minSal != null"</span>&gt;</span></span><br><span class="line">and salary &gt;= #&#123;minSal&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"maxSal != null"</span>&gt;</span></span><br><span class="line">and salary <span class="symbol">&amp;lt;</span>= #&#123;maxSal&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>或者是将特殊符号包含在CDATA区（ ）中，这是因为放在CDATA区中的内容，只会被xml解析器当作普通文本来处理。而不是被当成标签的一部分处理。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 查询薪资小于3500的所有员工 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findBySal"</span> <span class="attr">resultType</span>=<span class="string">"com.tedu.pojo.Emp"</span>&gt;</span></span><br><span class="line">select * from emp</span><br><span class="line">where 2=2 </span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minSal != null"</span>&gt;</span></span><br><span class="line">and salary &gt;= #&#123;minSal&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"maxSal != null"</span>&gt;</span></span><br><span class="line">and salary &lt;![CDATA[ &lt;= ]]&gt; #&#123;maxSal&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="jdbc-properties文件"><a href="#jdbc-properties文件" class="headerlink" title="jdbc.properties文件"></a>jdbc.properties文件</h3><p>在开发中，通常我们会将连接数据库的配置信息单独放在一个properties文件中（方便管理和维护），<br>然后在MyBatis的mapper文件中引入properties文件的配置信息即可！</p><p><strong>1、在src目录下创建一个名称为jdbc.properties的文件</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c689eb39f8139c834ce014974d446229-bb4a05eb99f54138b3f31e9c58e3cf87.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-f27ee584566f3d30a1881384cb23508a.png" alt="c689eb39f8139c834ce014974d446229"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c689eb39f8139c834ce014974d446229-bb4a05eb99f54138b3f31e9c58e3cf87.png" target="_blank" rel="noopener">c689eb39f8139c834ce014974d446229</a></p><p><strong>2、jdbc.properties文件内容如下:</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">jdbc.driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/yonghedb?characterEncoding=utf-8</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><p><strong>3、在mybatis-config.xml文件中引入jdbc.properties文件</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7f967dea070cc2df6038dc0a11fcfc7e-e103b441cfcf4b59a6e96c16b8505607.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-7d734ed869da75c5c76629886495ab53.png" alt="7f967dea070cc2df6038dc0a11fcfc7e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7f967dea070cc2df6038dc0a11fcfc7e-e103b441cfcf4b59a6e96c16b8505607.png" target="_blank" rel="noopener">7f967dea070cc2df6038dc0a11fcfc7e</a></p><p>1、其中 <code>&lt;properties resource=&quot;jdbc.properties&quot;/&gt;</code>标签用于引入jdbc.properties文件，默认到classpath即类目录下寻找指定的文件；</p><p>2、properties标签上value属性中配置的 $：</p><p><code>${jdbc.driver}</code>：其实就是jdbc.properties文件中的 jdbc.driver的值，即：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.mysql.jdbc.Driver</span><br></pre></td></tr></table></figure><p><code>${jdbc.url}</code>：其实就是jdbc.properties文件中的 jdbc.url的值，即：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql:&#x2F;&#x2F;localhost:3306&#x2F;mybatisdb?characterEncoding&#x3D;utf-8</span><br></pre></td></tr></table></figure><p><code>${jdbc.username}</code>：其实就是jdbc.properties文件中的 jdbc.username的值，即：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root</span><br></pre></td></tr></table></figure><p><code>${jdbc.password}</code>：其实就是jdbc.properties文件中的 jdbc.password的值，即：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root</span><br></pre></td></tr></table></figure><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><h3 id="Jdbc回顾"><a href="#Jdbc回顾" class="headerlink" title="Jdbc回顾"></a>Jdbc回顾</h3><p><em>通过JDBC查询Emp表中的所有记录，并封装到一个List集合中返回</em></p><p><strong>1、创建TestJdbc类，完成查询所有员工：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> com.tedu.pojo.Emp;</span><br><span class="line"><span class="comment">/** Jdbc回顾 */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestJdbc</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 查询emp表中的所有员工信息，将每个员工信息的封装到一个</span></span><br><span class="line"><span class="comment"> * Emp对象中，再将封装了员工信息所有Emp对象存入List集合</span></span><br><span class="line"><span class="comment"> * 中，并遍历输出所有的员工信息 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;Emp&gt; empList = findAll();</span><br><span class="line"><span class="keyword">for</span>(Emp emp : empList)&#123;</span><br><span class="line">System.out.println(emp);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询emp表中的所有员工信息,封装到List集合并返回</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Emp&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//1.注册数据库驱动</span></span><br><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line"><span class="comment">//2.获取数据库连接(Connection)</span></span><br><span class="line">conn = DriverManager.getConnection(</span><br><span class="line"><span class="string">"jdbc:mysql:///yonghedb"</span>, </span><br><span class="line"><span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line"><span class="comment">//3.获取传输器</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line"><span class="comment">//4.利用传输器发送sql到数据库执行,并返回执行结果</span></span><br><span class="line">String sql = <span class="string">"select * from emp"</span>;</span><br><span class="line">rs = stat.executeQuery(sql);</span><br><span class="line"><span class="comment">//5.处理结果</span></span><br><span class="line"><span class="comment">//5.1.声明List集合,用于封装所有的员工信息</span></span><br><span class="line">List&lt;Emp&gt; empList = <span class="keyword">new</span> ArrayList();</span><br><span class="line"><span class="comment">//5.2.遍历ResultSet结果集</span></span><br><span class="line"><span class="keyword">while</span>(rs.next()) &#123;</span><br><span class="line"><span class="comment">//5.3.获取结果集中的每一条员工信息</span></span><br><span class="line"><span class="keyword">int</span> id = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">String job = rs.getString(<span class="string">"job"</span>);</span><br><span class="line"><span class="keyword">double</span> salary = rs.getDouble(<span class="string">"salary"</span>);</span><br><span class="line"><span class="comment">//5.4.将每一条员工信息封装到一个Emp对象中</span></span><br><span class="line">Emp emp = <span class="keyword">new</span> Emp();</span><br><span class="line">emp.setId(id);</span><br><span class="line">emp.setName(name);</span><br><span class="line">emp.setJob(job);</span><br><span class="line">emp.setSalary(salary);</span><br><span class="line"><span class="comment">//5.5.将Emp对象存入List集合中</span></span><br><span class="line">empList.add(emp);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> empList;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">System.out.println(<span class="string">"查询失败!"</span>);</span><br><span class="line">&#125; <span class="keyword">finally</span>&#123;</span><br><span class="line"><span class="comment">//6.释放资源</span></span><br><span class="line"><span class="keyword">if</span>(rs != <span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">rs.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">rs = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(stat != <span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">stat.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">stat = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(conn != <span class="keyword">null</span>)&#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">conn.close();</span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">conn = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、声明Emp实体类，用于封装员工信息：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tedu.pojo;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实体类,用于封装Emp表中的一条用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line"><span class="comment">//1.声明实体类中的属性</span></span><br><span class="line"><span class="keyword">private</span> Integer id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="keyword">private</span> String job;</span><br><span class="line"><span class="keyword">private</span> Double salary;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.提供对应的getter和setter方法</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setJob</span><span class="params">(String job)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.job = job;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Double <span class="title">getSalary</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> salary;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSalary</span><span class="params">(Double salary)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.salary = salary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.重写toString方法</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"Emp [id="</span> + id + <span class="string">", name="</span> + name + <span class="string">", job="</span> + job + <span class="string">", salary="</span> + salary + <span class="string">"]"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="mybatis-config文件没有提示的解决办法"><a href="#mybatis-config文件没有提示的解决办法" class="headerlink" title="mybatis-config文件没有提示的解决办法"></a>mybatis-config文件没有提示的解决办法</h3><p>如果在没有网络(外网)的情况下，编写mybatis-config.xml文件没有提示，可以按照下面的步骤进行配置：</p><p>(1)找到mybatis-3-config.dtd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/065e6b731aa74d5650821fdc63cbd4b9-a916b8fe6d80434da075b2c70213be5f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-370d55e6e8b991ac89040032a7b32833.png" alt="065e6b731aa74d5650821fdc63cbd4b9"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/065e6b731aa74d5650821fdc63cbd4b9-a916b8fe6d80434da075b2c70213be5f.png" target="_blank" rel="noopener">065e6b731aa74d5650821fdc63cbd4b9</a></p><p>(2)复制下面的url地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-config.dtd</span><br></pre></td></tr></table></figure><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ] XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-da6604b74ae942c9a0e27565879c55a6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-c630c3dad6bade32ffb34594d1e1934b.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-da6604b74ae942c9a0e27565879c55a6.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/364a97a96fcb74e6ca14d4a9c8b89e6b-671989c3b2f2458db7b49fe32a23d85d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-1c33bab8ff1f359f0bea91f65ced15b8.png" alt="364a97a96fcb74e6ca14d4a9c8b89e6b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/364a97a96fcb74e6ca14d4a9c8b89e6b-671989c3b2f2458db7b49fe32a23d85d.png" target="_blank" rel="noopener">364a97a96fcb74e6ca14d4a9c8b89e6b</a></p><h3 id="Mapper文件没有提示的解决办法"><a href="#Mapper文件没有提示的解决办法" class="headerlink" title="Mapper文件没有提示的解决办法"></a>Mapper文件没有提示的解决办法</h3><p>如果在没有网络(外网)的情况下，编写XxxMapper.xml文件没有提示，可以按照下面的步骤进行配置：</p><p>(1)找到mybatis-3-mapper.dtd的文件的位置，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/50f2e9357bd4d42791f85098a75795c0-2a02d2ee0058408fbcef5d7c75df4838.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-85577d9508e29c05364cccc92fa1c6ac.png" alt="50f2e9357bd4d42791f85098a75795c0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/50f2e9357bd4d42791f85098a75795c0-2a02d2ee0058408fbcef5d7c75df4838.png" target="_blank" rel="noopener">50f2e9357bd4d42791f85098a75795c0</a></p><p>(2)复制上面的url地址，即：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;mybatis.org&#x2F;dtd&#x2F;mybatis-3-mapper.dtd</span><br></pre></td></tr></table></figure><p>(3)在eclipse菜单栏中: window –&gt; Preferences –&gt; 在搜索框中搜索 [ xml ] XML –&gt; XML Catalog –&gt; User Specified Entries –&gt; Add…</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-da6604b74ae942c9a0e27565879c55a6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-c630c3dad6bade32ffb34594d1e1934b.png" alt="eef68594c0d7b072e09702b3d6289831"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eef68594c0d7b072e09702b3d6289831-da6604b74ae942c9a0e27565879c55a6.png" target="_blank" rel="noopener">eef68594c0d7b072e09702b3d6289831</a></p><p>(4)在弹出的窗口中:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e907b64d04d56389acba7c7e2f6bd74c-cba9037ad45f4a5ba191d984473736ed.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-68eadb9243ff12811b56bea1348cf8f5.png" alt="e907b64d04d56389acba7c7e2f6bd74c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e907b64d04d56389acba7c7e2f6bd74c-cba9037ad45f4a5ba191d984473736ed.png" target="_blank" rel="noopener">e907b64d04d56389acba7c7e2f6bd74c</a></p><h3 id="配置达内XML-Schema代理服务器"><a href="#配置达内XML-Schema代理服务器" class="headerlink" title="配置达内XML Schema代理服务器"></a>配置达内XML Schema代理服务器</h3><p>1、打开Eclipse的配置首选项</p><p>![<a href="http://doc.tedu.cn/img/1.png\](JAVAWEB-[![eb81455caf93624c289a4e60105b6aca](assets/1591871178-5431f18504a02a423ca84e597dd95e5a.png)](https://www.zhangpeng.fun/upload/2020/06/eb81455caf93624c289a4e60105b6aca-67e645a62bde49b28fcc2e35a2589c87.png)" target="_blank" rel="noopener">http://doc.tedu.cn/img/1.png\](JAVAWEB-[![eb81455caf93624c289a4e60105b6aca](assets/1591871178-5431f18504a02a423ca84e597dd95e5a.png)](https://www.zhangpeng.fun/upload/2020/06/eb81455caf93624c289a4e60105b6aca-67e645a62bde49b28fcc2e35a2589c87.png)</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eb81455caf93624c289a4e60105b6aca-67e645a62bde49b28fcc2e35a2589c87.png" target="_blank" rel="noopener">eb81455caf93624c289a4e60105b6aca</a></p><p>2、找到 XML -&gt; XML Catalog, 添加配置项目：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf2d8978925006db94220c283a695f57-94054f0992804ea8bb0fddc0c21d042d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-e26bbce57f51c702b09be41d0ef58ad3.png" alt="bf2d8978925006db94220c283a695f57"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/bf2d8978925006db94220c283a695f57-94054f0992804ea8bb0fddc0c21d042d.png" target="_blank" rel="noopener">bf2d8978925006db94220c283a695f57</a></p><p>3、添加URI代理配置, 比如：配置Spring Schema</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7e5343736b72ca605ac7e577025ccd9e-65db6fe953154f3b9146fc5993c4fa9f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871178-5f4d7d839dee52a92eef391b9adbfcb0.png" alt="7e5343736b72ca605ac7e577025ccd9e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7e5343736b72ca605ac7e577025ccd9e-65db6fe953154f3b9146fc5993c4fa9f.png" target="_blank" rel="noopener">7e5343736b72ca605ac7e577025ccd9e</a></p><p><strong>4、可以配置的代理有</strong></p><table><thead><tr><th></th><th><a href="http://ibatis.apache.org/" target="_blank" rel="noopener">http://ibatis.apache.org</a></th><th><a href="http://doc.tedu.cn/" target="_blank" rel="noopener">http://doc.tedu.cn</a></th></tr></thead><tbody><tr><td></td><td><a href="http://www.springframework.org/" target="_blank" rel="noopener">http://www.springframework.org</a></td><td><a href="http://doc.tedu.cn/" target="_blank" rel="noopener">http://doc.tedu.cn</a></td></tr><tr><td></td><td><a href="http://mybatis.org/" target="_blank" rel="noopener">http://mybatis.org</a></td><td><a href="http://doc.tedu.cn/" target="_blank" rel="noopener">http://doc.tedu.cn</a></td></tr><tr><td></td><td><a href="http://hibernate.sourceforge.net/" target="_blank" rel="noopener">http://hibernate.sourceforge.net</a>, <a href="http://www.hibernate.org/" target="_blank" rel="noopener">http://www.hibernate.org</a></td><td><a href="http://doc.tedu.cn/" target="_blank" rel="noopener">http://doc.tedu.cn</a></td></tr><tr><td></td><td><a href="http://struts.apache.org/" target="_blank" rel="noopener">http://struts.apache.org</a></td><td><a href="http://doc.tedu.cn/" target="_blank" rel="noopener">http://doc.tedu.cn</a></td></tr></tbody></table><h1 id="mybatis-javaweb"><a href="#mybatis-javaweb" class="headerlink" title="mybatis   javaweb"></a><a href="https://www.zhangpeng.fun/tags/mybatis" target="_blank" rel="noopener">mybatis</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="mybatis" scheme="https://zpengit.github.io/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>11-MySQL数据库事务</title>
    <link href="https://zpengit.github.io/2020/06/11/11-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/"/>
    <id>https://zpengit.github.io/2020/06/11/11-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1/</id>
    <published>2020-06-11T10:52:54.061Z</published>
    <updated>2020-06-11T10:45:53.634Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="11-MySQL数据库事务"><a href="#11-MySQL数据库事务" class="headerlink" title="11-MySQL数据库事务"></a>11-MySQL数据库事务</h1><h1 id="unit11-MySQL数据库事务"><a href="#unit11-MySQL数据库事务" class="headerlink" title="unit11-MySQL数据库事务"></a>unit11-MySQL数据库事务</h1><p><strong>今日目标:</strong></p><ul><li><p>了解事务的作用</p></li><li><p>掌握事务的四大特性(面试)</p></li><li><p>了解事务的三个并发读问题</p></li><li><p>掌握mysql开启和结束事务</p></li><li><p>了解事物的四个隔离级别</p></li></ul><h2 id="事务及四大特性"><a href="#事务及四大特性" class="headerlink" title="事务及四大特性"></a>事务及四大特性</h2><h3 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h3><p>数据库事务(Database Transaction)，是指作为单个逻辑工作单元执行的一系列操作，要么完全地执行，要么完全地不执行。</p><p>简单的说：事务就是将一堆的SQL语句(通常是增删改操作)绑定在一起执行，要么都执行成功，要么都执行失败，即都执行成功才算成功，否则就会恢复到这堆SQL执行之前的状态。</p><p>下面以银行转账为例，张三转100块到李四的账户，这至少需要两条SQL语句：</p><ul><li>给张三的账户减去100元；</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 账户表 <span class="keyword">set</span> money=money<span class="number">-100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'张三'</span>;</span><br></pre></td></tr></table></figure><ul><li>给李四的账户加上100元。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 账户表 <span class="keyword">set</span> money=money+<span class="number">100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'李四'</span>;</span><br></pre></td></tr></table></figure><p>如果在第一条SQL语句执行成功后，在执行第二条SQL语句之前，程序被中断了（可能是抛出了某个异常，也可能是其他什么原因），那么李四的账户没有加上100元，而张三却减去了100元，在现实生活中这肯定是不允许的。</p><p>如果在转账过程中加入事务，则整个转账过程中执行的所有SQL语句会在一个事务中，而事务中的所有操作，要么全都成功，要么全都失败，不可能存在成功一半的情况。</p><p>也就是说给张三的账户减去100元如果成功了，那么给李四的账户加上100元的操作也必须是成功的；否则，给张三减去100元以及给李四加上100元都是失败的。</p><h3 id="事务的四大特性"><a href="#事务的四大特性" class="headerlink" title="事务的四大特性"></a>事务的四大特性</h3><p>事务的四大特性(ACID)是：</p><p>(1)<strong>原子性</strong>（Atomicity）：事务中所有操作是不可再分割的原子单位。事务中所有操作要么全部执行成功，要么全部执行失败。</p><p>(2)<strong>一致性</strong>（Consistency）：事务执行后，数据库状态与其它业务规则保持一致。如转账业务，无论事务执行成功与否，参与转账的两个账户金额之和在事务前后应该是保持不变的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">张三：10001000-500&#x3D;5001000</span><br><span class="line">李四：10001000+500&#x3D;1500 1000</span><br></pre></td></tr></table></figure><p>(3)<strong>隔离性</strong>（Isolation）：隔离性是指在并发操作中，不同事务之间应该隔离开来，使每个并发中的事务不会相互干扰。也就是说，在事中务查看数据更新时，数据所处的状态要么是另一事务修改它之前的状态，要么是另一事务修改它之后的状态，事务不会查看到中间状态的数据。例如：在A事务中，查看另一B事务(正在修改张三的账户金额)中张三的账户金额，要查看到B事务之前的张三的账户金额，要么查看到B事务之后张三的账户金额。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">事务1: 查询A、B账户金额之和（1000+1000）</span><br><span class="line">事务2: A转账给B 500元</span><br><span class="line">A - 500 &#x3D; 500</span><br><span class="line">B + 500 &#x3D; 1500</span><br></pre></td></tr></table></figure><p>(4)<strong>持久性</strong>（Durability）：一旦事务提交成功，事务中所有的数据操作都必须被持久化到数据库中，即使提交事务后，数据库马上崩溃，在数据库重启时，也必须能保证通过某种机制恢复数据。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">开启事务---A给B转账500元</span><br><span class="line">A: 1000 - 500 &#x3D; 500(成功了)在日志中记录,事务成功,A账户金额更新为500</span><br><span class="line">B: 1000 + 500 &#x3D; 1500 (成功了)在日志中记录,事务成功,B账户金额更新为1500</span><br><span class="line">结束事务---回滚&#x2F;提交</span><br></pre></td></tr></table></figure><h2 id="MySQL中的事务"><a href="#MySQL中的事务" class="headerlink" title="MySQL中的事务"></a>MySQL中的事务</h2><p>在默认情况下，MySQL每执行一条SQL语句，都是一个单独的事务。因为底层在执行SQL语句之前会自动开启事务，在SQL语句执行完后，会立即结束事务！</p><p>如果需要在一个事务中包含多条SQL语句，那么需要手动开启事务和结束事务。</p><ul><li><p>开启事务：start transaction；</p></li><li><p>结束事务：commit（提交事务）或 rollback（回滚事务）。</p></li></ul><p>在执行SQL语句之前，先执行 strat transaction，这就开启了一个事务（事务的起点），然后可以去执行多条SQL语句，最后要结束事务，<strong>commit</strong>表示提交，即事务中的多条SQL语句所做出的影响会持久化到数据库中。或者<strong>rollback</strong>，表示回滚，即回滚到事务的起点，之前做的所有操作都被撤消了！</p><p>下面演示A账户给B账户转账的例子：</p><p><strong>准备数据：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、创建数据库jt_db数据库(如果不存在才创建)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> jt_db <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db数据库</span></span><br><span class="line"><span class="comment">-- 2、在 jt_db 库中创建 acc 表(银行账户表),要求有id(主键),name(姓名),money(账户金额)</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="keyword">acc</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">acc</span>(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    money <span class="keyword">double</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 3、往 acc 表中, 插入2条记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'A'</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'B'</span>,<span class="number">1000</span>);</span><br><span class="line"><span class="comment">-- 查询acc表中的所有记录</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span>;</span><br></pre></td></tr></table></figure><p>下面分别演示事务开启及执行一系列SQL之后，回滚事务、提交事务及中断操作的效果。</p><p>-- <strong>rollback（回滚事务）</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 查询acc账户表中A和B的金额</span><br><span class="line">select * from acc;</span><br><span class="line">-- 开启事务</span><br><span class="line">start transaction;</span><br><span class="line">-- 开始转账，A账户减去100元</span><br><span class="line">update acc set money&#x3D;money-100 where name&#x3D;&#39;A&#39;;</span><br><span class="line">-- 查询acc账户表中A和B的金额</span><br><span class="line">select * from acc;</span><br><span class="line">-- B账户增加100元</span><br><span class="line">update acc set money&#x3D;money+100 where name&#x3D;&#39;B&#39;;</span><br><span class="line">-- 查询acc账户表中A和B的金额</span><br><span class="line">select * from acc;</span><br><span class="line">-- 回滚事务</span><br><span class="line">rollback;</span><br><span class="line">-- 再次查询acc账户表中A和B的金额</span><br><span class="line">select * from acc;</span><br></pre></td></tr></table></figure><p>-- <strong>commit（提交事务）</strong>：将上面的操作再做一次，最后将rollback替换为commit，即提交事务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commit;</span><br></pre></td></tr></table></figure><p>-- <strong>中断操作</strong>：将上面的操作再做一次，最后将rollback替换为quit，即中断操作</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quit;</span><br></pre></td></tr></table></figure><h2 id="事务并发读问题"><a href="#事务并发读问题" class="headerlink" title="事务并发读问题"></a>事务并发读问题</h2><h3 id="事务并发读问题-1"><a href="#事务并发读问题-1" class="headerlink" title="事务并发读问题"></a>事务并发读问题</h3><p>多个事务对相同的数据同时进行操作，这叫做事务并发。</p><p>在事务并发时，如果没有采取必要的隔离措施，可能会导致各种并发问题，破坏数据的完整性等。这些问题中，其中有三类是读问题，分别是：脏读、不可重复读、幻读。</p><p>(1)<strong>脏读</strong>（dirty read）：在一个事务中，读取到另一个事务未提交更新的数据，即读取到了脏数据；</p><p>例如：A给B转账100元但未提交事务，在B查询后，A做了回滚操作，那么B查询到了A未提交的数据，就称之为脏读。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">提示：需要将数据库的事务隔离级别设置为最低，才能够看到脏读现象</span><br><span class="line">事务1：开启事务; A - 100 &#x3D; 900; B + 100 &#x3D; 1100; (没有提交事务)</span><br><span class="line">事务2：开启事务; 查询B账户的金额 1100, 这个过程叫做脏读, 1100就是一个脏数据</span><br></pre></td></tr></table></figure><p>(2)<strong>不可重复读</strong>（unrepeatable read）：对同一记录的两次读取结果不一致，因为在两次查询期间，有另一事务对该记录做了修改（是针对修改操作）</p><p>例如：在事务1中，前后两次查询A账户的金额，在两次查询之间，另一事物2对A账户的金额做了修改（并且也提交了事务），此种情况可能会导致事务1中，前后两次查询的结果不一致。这就是不可重复读。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">事务1：开启事务---</span><br><span class="line">第一次读取A账户的金额：1000</span><br><span class="line">第二次读取A账户的金额：900</span><br><span class="line">事务2：开启事务---</span><br><span class="line">A账户 - 100 &#x3D; 900;</span><br><span class="line">提交事务---</span><br></pre></td></tr></table></figure><p>(3)<strong>幻读（虚读）</strong>（phantom read）：对同一张表的两次查询结果不一致，因为在两次查询期间，有另一事务进行了插入或者是删除操作(是针对插入或删除操作)；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">事务1：开启事务<span class="comment">---</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;//不存在id为3的记录</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">value</span>(<span class="number">3</span>,<span class="string">'C'</span>,<span class="number">2000</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;//存在id为3的记录</span><br><span class="line">事务2：开启事务<span class="comment">---</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">value</span>(<span class="number">3</span>,<span class="string">'C'</span>,<span class="number">2000</span>);</span><br><span class="line">提交事务<span class="comment">---</span></span><br></pre></td></tr></table></figure><p>注意:mysql默认的是不允许出现脏读和不可重复读，所以在下面演示之前需要设置mysql允许出现脏读、不可重复读等。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set tx_isolation&#x3D;&#39;read-uncommitted&#39;; -- 设置mysql的事务隔离级别</span><br></pre></td></tr></table></figure><p><strong>1、脏读示例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在窗口1中，开启事务，执行A给B转账100元</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>; <span class="comment">-- 允许脏读、不可重复读、幻读</span></span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money=money<span class="number">-100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span>;</span><br><span class="line"><span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money=money+<span class="number">100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'B'</span>;</span><br><span class="line"><span class="comment">-- 在窗口2中，开启事务，查询B的账户金额</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>; <span class="comment">-- 允许脏读、不可重复读、幻读</span></span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'B'</span>; <span class="comment">-- 出现脏数据</span></span><br><span class="line"><span class="comment">-- 切换到窗口1，回滚事务，撤销转账操作。</span></span><br><span class="line"><span class="keyword">rollback</span>; <span class="comment">-- 回滚事务</span></span><br><span class="line"><span class="comment">-- 切换到窗口2，查询B的账户金额</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'B'</span>;</span><br></pre></td></tr></table></figure><p>在窗口2中，B看到自己的账户增加了100元（此时的数据A操作事务并未提交），此种情况称之为”脏读”。</p><p><strong>2、不可重复读示例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在窗口1中，开启事务，查询A账户的金额</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>; <span class="comment">-- 允许脏读、不可重复读、幻读</span></span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span>;</span><br><span class="line"><span class="comment">-- 在窗口2中，开启事务，查询A的账户金额减100</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>; <span class="comment">-- 允许脏读、不可重复读、幻读</span></span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money=money<span class="number">-100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span>; <span class="comment">-- A账户减去100</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span>;</span><br><span class="line"><span class="keyword">commit</span>; <span class="comment">-- 提交事务</span></span><br><span class="line"><span class="comment">-- 切换到窗口1，再次查询A账户的金额。</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span>; <span class="comment">-- 前后查询结果不一致</span></span><br></pre></td></tr></table></figure><p>在窗口1中，前后两次对同一数据(账户A的金额)查询结果不一致，是因为在两次查询之间，另一事务对A账户的金额做了修改。此种情况就是”不可以重复读”</p><p><strong>3、幻读示例：</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在窗口1中，开启事务，查询账户表中是否存在id=3的账户</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>; <span class="comment">-- 允许脏读、不可重复读、幻读</span></span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">acc</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">3</span>;</span><br><span class="line"><span class="comment">-- 在窗口2中，开启事务，往账户表中插入了一条id为3记录，并提交事务。</span></span><br><span class="line"><span class="comment">-- 设置mysql允许出现脏读、不可重复度、幻读</span></span><br><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>;</span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db库</span></span><br><span class="line"><span class="keyword">start</span> <span class="keyword">transaction</span>; <span class="comment">-- 开启事务</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">values</span>(<span class="number">3</span>, <span class="string">'C'</span>, <span class="number">1000</span>);</span><br><span class="line"><span class="keyword">commit</span>; <span class="comment">-- 提交事务</span></span><br><span class="line"><span class="comment">-- 切换到窗口1，由于上面窗口1中查询到没有id为3的记录，所以可以插入id为3的记录。</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">acc</span> <span class="keyword">values</span>(<span class="number">3</span>, <span class="string">'C'</span>, <span class="number">1000</span>); <span class="comment">-- 插入会失败!</span></span><br></pre></td></tr></table></figure><p>在窗口1中，查询了不存在id为3的记录，所以接下来要执行插入id为3的记录，但是还未执行插入时，另一事务中插入了id为3的记录并提交了事务，所以接下来窗口1中执行插入操作会失败。</p><p>探究原因，发现账户表中又有了id为3的记录（感觉像是出现了幻觉）。这种情况称之为”幻读”</p><p>以上就是在事务并发时常见的三种并发读问题，那么如何防止这些问题的产生？</p><p>可以通过设置事务隔离级别进行预防。</p><h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><p>事务隔离级别分四个等级，在相同数据环境下，对数据执行相同的操作，设置不同的隔离级别，可能导致不同的结果。不同事务隔离级别能够解决的数据并发问题的能力也是不同的。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> tx_isolation=<span class="string">'read-uncommitted'</span>;</span><br></pre></td></tr></table></figure><p><strong>1、READ UNCOMMITTED（读未提交数据）</strong></p><p>安全性最差，可能出现任何事务并发问题(比如脏读、不可以重复读、幻读等)</p><p>但性能最好（不使用!!）</p><p><strong>2、READ COMMITTED（读已提交数据）</strong>（Oracle默认）</p><p>安全性较差</p><p>性能较好</p><p>可以防止<strong>脏读</strong>，但不能防止不可重复读，也不能防止幻读；</p><p><strong>3、REPEATABLE READ（可重复读）</strong>（MySQL默认）</p><p>安全性较高</p><p>性能较差</p><p>可以防止<strong>脏读</strong>和<strong>不可重复读</strong>，但不能防止幻读问题；</p><p><strong>4、SERIALIZABLE（串行化）</strong></p><p>安全性最高，不会出现任何并发问题，因为它对同一数据的访问是串行的，非并发访问；</p><p>性能最差；(不使用!!)</p><p>MySQL的默认隔离级别为REPEATABLE READ，即可以防止脏读和不可重复读</p><h3 id="设置隔离级别-了解"><a href="#设置隔离级别-了解" class="headerlink" title="设置隔离级别(了解)"></a>设置隔离级别(了解)</h3><p>0、MySQL查询当前的事务隔离级别</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> @@tx_isolation;</span><br></pre></td></tr></table></figure><p><strong>1、MySQL设置事务隔离级别（了解）</strong></p><p>(1) set tx_isolation=’read-uncommitted’;　</p><p>安全性最差，容易出现<strong>脏读</strong>、<strong>不可重复读</strong>、<strong>幻读</strong>，但性能最高</p><p>(2) set tx_isolation=’read-committed’;</p><p>安全性一般，可防止<strong>脏读</strong>，不能防止<strong>不可重复读</strong>、<strong>幻读</strong></p><p>(3) set tx_isolation=’repeatable-read’;</p><p>安全性较好，可防止<strong>脏读</strong>、<strong>不可重复读</strong>，但不能防止<strong>幻读</strong></p><p>(4) set tx_isolation=’serialiable’;</p><p>安全性最好，可以防止一切事务并发问题，但是性能最差。</p><p><strong>2、JDBC设置事务隔离界别</strong></p><p>JDBC中通过Connection提供的方法设置事务隔离级别：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection.setTransactionIsolation(int level)</span><br></pre></td></tr></table></figure><p>参数可选值如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Connection.TRANSACTION_READ_UNCOMMITTED 1（读未提交数据）</span><br><span class="line">Connection.TRANSACTION_READ_COMMITTED 2（读已提交数据）</span><br><span class="line">Connection.TRANSACTION_REPEATABLE_READ 4（可重复读）</span><br><span class="line">Connection.TRANSACTION_SERIALIZABLE 8（串行化）</span><br><span class="line">Connection.TRANSACTION_NONE 0（不使用事务）</span><br></pre></td></tr></table></figure><p>提示：在开发中，一般情况下不需要修改事务隔离级别</p><p><strong>3、JDBC中实现转账例子</strong></p><p>提示：JDBC中默认是自动提交事务，所以需要关闭自动提交，改为手动提交事务</p><p>也就是说, 关闭了自动提交后, 事务就自动开启, 但是执行完后需要手动提交或者回滚!!</p><p>(1)执行下面的程序，程序执行没有异常，转账成功！A账户减去100元，B账户增加100元。</p><p>(2)将第4步、5步中间的代码放开，再次执行程序，在转账过程中抛异常，转账失败！由于事务回滚，所以A和B账户金额不变。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws SQLException &#123;</span><br><span class="line">    Connection conn = null;</span><br><span class="line">    Statement stat = null;</span><br><span class="line">    ResultSet rs = null;</span><br><span class="line">    try &#123;</span><br><span class="line">        //1.获取连接</span><br><span class="line">        conn = JdbcUtil.getConn();</span><br><span class="line">        //2.关闭JDBC自动提交事务（默认开启事务）</span><br><span class="line">        conn.setAutoCommit(false);</span><br><span class="line">        //3.获取传输器</span><br><span class="line">        stat = conn.createStatement();</span><br><span class="line">        <span class="comment">/* ***** A给B转账100元 ***** */</span></span><br><span class="line">        //4.A账户减去100元</span><br><span class="line">        String sql = "<span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money=money<span class="number">-100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'A'</span><span class="string">";</span></span><br><span class="line"><span class="string">        stat.executeUpdate(sql);</span></span><br><span class="line"><span class="string">        //int i = 1/0; // 让程序抛出异常，中断转账操作</span></span><br><span class="line"><span class="string">        //5.B账户加上100元</span></span><br><span class="line"><span class="string">        sql = "</span><span class="keyword">update</span> <span class="keyword">acc</span> <span class="keyword">set</span> money=money+<span class="number">100</span> <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'B'</span><span class="string">";</span></span><br><span class="line"><span class="string">        stat.executeUpdate(sql);</span></span><br><span class="line"><span class="string">        //6.手动提交事务</span></span><br><span class="line"><span class="string">        conn.commit();</span></span><br><span class="line"><span class="string">        System.out.println("</span>转账成功！提交事务...<span class="string">");</span></span><br><span class="line"><span class="string">    &#125; catch (Exception e) &#123;</span></span><br><span class="line"><span class="string">    e.printStackTrace();</span></span><br><span class="line"><span class="string">    //一旦其中一个操作出错都将回滚，使两个操作都不成功</span></span><br><span class="line"><span class="string">    conn.rollback();</span></span><br><span class="line"><span class="string">   System.out.println("</span>执行失败！回滚事务...<span class="string">");</span></span><br><span class="line"><span class="string">    &#125; finally&#123;</span></span><br><span class="line"><span class="string">    JdbcUtil.close(conn, stat, rs);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="mysql-javaweb"><a href="#mysql-javaweb" class="headerlink" title="mysql   javaweb"></a><a href="https://www.zhangpeng.fun/tags/mysql" target="_blank" rel="noopener">mysql</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="mysql" scheme="https://zpengit.github.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>10-Cookie、Session</title>
    <link href="https://zpengit.github.io/2020/06/11/10-Cookie%E3%80%81Session/"/>
    <id>https://zpengit.github.io/2020/06/11/10-Cookie%E3%80%81Session/</id>
    <published>2020-06-11T10:52:49.449Z</published>
    <updated>2020-06-11T10:45:42.363Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="10-Cookie、Session"><a href="#10-Cookie、Session" class="headerlink" title="10-Cookie、Session"></a>10-Cookie、Session</h1><h1 id="unit10-Cookie、Session"><a href="#unit10-Cookie、Session" class="headerlink" title="unit10-Cookie、Session"></a>unit10-Cookie、Session</h1><h2 id="什么是会话"><a href="#什么是会话" class="headerlink" title="什么是会话"></a>什么是会话</h2><p>什么是会话：当浏览器发请求访问服务器开始，一直到访问服务器结束，浏览器关闭为止，这期间浏览器和服务器之间产生的所有请求和响应加在一起，就称之为浏览器和服务器之间的一次会话。</p><p>在一次会话中往往会产生一些数据，而这些数据往往是需要我们保存起来的，如何保存会话中产生的这些数据呢？</p><ul><li>比如在购物过程中，将商品加入购物车，其实就是将商品信息保存到数据库中。（不讨论）</li><li>如果在没有登录时，将商品加入购物车，其实就是将商品信息保存到了cookie或session中。</li></ul><p>可以使用cookie或者session保存会话中产生的数据。</p><p>如何将会话中产生的数据保存到cookie或者是session中？</p><h2 id="cookie原理及应用"><a href="#cookie原理及应用" class="headerlink" title="cookie原理及应用"></a>cookie原理及应用</h2><h3 id="cookie的工作原理"><a href="#cookie的工作原理" class="headerlink" title="cookie的工作原理"></a>cookie的工作原理</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/35f0bd1bfc616e3bfcc9e96c189444ee-03acd5c8f7554c8aa6aee2bf6aabf42c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-28bc9f1df1e0b02f693d6002321cb7a3.png" alt="35f0bd1bfc616e3bfcc9e96c189444ee"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/35f0bd1bfc616e3bfcc9e96c189444ee-03acd5c8f7554c8aa6aee2bf6aabf42c.png" target="_blank" rel="noopener">35f0bd1bfc616e3bfcc9e96c189444ee</a></p><ol><li>Cookie是将会话中产生的数据保存在客户端，是客户端技术。</li><li>Cookie是基于两个头进行工作的：分别是Set-Cookie响应头和Cookie请求头</li><li>通过Set-Cookie响应头将cookie从服务器端发送给浏览器，让浏览器保存到内部；而浏览器一旦保存了cookie，以后浏览器每次访问服务器时，都会通过cookie请求头，将cookie信息再带回服务器中。在需要时，在服务器端可以获取请求中的cookie中的数据，从而实现某些功能。</li></ol><h3 id="cookie的API及应用"><a href="#cookie的API及应用" class="headerlink" title="cookie的API及应用"></a>cookie的API及应用</h3><p><strong>1、创建Cookie对象</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cookie c = <span class="keyword">new</span> Cookie(String name, String value);</span><br><span class="line"><span class="comment">// 创建cookie的同时需要指定cookie的名字和cookie要保存的值</span></span><br></pre></td></tr></table></figure><p><strong>2、将Cookie添加到response响应中</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">response.addCookie( Cookie c );</span><br><span class="line"><span class="comment">// 将cookie添加到响应中，由服务器负责将cookie信息发送给浏览器，再由浏览器保存到内部（可以多次调用该方法，添加一个以上的cookie）</span></span><br></pre></td></tr></table></figure><p><strong>3、获取请求中的所有cookie对象组成的数组</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cookie[] cs = request.getCookies();</span><br><span class="line"><span class="comment">// 获取请求中携带的所有cookie组成的cookie对象数组，如果请求中没有携带任何cookie，调用该方法会返回null。</span></span><br></pre></td></tr></table></figure><p><strong>4、删除浏览器中的Cookie</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cookie的API中没有提供直接删除cookie的方法，可以通过别的方式间接删除cookie</span></span><br><span class="line"><span class="comment">// 删除名称为cart的cookie：可以向浏览器再发送一个同名的cookie（即名称也叫做cart），并设置cookie的最大生存时间为零，由于浏览器是根据cookie的名字来区分cookie，如果前后两次向浏览器发送同名的cookie，后发送的cookie会覆盖之前发送的cookie。而后发送的cookie设置了生存时间为零，因此浏览器收到后也会立即删除！</span></span><br></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个名称为cart的cookie</span></span><br><span class="line">Cookie c = <span class="keyword">new</span> Cookie(<span class="string">"cart"</span>, <span class="string">""</span>);</span><br><span class="line"><span class="comment">//设置cookie的最大生存时间为零</span></span><br><span class="line">c.setMaxAge( <span class="number">0</span> );</span><br><span class="line"><span class="comment">//将cookie添加到响应中,发送给浏览器</span></span><br><span class="line">response.addCookie( c );</span><br><span class="line">out.write( <span class="string">"成功删除了名称为cart的cookie..."</span> );</span><br></pre></td></tr></table></figure><p><strong>5、Cookie的常用方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cookie.getName(); <span class="comment">// 获取cookie的名字</span></span><br><span class="line">cookie.getValue(); <span class="comment">// 获取cookie中保存的值</span></span><br><span class="line">cookie.setValue(); <span class="comment">// 设置/修改cookie中保存的值(没有setName方法,因为cookie的名字无法修改)</span></span><br><span class="line">cookie.setMaxAge(); <span class="comment">//设置cookie的最大生存时间</span></span><br></pre></td></tr></table></figure><p><strong>6、setMaxAge方法</strong>：设置cookie的最大生存时间</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果不设置该方法，cookie默认是会话级别的cookie，即生存时间是一次会话。当浏览器关闭，会话结束时，cookie也会被销毁（cookie默认存在浏览器的内存中，当浏览器关闭，内存释放，cookie也会随着内存的释放而销毁。）</span><br><span class="line">如果设置了该方法，cookie将不会保存到浏览器的内存中，而是以文件形式保存到浏览器的临时文件夹中（也就是硬盘上），这样再关闭浏览器，内存释放，保存到硬盘上的cookie文件不会销毁，再次打开浏览器，还可以获取硬盘上的cookie信息。</span><br></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建一个Cookie对象，将商品信息保存到cookie中</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie( <span class="string">"cart"</span>, prod  );</span><br><span class="line"><span class="comment">//设置cookie的最大生存时间, 单位:秒</span></span><br><span class="line">cookie.setMaxAge( <span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span> );</span><br><span class="line"><span class="comment">//将cookie对象添加到response响应中</span></span><br><span class="line">response.addCookie( cookie );</span><br></pre></td></tr></table></figure><h3 id="案例-使用cookie模拟购物车"><a href="#案例-使用cookie模拟购物车" class="headerlink" title="案例:使用cookie模拟购物车"></a>案例:使用cookie模拟购物车</h3><p><strong>1.index.html</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>点击下面的商品链接, 可以将商品加入购物车<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">http://localhost/day13-cookie/CartServlet</span></span><br><span class="line"><span class="comment">http://localhost/day13-cookie/index.html</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=iphone11"</span>&gt;</span>iphone11<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=vivonex3"</span>&gt;</span>vivonex3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=xiaomishouji"</span>&gt;</span>xiaomishouji<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=huaweip30"</span>&gt;</span>huaweip30<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=海尔洗衣机"</span>&gt;</span>海尔洗衣机<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>点击下面的支付链接, 可以对购物车中的商品进行结算<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"PayServlet"</span>&gt;</span>支付<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>2.CartServlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line"><span class="comment">//-------------------------------------------------------</span></span><br><span class="line"><span class="comment">//获取请求中携带的商品信息(将要加入购物车的商品信息)</span></span><br><span class="line">String prod = request.getParameter( <span class="string">"prod"</span> );</span><br><span class="line"><span class="comment">//创建一个Cookie对象，将商品信息保存到cookie中</span></span><br><span class="line">Cookie cookie = <span class="keyword">new</span> Cookie( <span class="string">"cart"</span>, prod  );</span><br><span class="line"><span class="comment">//设置cookie的最大生存时间, 单位:秒</span></span><br><span class="line">cookie.setMaxAge( <span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span> );</span><br><span class="line"><span class="comment">//将cookie对象添加到response响应中</span></span><br><span class="line">response.addCookie( cookie );</span><br><span class="line"><span class="comment">//做出回应</span></span><br><span class="line">out.write( <span class="string">"成功将"</span>+prod+<span class="string">"加入了购物车....."</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3.PayServlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">//获取请求中的所有cookie信息(null/cookie数组)</span></span><br><span class="line">Cookie[] cs = request.getCookies();</span><br><span class="line"><span class="comment">//遍历所有cookie数组, 找出名称为cart的cookie</span></span><br><span class="line">String prod = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>( cs != <span class="keyword">null</span> ) &#123;</span><br><span class="line"><span class="keyword">for</span> (Cookie c : cs) &#123;</span><br><span class="line"><span class="keyword">if</span>( <span class="string">"cart"</span>.equals( c.getName() ) ) &#123;</span><br><span class="line"><span class="comment">//获取cookie中保存的商品信息</span></span><br><span class="line">prod = c.getValue();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//为商品进行结算</span></span><br><span class="line"><span class="keyword">if</span>( prod == <span class="keyword">null</span> ) &#123;</span><br><span class="line">out.write( <span class="string">"您还没有将商品加入购物车...."</span> );</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">out.write( <span class="string">"成功为"</span>+prod+<span class="string">"支付了1000.00元...."</span> );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="session原理及应用"><a href="#session原理及应用" class="headerlink" title="session原理及应用"></a>session原理及应用</h2><h3 id="session的工作原理"><a href="#session的工作原理" class="headerlink" title="session的工作原理"></a>session的工作原理</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/9f99b30f96234a6bba48e37d6852a080-b234a7929d994756982e5666e5e6f024.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-91ae106542ca7ab2415d0d4ff29c8170.png" alt="9f99b30f96234a6bba48e37d6852a080"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9f99b30f96234a6bba48e37d6852a080-b234a7929d994756982e5666e5e6f024.png" target="_blank" rel="noopener">9f99b30f96234a6bba48e37d6852a080</a></p><ol><li>Session是将会话中产生的数据保存在服务器端，是服务器端技术</li><li>Session是一个域对象，session中也保存了一个map集合，往session中存数据，其实就是将数据保存到session的map集合中。</li><li>通过session.setAttribute()方法可以将数据保存到session中，通过session.getAttribute()方法可以将数据从session中取出来。</li></ol><h3 id="session是一个域对象"><a href="#session是一个域对象" class="headerlink" title="session是一个域对象"></a>session是一个域对象</h3><p>获取session对象：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">request.getSession() </span><br><span class="line">&#x2F;&#x2F; 获取一个session对象；如果在服务器内部有当前浏览器对应的session，则直接返回该session对象；如果没有对应session，则会创建一个新的session对象再返回；</span><br></pre></td></tr></table></figure><p>Session是一个域对象，因此session中也提供了存取数据的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session.setAttribute(String attrName, Object attrValue); </span><br><span class="line"><span class="comment">// 往session域中添加一个域属性，属性名只能是字符串类型，属性值可以是任意类型。</span></span><br><span class="line">session.getAttribute(String attrName);</span><br><span class="line"><span class="comment">// 根据属性名获取域中的属性值，返回值是一个Object类型</span></span><br></pre></td></tr></table></figure><p>Session域对象的三大特征：</p><p><strong>(1)生命周期：</strong></p><p>**创建session：**第一次调用request.getSession()方法时，会创建一个session对象。（当浏览器在服务器端没有对应的session时，调用request.getSession()方法服务器会创建一个session对象。）</p><p><strong>销毁session：</strong></p><ol><li><p>超时销毁：默认情况下，当超过30分钟没有访问session，session就会超时销毁。（30分钟是默认时间，可以修改，但不推荐修改）</p></li><li><p>自杀：调用session的invalidate方法时，会立即销毁session。</p></li><li><p>意外身亡：当服务器非正常关闭时（硬件损坏，断电，内存溢出等导致服务器非正常关闭），session会随着服务器的关闭而销毁；</p><p>当服务器正常关闭，在关闭之前，服务器会将内部的session对象序列化保存到服务器的work目录下，变为一个文件。这个过程叫做session的钝化（序列化）；再次将服务器启动起来，钝化着的session会再次回到服务器，变为服务器中的对象，这个过程叫做session的活化（反序列化）。</p></li></ol><p>**(2)作用范围：**在一次会话范围内（获取到的都是同一个session对象）</p><p>**(3)主要功能：**在整个会话范围内实现数据的共享</p><h3 id="案例-使用session模拟购物车"><a href="#案例-使用session模拟购物车" class="headerlink" title="案例:使用session模拟购物车"></a>案例:使用session模拟购物车</h3><p><strong>1、index.html</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>点击下面的商品链接, 可以将商品加入购物车<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">http://localhost/day13-cookie/CartServlet</span></span><br><span class="line"><span class="comment">http://localhost/day13-cookie/index.html</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=iphone11"</span>&gt;</span>iphone11<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=vivonex3"</span>&gt;</span>vivonex3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=xiaomishouji"</span>&gt;</span>xiaomishouji<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=huaweip30"</span>&gt;</span>huaweip30<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"CartServlet?prod=海尔洗衣机"</span>&gt;</span>海尔洗衣机<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>点击下面的支付链接, 可以对购物车中的商品进行结算<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"PayServlet"</span>&gt;</span>支付<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、CartServlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">//获取将要添加到购物车的商品信息</span></span><br><span class="line">String prod = request.getParameter( <span class="string">"prod"</span> );</span><br><span class="line"><span class="comment">//获取一个session对象，将商品信息保存到session中</span></span><br><span class="line">HttpSession session = request.getSession();</span><br><span class="line"><span class="comment">//设置session的超时时间为30秒</span></span><br><span class="line"><span class="comment">//session.setMaxInactiveInterval( 30 );</span></span><br><span class="line">session.setAttribute( <span class="string">"cart"</span> , prod );</span><br><span class="line"><span class="comment">//做出响应</span></span><br><span class="line">out.write( <span class="string">"成功将 [ "</span>+prod+<span class="string">" ] 加入了购物车~~~"</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3、PayServlet</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line"><span class="comment">//获取一个session对象(之前的session)</span></span><br><span class="line">HttpSession session = request.getSession();</span><br><span class="line"><span class="comment">//从session中获取到要结算的商品信息</span></span><br><span class="line">String prod = (String)session.getAttribute( <span class="string">"cart"</span> );</span><br><span class="line"><span class="comment">//对商品进行结算,做出回应</span></span><br><span class="line">out.write( <span class="string">"成功为 [ "</span>+prod+<span class="string">" ] 支付了2000.00元~~~~"</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="总结-两者的区别"><a href="#总结-两者的区别" class="headerlink" title="总结:两者的区别"></a>总结:两者的区别</h2><p>Cookie和session都属于会话技术，都可以保存会话中产生的数据，但由于cookie和session的工作原理和特点不同，因此两者的应用场景也不一样。</p><p><strong>Cookie的特点：</strong></p><ol><li><p>cookie是将会话中产生的数据保存在<strong>浏览器客户端</strong>, 是客户端技术（JS可以访问cookie）</p></li><li><p>cookie是将数据保存在客户端浏览器，容易随着用户的操作导致cookie丢失或者被窃取，因此cookie中保存的数据不太稳定，也不太安全。</p></li><li><p>但cookie将数据保存在客户端，对服务器端没有太多影响，可以将数据保存很长时间。</p></li><li><p>总结：因此cookie中适合存储需要长时间保存、但对安全性要求不高的数据。</p></li><li><p>浏览器对cookie的大小和个数都有限制，一般推荐每一个站点给浏览器发送的cookie数量不超过20个，每一个cookie的大小不超过1kb。</p></li><li><p>Cookie的应用：实现购物车、记住用户名、30天内自动登录等。</p></li></ol><p><strong>Session的特点</strong></p><ol><li>session是将会话中产生的数据保存在<strong>服务器端</strong>，是服务器端技术</li><li>session将数据存在服务器端的session对象中，相对更加的安全，而且更加稳定。不容易随着用户的操作而导致session中的数据丢失或者是被窃取。</li><li>但session是服务器端的对象，在并发量较高时每一个浏览器客户端在服务器端都要对应一个session对象，占用服务器的内存空间，影响效率。</li><li>总结：因此session中适合存储对安全性要求较高，但不需要长时间保存的数据。</li><li>Session的应用：保存登录状态、保存验证码</li></ol><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><h3 id="cookie中保存中文数据的问题"><a href="#cookie中保存中文数据的问题" class="headerlink" title="cookie中保存中文数据的问题"></a>cookie中保存中文数据的问题</h3><p>以下问题是针对Tomcat8.0及8.0以下的版本，在Tomcat8.5及8.5以后的版本中已经解决了该问题！</p><p>HTTP协议中规定了请求信息和响应信息中不能包含中文数据！</p><p>因此通过浏览器向服务器发送中文数据时，浏览器会将中文数据进行URL编码，编码为下面这种格式：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174146534-6e81b49c09de4cdb8e1872b76f371de7.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-fefe39822b462ca2114777cc519adfd6.png" alt="image-20200225174146534"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174146534-6e81b49c09de4cdb8e1872b76f371de7.png" target="_blank" rel="noopener">image-20200225174146534</a></p><p><a href="http://localhost/day13-cookie/index.html?user=%E5%BC%A0%E9%A3%9E%E9%A3%9E" target="_blank" rel="noopener">http://localhost/day13-cookie/index.html?user=%E5%BC%A0%E9%A3%9E%E9%A3%9E</a></p><p>将中文数据转成下面这种格式，叫做URL编码：</p><p><code>张飞飞 ---&gt; URL编码 ---&gt; %E5%BC%A0%E9%A3%9E%E9%A3%9E</code></p><p>将下面这种格式再次转回中文数据，叫做URL解码：</p><p><code>%E5%BC%A0%E9%A3%9E%E9%A3%9E ---&gt; URL解码---&gt; 张飞飞</code></p><p><strong>问题：当cookie中保存中文数据，将cookie添加到响应中时，会报一个500异常，如下：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200226095315873-3244b23abc9e45c280b699b611179ebc.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-696fad617eae9ffa282ebe302276723b.png" alt="image-20200226095315873"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200226095315873-3244b23abc9e45c280b699b611179ebc.png" target="_blank" rel="noopener">image-20200226095315873</a></p><p><strong>解决方法是：</strong></p><p>将存入cookie中的先进行URL编码，再存入Cookie中，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174242538-088ffe972caf4613b870f445acf24966.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-e6a4d1af555386008d2916d3406ae319.png" alt="image-20200225174242538"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174242538-088ffe972caf4613b870f445acf24966.png" target="_blank" rel="noopener">image-20200225174242538</a></p><p>从cookie取出来的数据是进行URL编码后的数据，在使用之前需要进行URL解码，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174252978-7a75a78273364f9ab679186725d5f6c9.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-0d4eef6ff91ee69b34c124f17a250943.png" alt="image-20200225174252978"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225174252978-7a75a78273364f9ab679186725d5f6c9.png" target="_blank" rel="noopener">image-20200225174252978</a></p><h3 id="获取不到之前的session的问题"><a href="#获取不到之前的session的问题" class="headerlink" title="获取不到之前的session的问题"></a>获取不到之前的session的问题</h3><p>将商品保存到session中后，关闭浏览器再打开浏览器，访问服务器，此时获取不到之前的session。因为session是基于Cookie工作的。</p><p>在服务器创建一个session后，会为session分配一个独一无二的编号，称之为session的id，在此次响应时，服务器会将session的id以一个名称为JSESSIONID的cookie发送给浏览器保存到浏览器内部。</p><p>由于保存sessionid的cookie默认是会话级别的cookie，在浏览器关闭后，cookie会跟着销毁，sessionid也丢失了。因此下次访问服务器，没有session的id就获取不到之前的session。也获取不到session中的商品信息</p><p>解决方法：我们可以创建一个名称为JSESSIONID的cookie，其中保存session的ID，并设置cookie的最大存活时间，让cookie保存到硬盘上（即使浏览器关闭，cookie也不会销毁），这样下次访问服务器时，还可以将sessionid带给服务器，服务器可以通过sessionid获取到之前的session。 从session中获取到商品信息</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9e195f495be5cc6e805c1185fcc753ad-87aaa34fd641452a91d817ffb20d14c1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871092-4d210210457690bcb716d34a0e39054b.png" alt="9e195f495be5cc6e805c1185fcc753ad"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9e195f495be5cc6e805c1185fcc753ad-87aaa34fd641452a91d817ffb20d14c1.png" target="_blank" rel="noopener">9e195f495be5cc6e805c1185fcc753ad</a></p><h1 id="javaweb-cookie-session"><a href="#javaweb-cookie-session" class="headerlink" title="javaweb   cookie   session"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/cookie" target="_blank" rel="noopener">cookie</a>   <a href="https://www.zhangpeng.fun/tags/session" target="_blank" rel="noopener">session</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="cookie" scheme="https://zpengit.github.io/tags/cookie/"/>
    
      <category term="session" scheme="https://zpengit.github.io/tags/session/"/>
    
  </entry>
  
  <entry>
    <title>09-Maven</title>
    <link href="https://zpengit.github.io/2020/06/11/09-Maven/"/>
    <id>https://zpengit.github.io/2020/06/11/09-Maven/</id>
    <published>2020-06-11T10:52:44.425Z</published>
    <updated>2020-06-11T10:45:29.534Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="09-Maven"><a href="#09-Maven" class="headerlink" title="09-Maven"></a>09-Maven</h1><h1 id="unit09-Maven"><a href="#unit09-Maven" class="headerlink" title="unit09-Maven"></a>unit09-Maven</h1><p><strong>今日学习目标：</strong></p><ol><li><p>了解什么是Maven及Maven的作用</p></li><li><p>掌握Maven安装及整合到Eclipse中</p></li><li><p>掌握如何使用Maven构建Java项目和Web项目</p></li><li><p>掌握使用Eclipse导入现有的Maven项目</p></li><li><p>了解Maven的三种仓库(本地仓库、镜像仓库（私服）、中央仓库（公服）)</p></li><li><p>了解Maven如何管理依赖（即管理jar包）</p></li></ol><h2 id="Maven介绍"><a href="#Maven介绍" class="headerlink" title="Maven介绍"></a>Maven介绍</h2><h3 id="Maven是什么"><a href="#Maven是什么" class="headerlink" title="Maven是什么?"></a>Maven是什么?</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/29cb6062127316fbe9e659ec05108844-a40e0f33c0044de08c17829c522ed8a1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-0cf5901e09e78fa93721884e7130d93e.png" alt="29cb6062127316fbe9e659ec05108844"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/29cb6062127316fbe9e659ec05108844-a40e0f33c0044de08c17829c522ed8a1.png" target="_blank" rel="noopener">29cb6062127316fbe9e659ec05108844</a></p><p><strong>Maven</strong>: 翻译为”专家”、”内行”，是<strong>Apache</strong>下的一个纯Java开发的一个开源项目。</p><p><strong>Maven</strong>是一个项目管理工具，使用Maven可以来管理企业级的Java项目开发及依赖的管理。</p><p>使用<strong>Maven</strong>开发，可以简化项目配置，统一项目结构。总之，Maven可以让开发者的工作变得更简单。</p><hr><p>什么是依赖管理？要明白依赖管理，首先要知道什么是依赖？</p><p>一个Java项目中往往会依赖一些第三方的jar包。比如JDBC程序中要依赖数据库驱动包，或者在使用c3p0连接池时，要依赖c3p0的jar包等。这时我们称这些Java项目依赖第三方jar包。</p><p>而所谓的依赖管理，其实就是对项目中所有依赖的jar包进行规范化管理。</p><h3 id="为什么要使用Maven"><a href="#为什么要使用Maven" class="headerlink" title="为什么要使用Maven?"></a>为什么要使用Maven?</h3><p>传统的项目（工程）中管理项目所依赖的jar包完全靠人工进行管理，而人工管理jar包可能会产生诸多问题。</p><p><strong>1、不使用Maven，采用传统方式管理jar包的弊端：</strong></p><p>(1)在一些大型项目中会使用一些框架，比如SSM或者SSH框架，而框架中所包含的jar包非常多（甚至还依赖其他第三方的jar包），如果这些jar包我们手动去网上寻找，有些jar包不容易找到，比较麻烦。</p><p>(2)传统方式会将jar包添加到工程中，比如Java工程中将jar包放在工程根目录或者放在自建的lib目录下；JavaWeb工程会将jar包放在:/WEB-INF/lib目录下，这样会导致项目文件的体积暴增（例如，有些项目代码本身体积可能仅仅几兆，而加入jar包后，工程的体积可能会达到几十兆甚至百兆）。</p><p>(3)在传统的Java项目中是将所有的jar包统一拷贝的同一目录中，可能会存在jar包文件名称冲突的问题！</p><p>(4)在进行项目整合时，可能会出现jar包版本冲突的问题。</p><p>(5)在传统java项目中通过编译（手动编译或者在eclipse保存自动编译）、测试（手动在main函数中测试、junit单元测试）、打包部署(手动打war包/手动发布)、运行(手动启动tomcat运行)，最终访问程序。</p><p><strong>2、使用Maven来管理jar包的优势：</strong></p><p>(1)Maven团队维护了一个非常全的Maven仓库(中央仓库)，其中几乎包含了所有的jar包，使用Maven创建的工程可以自动到Maven仓库中下载jar包，方便且不易出错。</p><p>另外，在Maven构建的项目中，如果要使用到一些框架，我们只需要引入框架的核心jar包，框架所依赖的其他第三方jar包，Maven也会一并去下载。</p><p>(2)在Maven构建的项目中，不会将项目所依赖的jar包拷贝到每一个项目中，而是将jar包统一放在仓库中管理，在项目中只需要引入jar包的位置(坐标)即可。这样实现了jar包的复用。</p><p>(3)Maven采用坐标来管理仓库中的jar包，其中的目录结构为【公司名称+项目/产品名称+版本号】，可以根据坐标定位到具体的jar包。即使使用不同公司中同名的jar包，坐标不同（目录结构不同），文件名也不会冲突。</p><p>(4)Maven构建的项目中，通过pom文件对项目中所依赖的jar包及版本进行统一管理，可避免版本冲突。</p><p>(5)在Maven项目中，通过一个命令或者一键就可以实现项目的编译（mvn complie）、测试（mvn test）、打包部署（mvn deploy）、运行（mvn install）等。</p><p>还有发布到tomcat服务器中运行: mvn tomcat7:run。如果想实现上面的所有过程，只需要记住一个命令：mvn install</p><p>总之，使用Maven遵循规范开发有利于提高大型团队的开发效率，降低项目的维护成本，大公司都会优先使用Maven来构建项目.</p><h2 id="Maven安装"><a href="#Maven安装" class="headerlink" title="Maven安装"></a>Maven安装</h2><h3 id="下载、安装Maven"><a href="#下载、安装Maven" class="headerlink" title="下载、安装Maven"></a>下载、安装Maven</h3><p>1、官方下载地址：<a href="http://maven.apache.org/download.cgi" target="_blank" rel="noopener">http://maven.apache.org/download.cgi</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/53a1d2f3f17b247cd6d1690974484a38-5c9d0214239a4bbf99170ceadc3c04cc.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-a0ddfab7071d976f349667c83333cd7f.png" alt="53a1d2f3f17b247cd6d1690974484a38"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/53a1d2f3f17b247cd6d1690974484a38-5c9d0214239a4bbf99170ceadc3c04cc.png" target="_blank" rel="noopener">53a1d2f3f17b247cd6d1690974484a38</a></p><p>2、下载绿色版，解压之后就可以使用。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f053c9311f77b5a8d9f905fa3859e2c7-94a151d76a87436ca00b3b5fd9d3ea9c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-8ccc96d7fcc04df81e77c4dd72488be2.png" alt="f053c9311f77b5a8d9f905fa3859e2c7"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f053c9311f77b5a8d9f905fa3859e2c7-94a151d76a87436ca00b3b5fd9d3ea9c.png" target="_blank" rel="noopener">f053c9311f77b5a8d9f905fa3859e2c7</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9ab44a6351a1fd7320ae28eea7a0fa6b-a44fad125df54e6f9aa59d4904b9a698.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-17f2df2fcfa4a9d8c02e1e8fd631fd90.png" alt="9ab44a6351a1fd7320ae28eea7a0fa6b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9ab44a6351a1fd7320ae28eea7a0fa6b-a44fad125df54e6f9aa59d4904b9a698.png" target="_blank" rel="noopener">9ab44a6351a1fd7320ae28eea7a0fa6b</a></p><p>原则: 安装的路径中不要有中文和空格!!</p><p>3、若要下载旧版本Maven，可以访问：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;archive.apache.org&#x2F;dist&#x2F;maven&#x2F;maven-3&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/2125c89c33f029357b460c5f98edaed5-7412dd085cf84b1aa917d1392a1ae1df.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-6ff77b852ffd04bda6070a6e9ee08439.png" alt="2125c89c33f029357b460c5f98edaed5"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/2125c89c33f029357b460c5f98edaed5-7412dd085cf84b1aa917d1392a1ae1df.png" target="_blank" rel="noopener">2125c89c33f029357b460c5f98edaed5</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4465c83cfebe53f76a6e25e5e919402d-e0f2c796e86b4d3d92434bbfa23e9ad4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-01045fd6f421e54d6ade64d42d7f6878.png" alt="4465c83cfebe53f76a6e25e5e919402d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4465c83cfebe53f76a6e25e5e919402d-e0f2c796e86b4d3d92434bbfa23e9ad4.png" target="_blank" rel="noopener">4465c83cfebe53f76a6e25e5e919402d</a></p><h2 id="Maven的相关配置"><a href="#Maven的相关配置" class="headerlink" title="Maven的相关配置"></a>Maven的相关配置</h2><p>在开发中更多是通过Eclipse+Maven来构建Maven项目，所以这里我们需要将Maven配置到Eclipse开发工具中。</p><p>在将安装好的Maven工具配置的Eclipse开发工具中之前，需要做一些相关的配置。</p><h3 id="配置本地仓库位置"><a href="#配置本地仓库位置" class="headerlink" title="配置本地仓库位置"></a>配置本地仓库位置</h3><p>本地仓库：其实就是本地硬盘上的某一目录，该目录中会包含maven项目中所需要的所有jar包及插件。当所需jar包在本地仓库没有时，从网络上下载下来的jar包也会存放在本地仓库中。</p><p>因此本地仓库其实就是一个存放jar包的目录，我们可以指定Maven仓库的位置。</p><p>如果不指定，maven本地仓库的默认位置是在c盘，在：</p><p><code>C:/Users/{当前用户}/.m2/repository</code>，例如:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d9d738475e447449e535cf7e6a735be8-4babfa99630d4b8d89d540374d58bfb7.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-d869c0a8436959e3b5de8221d69db123.png" alt="d9d738475e447449e535cf7e6a735be8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d9d738475e447449e535cf7e6a735be8-4babfa99630d4b8d89d540374d58bfb7.png" target="_blank" rel="noopener">d9d738475e447449e535cf7e6a735be8</a></p><p>可以保持默认，当然也可以修改本地仓库的位置到别的盘符路径。</p><p>修改方法：找到[MAVEN_HOME]/conf/目录中的配置文件settings.xml，修改maven仓库的路径。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401104914602-8ba45ccb3b3c445bbd89edcd91f15af1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-39278864c09d0c9f55a07d159958622a.png" alt="image-20200401104914602"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401104914602-8ba45ccb3b3c445bbd89edcd91f15af1.png" target="_blank" rel="noopener">image-20200401104914602</a></p><p>配置该目录后，以后通过maven下载的jar包将会保存在配置的目录下。</p><p><strong>以上内容可以总结为：</strong></p><ol><li>什么是本地仓库？</li><li>本地仓库的默认位置在哪儿？</li><li>配置和不配置本地仓库有什么区别？</li></ol><h3 id="配置镜像仓库-私服"><a href="#配置镜像仓库-私服" class="headerlink" title="配置镜像仓库(私服)"></a>配置镜像仓库(私服)</h3><p>当maven项目中需要依赖jar包时，如果本地仓库中没有，就会到远程仓库去下载jar包。</p><p>如果不配置镜像仓库，默认连接的是中央仓库，由于中央仓库面向的是全球用户，所以在下载jar包时，速度可能会比较慢，效率会比较低。</p><p>可以在settings.xml文件中配置连接达内镜像仓库（前提是在达内教室，连接的是达内内网）或者连接阿里云镜像仓库（需要有外网）。</p><p>1、如果连接的是达内内网，可以连接达内镜像仓库（如果不配置，默认连接中央仓库，没有外网，连接不了中央仓库，会导致jar包无法下载）。</p><p>需要做的是，在settings.xml文件中的<code>&lt;settings&gt;</code>标签下的<code>&lt;mirrors&gt;</code>标签内部添加如下配置，配置达内镜像仓库：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-tedu<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus tedu<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.tedu.cn/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2、如果在家里、在公司连接的是外网，是无法连接达内的镜像仓库，可以选择什么都不配置，默认连接中央仓库，或者可以配置连接阿里云镜像仓库（不要使用手机热点网络连接），配置如下：</p><p>配置阿里云镜像仓库：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>nexus-aliyun<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>Nexus aliyun<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>镜像仓库配置总结：</strong></p><ol><li><p>当所需jar包在本地仓库没有时，会从网络上下载。配置镜像仓库其实就是配置，去网络中哪个位置下载jar包到本地。</p></li><li><p>如果在公司，并且公司有搭建镜像服务器，推荐使用公司的镜像服务器下载jar包，速度会更快。（如果在达内，使用的是内网，只能配置达内的镜像仓库。否则，没有外网也连接不了中央仓库，下载jar包会失败！）</p></li><li><p>如果在家里，使用的是外网，可以不配置镜像仓库，默认连接中央仓库下载jar包，或者配置阿里云的镜像仓库。连接阿里云服务器下载jar包。（注意，如果配置阿里云镜像服务器，<strong>不可使用手机热点网络！</strong>）</p></li></ol><h3 id="配置JDK版本"><a href="#配置JDK版本" class="headerlink" title="配置JDK版本"></a>配置JDK版本</h3><p>通过 Maven创建的工程，JDK版本默认是JDK1.5，每次都需要手动改为更高的版本。</p><p>这里可以通过修改maven的settings.xml文件, 达到一劳永逸的效果。</p><p>配置方式为：打开 <code>{maven根目录}/conf/settings.xml</code> 文件并编辑，在 settings.xml文件内部的 <code>&lt;profiles&gt;</code> 标签内部添加如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>development<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="将Maven配置到Eclipse中"><a href="#将Maven配置到Eclipse中" class="headerlink" title="将Maven配置到Eclipse中"></a>将Maven配置到Eclipse中</h3><p>将Maven工具配置到Eclipse中，就可以通过Eclipse和自己安装的Maven创建Maven项目了。</p><p><strong>1、window右键–&gt; Preferences：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/95e8c0d77e32611aa01c83fdfe9115bc-93081ff6f64549acbb6e58d0b525ada5.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-2520c862241a77b6670ac59e83d54c70.png" alt="95e8c0d77e32611aa01c83fdfe9115bc"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/95e8c0d77e32611aa01c83fdfe9115bc-93081ff6f64549acbb6e58d0b525ada5.png" target="_blank" rel="noopener">95e8c0d77e32611aa01c83fdfe9115bc</a></p><p><strong>2、点击Maven选项，在右侧选项中勾选 “Download Artifact Sources”：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b8de69f1e0238506740120c3ac2761b2-a6c4f889a71c4875b0226c52e0228c12.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-dfcecf6591b7644c5c1c76ce8f1a24a9.png" alt="b8de69f1e0238506740120c3ac2761b2"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b8de69f1e0238506740120c3ac2761b2-a6c4f889a71c4875b0226c52e0228c12.png" target="_blank" rel="noopener">b8de69f1e0238506740120c3ac2761b2</a></p><p><strong>3、点击add将自己安装的Maven添加进来：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c75f99240250846b1009f595627fd48b-431f07b4b757482eb2175f3058a00298.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-6e4c6eaf49cb4f0af0e6830c378bc436.png" alt="c75f99240250846b1009f595627fd48b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c75f99240250846b1009f595627fd48b-431f07b4b757482eb2175f3058a00298.png" target="_blank" rel="noopener">c75f99240250846b1009f595627fd48b</a></p><p><strong>4、添加自己安装的Maven：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1e470e51fcaec075f1d1e3475978325f-46b9da9295404ba7932746ef4aa7c033.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-19085d606d7704c325d4de6eaa9c76ca.png" alt="1e470e51fcaec075f1d1e3475978325f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1e470e51fcaec075f1d1e3475978325f-46b9da9295404ba7932746ef4aa7c033.png" target="_blank" rel="noopener">1e470e51fcaec075f1d1e3475978325f</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/90ca91b942da7c2a58b6e38d234200c3-f05311174d2845c28268a2851ab27485.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-d2598f2c80c774d15d47385e4460847b.png" alt="90ca91b942da7c2a58b6e38d234200c3"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/90ca91b942da7c2a58b6e38d234200c3-f05311174d2845c28268a2851ab27485.png" target="_blank" rel="noopener">90ca91b942da7c2a58b6e38d234200c3</a></p><p>**一定要注意:**自己安装的Maven不要放在桌面上(容易丢失，并且路径中往往有空格)，maven的安装路径中也不要包含中文和空格!!</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/88bd59974c2d8f430ffab34336bb9f33-e44a9ae1768a4a7d976fe0e5fc04d71c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-c662baabe97a6a0900db38c4d5169f49.png" alt="88bd59974c2d8f430ffab34336bb9f33"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/88bd59974c2d8f430ffab34336bb9f33-e44a9ae1768a4a7d976fe0e5fc04d71c.png" target="_blank" rel="noopener">88bd59974c2d8f430ffab34336bb9f33</a></p><p><strong>5、将默认的maven切换为自己配置的maven：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3c3426a658642a9ca1c41e67e790f006-10442b44ec51472eb1e593d6477083b2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-3ae67ae79f64e6ad9f532cdb4164ea73.png" alt="3c3426a658642a9ca1c41e67e790f006"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3c3426a658642a9ca1c41e67e790f006-10442b44ec51472eb1e593d6477083b2.png" target="_blank" rel="noopener">3c3426a658642a9ca1c41e67e790f006</a></p><p><strong>6、设置maven的settings文件的位置：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3290041ab768b3e7a6ee02ffd40f8c9e-9cd5955d746841a7860a2074562c30c2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-ce04e5fffb86801dd778ad448697c96b.png" alt="3290041ab768b3e7a6ee02ffd40f8c9e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3290041ab768b3e7a6ee02ffd40f8c9e-9cd5955d746841a7860a2074562c30c2.png" target="_blank" rel="noopener">3290041ab768b3e7a6ee02ffd40f8c9e</a></p><p>**7、测试是否配置成功：**window—&gt; show view —&gt; other中搜索”maven”，点击下面的选框中的选项</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/facabede667d2edbead383cd5d725a75-179e39e49b724dbfb3edaa9ff3ba8f85.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-486c4371977b080ffcb904c28379ca17.png" alt="facabede667d2edbead383cd5d725a75"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/facabede667d2edbead383cd5d725a75-179e39e49b724dbfb3edaa9ff3ba8f85.png" target="_blank" rel="noopener">facabede667d2edbead383cd5d725a75</a></p><p>在弹出的窗口中，查看自己配置的本地仓库和远程仓库镜像:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e5fbbd21f05c86804f0656638784cba8-8b5758679c584a52884fee2ad044ee30.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-25633f3319349d160cc5e72a9c5b9bdf.png" alt="e5fbbd21f05c86804f0656638784cba8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e5fbbd21f05c86804f0656638784cba8-8b5758679c584a52884fee2ad044ee30.png" target="_blank" rel="noopener">e5fbbd21f05c86804f0656638784cba8</a></p><h2 id="Maven的项目构建"><a href="#Maven的项目构建" class="headerlink" title="Maven的项目构建"></a>Maven的项目构建</h2><p>通过Maven构建Java项目分为两种方式：</p><p>（1）创建Maven的简单Java工程以及创建Maven的简单Web工程</p><p>（2）创建使用模板的Java工程以及创建使用模板的Web工程</p><p>在利用Maven构建项目时分两种，第一种是：创建简单工程**（Create a simple<br>project）**，即在创建时勾选前面的框。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/8888dd2dcf76aff253b16f4559f6df39-dd7e0f6145474ee08bf63e5065508bbb.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-dfc1ec5c375816415e4286d0f4eaecf8.png" alt="8888dd2dcf76aff253b16f4559f6df39"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/8888dd2dcf76aff253b16f4559f6df39-dd7e0f6145474ee08bf63e5065508bbb.png" target="_blank" rel="noopener">8888dd2dcf76aff253b16f4559f6df39</a></p><p><em>(不勾选前面的框，即创建使用骨架（其实就是模版）创建Maven工程)</em></p><p>另，在创建简单工程时，还分为创建<strong>Java工程</strong>和<strong>JavaWeb工程</strong>。下面分别进行演示。</p><h3 id="创建简单工程—Java工程"><a href="#创建简单工程—Java工程" class="headerlink" title="创建简单工程—Java工程"></a>创建简单工程—Java工程</h3><p><strong>1、空白处右键New —&gt; Maven Project：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a21856795d5e9f4c4f63603c68711cbb-2e6f5b629c21409baccf79d92a5f7f28.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-2f66f7a8c2013096ce70db52b95c3dc5.png" alt="a21856795d5e9f4c4f63603c68711cbb"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a21856795d5e9f4c4f63603c68711cbb-2e6f5b629c21409baccf79d92a5f7f28.png" target="_blank" rel="noopener">a21856795d5e9f4c4f63603c68711cbb</a></p><p><strong>2、在弹出的窗口中，勾选前面的框，创建一个简单工程（即不使用骨架），进入下一步。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d8b1436aea89ddf1c2ee001333a9f56c-da18923d1e75493eafb2148d366edce1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-7656297f729a37c5b179b801c4f8b3e0.png" alt="d8b1436aea89ddf1c2ee001333a9f56c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d8b1436aea89ddf1c2ee001333a9f56c-da18923d1e75493eafb2148d366edce1.png" target="_blank" rel="noopener">d8b1436aea89ddf1c2ee001333a9f56c</a></p><p><strong>3、在弹出的窗口中，填写内容(Package选择jar，即创建java工程)，点击完成即可。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eb0b7c41231cc90448d85150fd76ce95-eab6be9f380948a18c8ab1e5d5fbf7d0.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-8c5a34cc19b58520d0d9714129c44e1d.png" alt="eb0b7c41231cc90448d85150fd76ce95"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eb0b7c41231cc90448d85150fd76ce95-eab6be9f380948a18c8ab1e5d5fbf7d0.png" target="_blank" rel="noopener">eb0b7c41231cc90448d85150fd76ce95</a></p><p><strong>在上述内容中，必填的内容有四项：</strong></p><p>(1)<strong>Group Id</strong> – 组的名称，通常填写公司名称（比如com.tedu）或者组织名称(org.apache..)</p><p>(2)<strong>Artifact Id</strong> – 项目名称或者模块名称</p><p>(3)<strong>Version</strong> – 项目的版本，创建的项目默认是0.0.1-SNAPSHOT快照，也叫非正式版，正式版是RELEASE)</p><p>(4)<strong>Package</strong> – 项目的类型：jar表示创建的是Java工程，war表示创建的是web工程，pom表示创建的是父工程（当然相对的还有子工程）或者聚合工程，pom目前我们不讨论。</p><p>填写完毕后，点击完成即可完成创建简单Java工程</p><p><strong>4、切换工程视图为包视图：window –&gt; show view，在弹出的窗口中搜索：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0578e41f1fad77ea0ed8509afd2d11d9-ab60d6950c1c437d8e7276b02acc0bd0.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-93ba6df6d2a54e3b4a1aa3e66e172cb4.png" alt="0578e41f1fad77ea0ed8509afd2d11d9"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0578e41f1fad77ea0ed8509afd2d11d9-ab60d6950c1c437d8e7276b02acc0bd0.png" target="_blank" rel="noopener">0578e41f1fad77ea0ed8509afd2d11d9</a></p><h3 id="创建简单工程—Web工程"><a href="#创建简单工程—Web工程" class="headerlink" title="创建简单工程—Web工程"></a>创建简单工程—Web工程</h3><p><strong>1、空白处右键New —&gt; Maven Project：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a21856795d5e9f4c4f63603c68711cbb-2e6f5b629c21409baccf79d92a5f7f28.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-2f66f7a8c2013096ce70db52b95c3dc5.png" alt="a21856795d5e9f4c4f63603c68711cbb"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a21856795d5e9f4c4f63603c68711cbb-2e6f5b629c21409baccf79d92a5f7f28.png" target="_blank" rel="noopener">a21856795d5e9f4c4f63603c68711cbb</a></p><p><strong>2、在弹出的窗口中，勾选前面的框，创建一个简单工程（即不使用骨架），进入下一步。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d8b1436aea89ddf1c2ee001333a9f56c-da18923d1e75493eafb2148d366edce1.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-7656297f729a37c5b179b801c4f8b3e0.png" alt="d8b1436aea89ddf1c2ee001333a9f56c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d8b1436aea89ddf1c2ee001333a9f56c-da18923d1e75493eafb2148d366edce1.png" target="_blank" rel="noopener">d8b1436aea89ddf1c2ee001333a9f56c</a></p><p><strong>3、在弹出的窗口中，填写内容(Package选择war，即创建web工程)，点击完成即可。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e6f4239c8e4caba3a12fd2852be782bc-3e6987fb1c4242d8bb8071943e478493.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-2aa1de73713ec3fee6448ef73ed3935d.png" alt="e6f4239c8e4caba3a12fd2852be782bc"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e6f4239c8e4caba3a12fd2852be782bc-3e6987fb1c4242d8bb8071943e478493.png" target="_blank" rel="noopener">e6f4239c8e4caba3a12fd2852be782bc</a></p><p><strong>4、创建完成后pom.xml文件会报错，说找不到web.xml文件，例如：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ce00e7568eb6f3632ae14f0053e87451-8ac8d797eed74ea492c322442a047fbe.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-c029cbe69318d7861b049ba125f65fa7.png" alt="ce00e7568eb6f3632ae14f0053e87451"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ce00e7568eb6f3632ae14f0053e87451-8ac8d797eed74ea492c322442a047fbe.png" target="_blank" rel="noopener">ce00e7568eb6f3632ae14f0053e87451</a></p><p><strong>手动添加(拷贝)即可，例如:</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9714b18c4003841a3bbf23062539f491-564aa85cb6924dc790db588226cde5da.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-36dc7380baa9a6eb985cc347264a5a42.png" alt="9714b18c4003841a3bbf23062539f491"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9714b18c4003841a3bbf23062539f491-564aa85cb6924dc790db588226cde5da.png" target="_blank" rel="noopener">9714b18c4003841a3bbf23062539f491</a></p><p><strong>5、创建Servlet程序，测试运行环境。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0185f08055d050b93aa6ed68f920bff8-35f3511003464eed8612447eab9198de.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-e4b0d34843f686988d23b91f3eebce90.png" alt="0185f08055d050b93aa6ed68f920bff8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0185f08055d050b93aa6ed68f920bff8-35f3511003464eed8612447eab9198de.png" target="_blank" rel="noopener">0185f08055d050b93aa6ed68f920bff8</a></p><p>上面的错误是因为运行环境中缺少Servlet的jar包，将tomcat运行环境添加过来即可！</p><p><strong>!!缺少Servlet运行环境解决方案：</strong></p><p>在项目上点击鼠标右键，选择 “Properties” —&gt; “Targeted Runtimes”:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e321e3569a1e0dc2d6a7ddc2d953204f-3ab656f0c30e4d96916e5228bfb35a64.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-3a10cb8d0fa8d8f69cac3f40450e1f3d.png" alt="e321e3569a1e0dc2d6a7ddc2d953204f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e321e3569a1e0dc2d6a7ddc2d953204f-3ab656f0c30e4d96916e5228bfb35a64.png" target="_blank" rel="noopener">e321e3569a1e0dc2d6a7ddc2d953204f</a></p><p>或者，在项目中的pom.xml文件中的根标签下添加Servlet的jar包的坐标，引入Servlet的jar包，如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>添加后保存pom文件。若还报错，在项目上右键选择 <strong>“Maven”</strong> —&gt; <strong>“UpdateProject…”</strong> 更新工程即可！</p><p><strong>6、实现Servlet程序</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1bcc65d4c935093c915409cb865902bf-269960174cc347939101a6092652cc57.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-0d838ec80f1c713ae07dd5eda31ba93c.png" alt="1bcc65d4c935093c915409cb865902bf"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1bcc65d4c935093c915409cb865902bf-269960174cc347939101a6092652cc57.png" target="_blank" rel="noopener">1bcc65d4c935093c915409cb865902bf</a></p><p>**7、测试访问：**打开浏览器访问地址：<a href="http://localhost:8080/MavenSimpleProJavaweb/HelloServlet" target="_blank" rel="noopener">http://localhost/MavenSimpleProJavaweb/HelloServlet</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7c9682115d7e105ccc587d511be921e1-cc6a016612d3447886f4d2090d043f22.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-18941b6d77b85e3a173855208e54c990.png" alt="7c9682115d7e105ccc587d511be921e1"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7c9682115d7e105ccc587d511be921e1-cc6a016612d3447886f4d2090d043f22.png" target="_blank" rel="noopener">7c9682115d7e105ccc587d511be921e1</a></p><h3 id="Maven的目录结构"><a href="#Maven的目录结构" class="headerlink" title="Maven的目录结构"></a>Maven的目录结构</h3><p>使用Maven创建的工程我们称它为Maven工程，Maven工程具有一定的目录规范，对目录结构有严格的要求，一个Maven工程要具有如下目录结构：</p><p><a href="https://www.zhangpeng.fun/archives/JAVAWEB-NOTE03.assets/image-20200225092639227.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-1ce6b092f5467447a651af4adb76228d.png" alt="image-20200225092639227"></a></p><p><a href="https://www.zhangpeng.fun/archives/JAVAWEB-NOTE03.assets/image-20200225092639227.png" target="_blank" rel="noopener">image-20200225092639227</a></p><p>下面以Maven的Web项目为例，介绍Maven项目中的目录结构：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Maven项目名称(Web项目)</span><br><span class="line">  |-- src&#x2F;main&#x2F;java(源码目录)：用于存放程序&#x2F;项目所需要的java源码文件</span><br><span class="line">  |-- src&#x2F;main&#x2F;resources(源码目录)：用于存放程序&#x2F;项目所需要的配置文件</span><br><span class="line">  |-- src&#x2F;test&#x2F;java(源码目录)：用于存放测试程序的java源文件</span><br><span class="line">  |-- src&#x2F;test&#x2F;resources(源码目录)：用于存放测试程序所需要配置文件</span><br><span class="line">  |-- src&#x2F;main&#x2F;webapp：(Web应用的根目录，作用类似于WebContent)</span><br><span class="line">   |-- WEB-INF：(受保护的目录)</span><br><span class="line">   |-- web.xml：(Web应用的核心配置文件)</span><br><span class="line">  |-- target&#x2F;classes(类目录)：源码目录中的资源经过编译后，会输出到类目录下。</span><br><span class="line">  |-- pom.xml：Maven项目中非常重要的文件，将来项目需要任何jar包或插件，都可以通过pom文件来导入这些jar包或插件。</span><br></pre></td></tr></table></figure><h2 id="导入已有的Maven项目"><a href="#导入已有的Maven项目" class="headerlink" title="导入已有的Maven项目"></a>导入已有的Maven项目</h2><p>现将后面通过SSM框架实现的&lt;&lt;永和大王门店管理系统&gt;&gt;（Maven）项目导入到我们的Eclipse开发环境中。</p><p>在导入项目时我们通常会通过 “File” –&gt; “Import…” 来导入项目，但是这样能会产生环境问题=，例如：如果项目本身自带的环境和我们当前使用的开发环境不一致，就会产生问题。可以按照下面的方式来进行导入。</p><p>下面是导入的步骤：</p><p><strong>1、创建一个新的Maven工程（JavaWeb工程）</strong></p><p>确保已经配置好Maven的环境后，在Eclipse中创建一个新的Maven工程（Javaweb工程），新工程的名字和所导入的工程的名字可以相同也可以不同，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ed42db71791984bdce6bbe04c3147120-dd9c493e907143578f4a77c21cfcfd80.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-22e8eaefea88d4984de071d8d3c304b6.png" alt="ed42db71791984bdce6bbe04c3147120"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ed42db71791984bdce6bbe04c3147120-dd9c493e907143578f4a77c21cfcfd80.png" target="_blank" rel="noopener">ed42db71791984bdce6bbe04c3147120</a></p><p><strong>2、解压yonghe-ssm.zip压缩包</strong></p><p>将下发的 yonghe-ssm 项目解压出来，解压后的结构如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200326195041536-f9ab7427e77844438ab4cb5c338eeef5.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-c658ce075d92bcc9c72143f7b9dce80b.png" alt="image-20200326195041536"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200326195041536-f9ab7427e77844438ab4cb5c338eeef5.png" target="_blank" rel="noopener">image-20200326195041536</a></p><p>打开 yonghe-ssm 目录：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200326195147418-7ba8888f14d143e48395efa6e4f3cd22.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-e8ab05a88cc62bb5e8186102946d294f.png" alt="image-20200326195147418"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200326195147418-7ba8888f14d143e48395efa6e4f3cd22.png" target="_blank" rel="noopener">image-20200326195147418</a></p><p><strong>3、将解压后的目录中的src目录选中并复制。</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b9bf1d703dc2546c114b1a7832113233-70ad4363f1da46e69c6cd7a88b006d81.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-8ba3e6c6a56b36dd127374d84529327c.png" alt="b9bf1d703dc2546c114b1a7832113233"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b9bf1d703dc2546c114b1a7832113233-70ad4363f1da46e69c6cd7a88b006d81.png" target="_blank" rel="noopener">b9bf1d703dc2546c114b1a7832113233</a></p><p><strong>4、点击新创建的Maven工程右键粘贴，将复制的src目录粘贴到新建的工程中</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/fdc57a6cab8a89d634112760063efe18-d146c385c7e54029be429f5e77c76aa3.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-5b641e51af99b604a69cdffb164c47a6.png" alt="fdc57a6cab8a89d634112760063efe18"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/fdc57a6cab8a89d634112760063efe18-d146c385c7e54029be429f5e77c76aa3.png" target="_blank" rel="noopener">fdc57a6cab8a89d634112760063efe18</a></p><p><strong>5、打开解压后的目录中的pom.xml文件, 复制其中的内容：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/32b2d2e712857eb26fae448eecf7ce26-4f933f7f1c9440b9be887ba122d14801.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-f6eb296c56db549371bb30c3d4d76736.png" alt="32b2d2e712857eb26fae448eecf7ce26"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/32b2d2e712857eb26fae448eecf7ce26-4f933f7f1c9440b9be887ba122d14801.png" target="_blank" rel="noopener">32b2d2e712857eb26fae448eecf7ce26</a></p><p>如果复制后项目或pom文件仍然报错, 可以更新Maven工程</p><p>**更新Maven工程：**在项目上右键选择 <strong>“Maven”</strong> —&gt; <strong>“Update<br>Project…”</strong>，在弹出的窗口中直接点击OK即可！</p><p><strong>6、执行SQL脚本文件，导入数据</strong></p><p>打开cmd，连接mysql数据库，执行<strong>yonghedb.sql</strong>中的SQL语句，创建数据库、表及插入记录。</p><p><strong>7、部署项目到服务器并启动服务器，访问测试</strong></p><p>在正确完成上面的操作后，打开浏览器访问如下地址：<a href="http://localhost/yonghe-ssm/index" target="_blank" rel="noopener">http://localhost/yonghe-ssm/index</a><br>，可以看到如下界面：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/770fe679ff527efa1f80fc4e57a96f79-b45af62dd5704ecf826b8018beebbdf6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-8c83af6daea438c75f98797bb7c2dcc5.png" alt="770fe679ff527efa1f80fc4e57a96f79"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/770fe679ff527efa1f80fc4e57a96f79-b45af62dd5704ecf826b8018beebbdf6.png" target="_blank" rel="noopener">770fe679ff527efa1f80fc4e57a96f79</a></p><h2 id="Maven的依赖管理"><a href="#Maven的依赖管理" class="headerlink" title="Maven的依赖管理"></a>Maven的依赖管理</h2><h3 id="依赖-jar包-管理"><a href="#依赖-jar包-管理" class="headerlink" title="依赖(jar包)管理"></a>依赖(jar包)管理</h3><p>依赖管理即jar包的管理，那么通过Maven创建的工程是如何管理jar包的？</p><p><strong>1、在Maven项目中如何引入jar包？</strong></p><p>在Maven创建的项目中，如果需要引用jar包，只需要在项目的pom.xml文件中添加jar包的坐标(GroupID + ArtifactID + Version)即可将jar包引进项目中，之后就可以在项目中使用所引入的jar包了。</p><p>例如，现在我们在pom.xml文件中，添加servlet的jar包的坐标如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在pom.xml文件中，添加mysql驱动包的坐标如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.32<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、项目中引入的jar包存放在哪里？</strong></p><p>那么问题来了，在pom文件中添加的servlet的jar包坐标，添加的仅仅是一个jar包对应的坐标，而这个jar包到底存放在哪里呢?</p><p>了解Maven管理jar包的规则之后，我们可以找到jar包的存放位置是在<strong>本地仓库</strong>（仓库默认是在：C:\Users\{当前用户}\.m2\repository）的 /javax/servlet/servlet-api/2.5/目录下，例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a9335bd016fc4426edf4e06a0a53ef73-10a406ce23c147c6b76addc575e7a80c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-3c8472fe57585ef281d6b15e4b6fcbe4.png" alt="a9335bd016fc4426edf4e06a0a53ef73"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a9335bd016fc4426edf4e06a0a53ef73-10a406ce23c147c6b76addc575e7a80c.png" target="_blank" rel="noopener">a9335bd016fc4426edf4e06a0a53ef73</a></p><p><strong>总结：</strong></p><ul><li>在Maven中，所有的jar包全都存放在本地仓库的目录中，如果项目中需要使用某一个jar包，直接在项目的pom.xml文件中通过坐标(GroupID + ArtifactID + Version)引入指定位置的jar包即可。</li><li>这样可以将项目中所有使用的jar包集中在一个目录（本地仓库）中统一进行管理，需要时通过坐标直接引入即可，而不是在每个项目中都拷贝一份，减少了项目体积，也节省了磁盘空间。</li><li>将来如果别人需要导入你的项目，只需要将项目（当然包括pom.xml文件）代码整体传给对方，无需将jar包发送给对方，对方在配置Maven的环境后，Maven会自动根据项目中pom.xml文件里配置的坐标，引入（或下载后再引入）对应的jar包。</li></ul><p><strong>3、如果引入的jar包在本地仓库中没有呢？</strong></p><ul><li><p>如果是刚配置的Maven环境，本地仓库中还没有太多jar包，此时在pom文件中通过坐标引入jar包，而本地仓库中没有这个jar包，这时会怎么样呢？</p></li><li><p>若本地仓库没有所需要的jar包，则会到镜像仓库（也叫私服）或者到中央仓库（也叫公服）中下载。下面我们就来介绍Maven的这三种仓库。</p></li></ul><h3 id="Maven三种仓库"><a href="#Maven三种仓库" class="headerlink" title="Maven三种仓库"></a>Maven三种仓库</h3><p>在上面所提到的本地仓库、镜像仓库、中央仓库是用来Maven用来更好的管理jar包的所采用的一种方式。下面来了解Maven的<strong>三种仓库</strong>，以及三种仓库之间的潜在联系。</p><p>通过maven构建的项目，会通过项目中的pom.xml文件从远程仓库下载，并保存到本地仓库</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6d744a6b627f8edded770b46bb5e316e-2a409d03ccbd4d64aef4c61ad2123bd4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-87e18156113618bca442440937f0dedf.png" alt="6d744a6b627f8edded770b46bb5e316e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6d744a6b627f8edded770b46bb5e316e-2a409d03ccbd4d64aef4c61ad2123bd4.png" target="_blank" rel="noopener">6d744a6b627f8edded770b46bb5e316e</a></p><p><strong>本地仓库</strong>：默认的本地仓库位置在：c:/$/.m2/repository，其中$表示windows下的用户目录。本地仓库的作用是，用于保存（存储）从私服或者从中央仓库下载下来的jar包（或插件）。当项目中需要使用jar包和插件时，优先从本地仓库查找。</p><p>如果本地仓库中没有所需的jar包，可以到私服或者到中央仓库中下载后再保存到本地仓库。</p><p><strong>镜像仓库</strong>：镜像仓库也叫做私服（Nexus），私服一般由公司搭建并维护（也可以自己搭建）。比如达内有搭建自己的私服服务器（<a href="http://maven.tedu.cn/nexus/content/groups/public/%EF%BC%89%EF%BC%8C%E4%BB%A5%E5%8F%8A%E9%98%BF%E9%87%8C%E4%BA%91%E7%A7%81%E6%9C%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%88http://maven.aliyun.com/nexus/content/groups/public/%EF%BC%89%E3%80%82" target="_blank" rel="noopener">http://maven.tedu.cn/nexus/content/groups/public/），以及阿里云私服服务器（http://maven.aliyun.com/nexus/content/groups/public/）。</a></p><p>如果项目中使用到的jar包或者插件本地仓库中没有，则可以到私服中下载，如果私服中有就直接将jar包保存到本地仓库中；而如果私服中也没有所需的jar包，就到中央仓库（公服）上下载所需要的jar包，下载之后先在私服上保存一份，最后再保存到本地仓库。</p><p><strong>中央仓库</strong>：中央仓库也叫做公服，在maven软件中内置了一个仓库地址（<a href="http://repo1.maven.org/maven2%EF%BC%89%E5%AE%83%E5%B0%B1%E6%98%AF%E4%B8%AD%E5%A4%AE%E4%BB%93%E5%BA%93%EF%BC%8C%E6%9C%8D%E5%8A%A1%E4%BA%8E%E6%95%B4%E4%B8%AA%E4%BA%92%E8%81%94%E7%BD%91%EF%BC%8C%E7%94%B1Maven%E5%9B%A2%E9%98%9F%E8%87%AA%E5%B7%B1%E6%90%AD%E5%BB%BA%E5%B9%B6%E7%BB%B4%E6%8A%A4%EF%BC%8C%E9%87%8C%E9%9D%A2%E5%AD%98%E5%82%A8%E4%BA%86%E9%9D%9E%E5%B8%B8%E5%85%A8%E7%9A%84jar%E5%8C%85%EF%BC%8C%E5%AE%83%E5%8C%85%E5%90%AB%E4%BA%86%E4%B8%96%E7%95%8C%E4%B8%8A%E5%A4%A7%E9%83%A8%E5%88%86%E6%B5%81%E8%A1%8C%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E7%9A%84jar%E5%8C%85%E3%80%82" target="_blank" rel="noopener">http://repo1.maven.org/maven2）它就是中央仓库，服务于整个互联网，由Maven团队自己搭建并维护，里面存储了非常全的jar包，它包含了世界上大部分流行的开源项目的jar包。</a></p><p>那么我们在使用Maven构建的Java项目，项目中所使用的jar包会来自哪里呢？例如，通过Maven先后构建项目A和项目B，在项目中都需要依赖第三方jar包：</p><ul><li><p>如果项目A中需要依赖第三方jar包，只需要在项目下的pom文件中引入jar包在<strong>本地仓库</strong>中的坐标即可使用。如果本地仓库没有所需要的jar包，则会连接私服（需要提前配置）下载所需jar包到本地仓库供项目使用。</p></li><li><p>如果私服上也没有所需的jar包，则会连接中央仓库下载所需要的jar包保存到私服，再将jar包从私服下载至本地仓库，供项目使用。</p></li><li><p>如果没有配置私服，则默认连接中央仓库下载所需要的jar包到本地仓库中供项目使用</p></li><li><p>当项目B也需要依赖第三方jar包时，先到本地仓库中查找所需jar包，如果有则直接引用而无需再次下载，如果仍有部分jar包本地仓库中没有，则同上，即连接私服下载所需jar包到本地仓库。若私服中也没有所需jar包，则连接中央仓库下载jar包到私服，再从私服下载jar包到本地仓库中，供项目使用。</p></li></ul><h3 id="添加依赖-方式一"><a href="#添加依赖-方式一" class="headerlink" title="添加依赖:方式一"></a>添加依赖:方式一</h3><p>使用maven插件的索引功能快速添加jar包</p><p>这种方式需要<strong>本地仓库中已经包含了该jar包，否则搜索不到</strong>!!!</p><p>1、如果本地仓库中有我们需要的jar包，可以在项目中的pom.xml文件中空白处右键–&gt; Maven –&gt; Add Dependency在弹出的窗口中添加所需要的依赖(jar包)，如图：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/33fe1d9ff8f2d46631335a13ee2d6b51-06e1e53315ad40718fb65f172be6da36.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-399834f5117dd8989d17f0bb84cc5746.png" alt="33fe1d9ff8f2d46631335a13ee2d6b51"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/33fe1d9ff8f2d46631335a13ee2d6b51-06e1e53315ad40718fb65f172be6da36.png" target="_blank" rel="noopener">33fe1d9ff8f2d46631335a13ee2d6b51</a></p><p>**2、**添加依赖示例：添加spring的jar包的坐标到项目中</p><p>(1) 在项目中的pom.xml文件中右键 -&gt; Maven -&gt; Add Dependency，在弹出的窗口中输入<br>“spring”:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/5b98e92822f738cda80091a2d4709bb8-49a2de110843419dac7636e8ae180c41.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-4a5fd58382b1b33dfd626c3315fb8459.png" alt="5b98e92822f738cda80091a2d4709bb8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/5b98e92822f738cda80091a2d4709bb8-49a2de110843419dac7636e8ae180c41.png" target="_blank" rel="noopener">5b98e92822f738cda80091a2d4709bb8</a></p><p>选中要添加的jar包（坐标会自动填写），点击OK即可完成添加</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/172e2faf10ff88ed41dfd5fff6e05939-c091c38645514a42bdbf28fa55c5fc47.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-0c94ec2e15cd163da6bb7c24147cb831.png" alt="172e2faf10ff88ed41dfd5fff6e05939"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/172e2faf10ff88ed41dfd5fff6e05939-c091c38645514a42bdbf28fa55c5fc47.png" target="_blank" rel="noopener">172e2faf10ff88ed41dfd5fff6e05939</a></p><p>(2)如果搜索不到jar包（保证本地仓库中已经下载了该jar包），可以尝试重建索引。</p><p>在</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/facabede667d2edbead383cd5d725a75-e70efca1ec9c45e7be95fe9c34123029.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-35d02b7b691559ad0575d31615ee2f9c.png" alt="facabede667d2edbead383cd5d725a75"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/facabede667d2edbead383cd5d725a75-e70efca1ec9c45e7be95fe9c34123029.png" target="_blank" rel="noopener">facabede667d2edbead383cd5d725a75</a></p><p>“Maven Repositories” 视图窗口中可以看到如下内容：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/fe8dfdbc79b3219c161e97c1f650b2a5-2bc24cf1ffc3403a9a1dd4cd383ec7fd.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-dd451daf923d5b15c7760668036e1d17.png" alt="fe8dfdbc79b3219c161e97c1f650b2a5"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/fe8dfdbc79b3219c161e97c1f650b2a5-2bc24cf1ffc3403a9a1dd4cd383ec7fd.png" target="_blank" rel="noopener">fe8dfdbc79b3219c161e97c1f650b2a5</a></p><p>在”Local Repositories”上右键选择 “Rebuild Index” 即可重建索引。</p><p>完成后，再尝试搜索jar包进行添加。</p><h3 id="添加依赖-方式二"><a href="#添加依赖-方式二" class="headerlink" title="添加依赖:方式二"></a>添加依赖:方式二</h3><p><strong>1、直接在pom.xml文件中的标签内部添加。例如：在pom.xml文件中添加如下配置，就可以将junit单元测试的jar包引入到项目中来了。</strong></p><p>添加依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、手动添加依赖需要指定所依赖jar包的坐标，但是在大部分情况下，我们是不知道jar包的坐标的。可以通过访问如下网址，在互联网上搜索查询：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;mvnrepository.com</span><br></pre></td></tr></table></figure><p>或者在公司镜像仓库中搜索查询:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;maven.tedu.cn&#x2F;nexus</span><br></pre></td></tr></table></figure><p><strong>3、示例：添加c3p0的jar包的坐标到项目中</strong></p><ul><li><p>访问上面其中的一个网址，在搜索框中搜索 “c3p0”</p></li><li><p>在搜索出来的内容中，选择所需要的版本并点击版本，查看该版本的c3p0<br>jar包所对应的坐标：</p></li><li><p>将坐标直接拷贝到项目的pom.xml文件中即可：</p></li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120117127-82a089391ab147d6a0a0c1079fad4c24.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-1ddc14cc52cec31eddfce81bc9f7c581.png" alt="image-20200225120117127"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120117127-82a089391ab147d6a0a0c1079fad4c24.png" target="_blank" rel="noopener">image-20200225120117127</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120916520-0fd8cc2080004201ba0d1ea937acc867.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-a730f4e82aacafb3f163025e652add0f.png" alt="image-20200225120916520"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120916520-0fd8cc2080004201ba0d1ea937acc867.png" target="_blank" rel="noopener">image-20200225120916520</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120728549-e8488c32aac84f708ee550434a58649f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-e4129c17233fa823a8b01c8cf3b0087c.png" alt="image-20200225120728549"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225120728549-e8488c32aac84f708ee550434a58649f.png" target="_blank" rel="noopener">image-20200225120728549</a></p><p><strong>4、将上图中右侧选中的坐标拷贝到pom.xml文件中:</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225121143892-e1d4a18c9853443692aa53627b9c883a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-c73ec72e1e1178e5b6f096f143f515fd.png" alt="image-20200225121143892"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200225121143892-e1d4a18c9853443692aa53627b9c883a.png" target="_blank" rel="noopener">image-20200225121143892</a></p><h2 id="FAQ-Maven常见问题"><a href="#FAQ-Maven常见问题" class="headerlink" title="FAQ:Maven常见问题"></a>FAQ:Maven常见问题</h2><h3 id="常见Maven环境问题"><a href="#常见Maven环境问题" class="headerlink" title="常见Maven环境问题"></a>常见Maven环境问题</h3><p>问题描述：</p><ul><li>创建Maven项目时报如下错误：</li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315204732042-f27f2e6669984cb6961d6c40732c2615.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-bbe506cd88e8f477a28043df9b8b066a.png" alt="image-20200315204732042"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315204732042-f27f2e6669984cb6961d6c40732c2615.png" target="_blank" rel="noopener">image-20200315204732042</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315204802766-13a66721643246109f3a55bca0a42c97.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-1c24e7a838359721c3b1d105c6a529cf.png" alt="image-20200315204802766"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315204802766-13a66721643246109f3a55bca0a42c97.png" target="_blank" rel="noopener">image-20200315204802766</a></p><ul><li>或者创建Maven项目目录结构不全（比如只有src目录），如下图：</li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315205928911-80d640e31fd04a9cb837856f20d14543.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-572823ff54032df2252305a2cc0e9474.png" alt="image-20200315205928911"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315205928911-80d640e31fd04a9cb837856f20d14543.png" target="_blank" rel="noopener">image-20200315205928911</a></p><ul><li>导入已有的Maven项目，项目运行不了（jar没有下载完全）</li></ul><p>此时是因为maven的环境被破坏了，导致Maven基础运行环境不全，无法创建Maven项目，或者无法下载所需要的jar包。解决方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(1)在项目的pom文件中敲一个空白行,再保存文件，目的是让maven检测到pom文件发生变化，再根据pom文件中的配置到本地仓库中寻找对应的jar包，如果没有相应的jar包，maven会重新下载。</span><br><span class="line">(2)如果上面的方式不行,可以尝试在项目上,右键---&gt; Maven ---&gt; Update Project...,强制更新项目,此时maven也会检查pom文件，在本地仓库中有没有相应的jar包。</span><br><span class="line">(3)如果上面的方式仍然没有解决问题，检查当前网络环境是否能连接上所配置的镜像仓库。（比如在家里使用外网，无法连接达内的镜像仓库，或者使用手机热点网络无法连接阿里云的镜像仓库等）</span><br><span class="line">(4)如果网络能够连接上所配置的镜像仓库，到本地仓库的目录下，将本地仓库中所有的目录都删除，删除时，eclipse正在使用本地仓库中的资源文件，所以会阻止删除，此时将eclipse关闭，再将本地仓库中的所有目录删除，重启eclipse。</span><br><span class="line">(5)启动eclipse后,再将上面的第(1)步和第(2)步再做一遍!</span><br></pre></td></tr></table></figure><p>问题描述2：每天第一次打开Eclipse发现之前创建的Maven工程报错（比如项目上有叉号或者叹号，但项目之前是OK的），解决方法：在菜单栏中找到 Project —&gt; Clean….</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315210421557-8cb7818efaf64e51a93f7d9ab4e8846b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-a88082939839823990db90955d0030a5.png" alt="image-20200315210421557"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315210421557-8cb7818efaf64e51a93f7d9ab4e8846b.png" target="_blank" rel="noopener">image-20200315210421557</a></p><h3 id="找不到jar包问题"><a href="#找不到jar包问题" class="headerlink" title="找不到jar包问题"></a>找不到jar包问题</h3><p>在项目中通过坐标引入了jar包（或者插件），并且本地仓库中也存在对应的jar包，但是项目还是报错，提示内容说找不到。</p><p>解决方法：如果引入的jar包，在本地仓库中存在，但是还是提示找不到，可以将本地仓库中jar包或插件的所在目录整个删除(如果删除时提示文件正在被占用，关闭eclipse再删除即可)，重新保存pom.xml文件，并更新工程，让maven再次下载上面的jar包即可！</p><p>未下载完全示例：<br><a href="https://www.zhangpeng.fun/upload/2020/06/71d763b5d1bea2be9037ab549f3a6033-0abd5b5b3aec4a48be8a02dd4bb0f98a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-734b75dba49354a597fbc13d8b426524.png" alt="71d763b5d1bea2be9037ab549f3a6033"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/71d763b5d1bea2be9037ab549f3a6033-0abd5b5b3aec4a48be8a02dd4bb0f98a.png" target="_blank" rel="noopener">71d763b5d1bea2be9037ab549f3a6033</a></p><p>正常下载完全示例：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c4988ae458e47fe30d6fb6ab1ebf9522-56b625788c0c404f878018e198fe3db2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-be594de07cdc45f22f49b6404f2a25b5.png" alt="c4988ae458e47fe30d6fb6ab1ebf9522"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c4988ae458e47fe30d6fb6ab1ebf9522-56b625788c0c404f878018e198fe3db2.png" target="_blank" rel="noopener">c4988ae458e47fe30d6fb6ab1ebf9522</a></p><h3 id="拷贝Maven仓库"><a href="#拷贝Maven仓库" class="headerlink" title="拷贝Maven仓库"></a>拷贝Maven仓库</h3><p>如果因为网络环境的问题，导致jar包无法下载，也可以将别人下载好的（完整的）Maven的本地仓库拷贝过来，放在自己配置的本地仓库中。因为Maven可以支持拷贝别人的仓库。</p><h2 id="扩展-Maven项目结构"><a href="#扩展-Maven项目结构" class="headerlink" title="扩展:Maven项目结构"></a>扩展:Maven项目结构</h2><p>使用Maven创建的工程我们称它为Maven工程，Maven工程具有一定的目录规范，对目录结构有严格的要求，一个Maven工程要具有如下目录结构：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9de5e6454964c4be0b3284fd4845ce85-d3f1a419d10943858746ad32a8fc609f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591871021-5364571e1145dfa78b868b282c6f4350.png" alt="9de5e6454964c4be0b3284fd4845ce85"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9de5e6454964c4be0b3284fd4845ce85-d3f1a419d10943858746ad32a8fc609f.png" target="_blank" rel="noopener">9de5e6454964c4be0b3284fd4845ce85</a></p><p>Maven项目目录介绍：</p><p>1）/src/main/java – 主目录下的Java目录，用于存放项目中的.java文件</p><p>2）/src/main/resources –- 主目下的资源目录，存放项目中的资源文件(如框架的配置文件)</p><p>3）/src/test/java – 测试目录下的Java目录，用于存放所有单元测试类的.java文件，如Junit测试类</p><p>4）/src/test/resources – 测试目录下的资源目录，用于存放测试类所需资源文件(如框架的配置文件)</p><p>5）/target – 项目输出目录，编译后的class文件、及项目打成的war包等会输出到此目录中</p><p>6）/pom.xml – maven项目的核心配置文件，文件中通过坐标来管理项目中的所有jar包和插件。</p><h1 id="maven-javaweb"><a href="#maven-javaweb" class="headerlink" title="maven   javaweb"></a><a href="https://www.zhangpeng.fun/tags/maven" target="_blank" rel="noopener">maven</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="maven" scheme="https://zpengit.github.io/tags/maven/"/>
    
  </entry>
  
  <entry>
    <title>08-JSP、EL、JSTL</title>
    <link href="https://zpengit.github.io/2020/06/11/08-JSP%E3%80%81EL%E3%80%81JSTL/"/>
    <id>https://zpengit.github.io/2020/06/11/08-JSP%E3%80%81EL%E3%80%81JSTL/</id>
    <published>2020-06-11T10:52:39.504Z</published>
    <updated>2020-06-11T10:45:15.167Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="08-JSP、EL、JSTL"><a href="#08-JSP、EL、JSTL" class="headerlink" title="08-JSP、EL、JSTL"></a>08-JSP、EL、JSTL</h1><h1 id="unit08-JSP、EL、JSTL"><a href="#unit08-JSP、EL、JSTL" class="headerlink" title="unit08-JSP、EL、JSTL"></a>unit08-JSP、EL、JSTL</h1><h2 id="JSP概述"><a href="#JSP概述" class="headerlink" title="JSP概述"></a>JSP概述</h2><h3 id="什么是JSP"><a href="#什么是JSP" class="headerlink" title="什么是JSP"></a>什么是JSP</h3><p>JSP和Servlet都是由SUN公司提供的动态Web资源开发技术。</p><p>JSP看起来像一个HTML，但和HTML不同的是，JSP中可以书写Java代码，可以通过Java代码展示动态的数据。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">静态Web资源：任何人在任何条件下访问时，看到的都是相同的效果，这样的资源叫做静态Web资源。（html、css、js等）</span><br><span class="line">动态Web资源：不同的人，在不同的条件下访问时，看到的都是不同的效果，这样的资源叫做动态Web资源。（Servlet、jsp、php、.NET等）</span><br></pre></td></tr></table></figure><p>JSP本质上是一个Servlet程序</p><p><strong>思考1：为什么要学习JSP?</strong></p><ul><li>Servlet是一段Java程序，适合处理业务逻辑，但是Servlet不适合向浏览器输出一个html网页。</li><li>html可以作为页面返回，但是html是一个静态Web资源，无法展示动态数据。</li><li>而JSP也是页面的开发技术，也可以作为页面返回，并且JSP中可以书写Java代码，可以通过Java代码展示动态的数据。</li><li>因此，JSP的出现即解决了Servlet不适合输出页面的问题，也解决了HTML无法展示动态数据的问题！</li></ul><p><strong>思考2：为什么说JSP本质是一个Servlet?</strong></p><p>在JSP第一次被访问时，会翻译成一个Servlet程序。访问JSP后看到的html网页，其实是翻译后的Servlet执行的结果。（也就是说，访问JSP后看到的网页，是JSP翻译后的Servlet输出到浏览器的。）</p><h3 id="JSP执行过程"><a href="#JSP执行过程" class="headerlink" title="JSP执行过程"></a>JSP执行过程</h3><p><strong>访问服务器中的JSP文件，其执行过程为</strong>:</p><ol><li>当浏览器请求服务器中的某一个JSP文件（例如：localhost/09-jsp/test.jsp），服务器会根据请求资源的路径去寻找该文件：</li><li>如果找到了，JSP翻译引擎会将JSP翻译成一个Servlet程序（JSP—-&gt; xxx.java—-&gt; xxx.class）,然后Servlet程序再执行，执行的结果是向浏览器输出一个HTML网页！</li><li>如果没有找到，服务器将会响应一个404页面，通知浏览器请求的资源不存在。</li></ol><p><strong>访问服务器中的HTML文件，其执行过程为</strong>:</p><ol><li>当浏览器请求服务器中的某一个HTML文件时（例如：localhost/09-jsp/test.html），服务器会根据请求资源的路径去寻找该文件：</li><li>如果找到了，服务器会将html文件的内容作为响应实体发送给浏览器，浏览器再解析html并显示在网页上。</li><li>如果没有找到，服务器将会响应一个404页面，通知浏览器请求的资源不存在。</li></ol><h3 id="修改JSP模版"><a href="#修改JSP模版" class="headerlink" title="修改JSP模版"></a>修改JSP模版</h3><p>修改JSP模版步骤: 点击菜单栏中的 window –&gt; Preferences，出现如下窗口:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4ff5d1a10bfe557a7ab921485a8ec375-3f5559f861104bccbe2033fc21ddc15c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870963-6d8cc0ff65c06061232162ea089fdb13.png" alt="4ff5d1a10bfe557a7ab921485a8ec375"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4ff5d1a10bfe557a7ab921485a8ec375-3f5559f861104bccbe2033fc21ddc15c.png" target="_blank" rel="noopener">4ff5d1a10bfe557a7ab921485a8ec375</a></p><p>点击edit编辑JSP模版，修改为如下:</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"utf-8"</span>/&gt;</span><br><span class="line">&lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">$&#123;cursor&#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="JSP语法"><a href="#JSP语法" class="headerlink" title="JSP语法"></a>JSP语法</h2><h3 id="模版元素"><a href="#模版元素" class="headerlink" title="模版元素"></a>模版元素</h3><p>模板元素是指写在JSP中的html内容</p><p>或者除了JSP特有内容以外的其他内容称之为模板元素</p><p>模板元素在翻译后的Servlet中，被out.write原封不动的发送给浏览器，由浏览器负责解析并显示。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200331114124004-5c6f0f6ce5c847e88145975b66c0d719.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870963-ff355fcf29243ce2c6a97f2780a31ecf.png" alt="image-20200331114124004"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200331114124004-5c6f0f6ce5c847e88145975b66c0d719.png" target="_blank" rel="noopener">image-20200331114124004</a></p><h3 id="JSP表达式"><a href="#JSP表达式" class="headerlink" title="JSP表达式"></a>JSP表达式</h3><p>格式：<code>&lt;%= 常量、变量、表达式 %&gt;</code></p><p>作用：计算表达式的结果，将结果输出到浏览器中，由浏览器负责解析并显示。</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= <span class="string">"Hello JSP..."</span> %&gt;</span><br><span class="line">&lt;% String name = <span class="string">"林青霞"</span>; %&gt;</span><br><span class="line">&lt;%= name %&gt;</span><br><span class="line">&lt;%= <span class="number">100</span>+<span class="number">123</span> %&gt;</span><br><span class="line">&lt;%= Math.random() %&gt;</span><br></pre></td></tr></table></figure><h3 id="JSP脚本片段"><a href="#JSP脚本片段" class="headerlink" title="JSP脚本片段"></a>JSP脚本片段</h3><p>格式：<code>&lt;% 若干Java语句 %&gt;</code></p><p>作用：在翻译后的Servlet中，将脚本片段中的Java语句复制粘贴到Servlet的对应的位置执行。例如：</p><p>在JSP中代码如下：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 在页面上输出<span class="number">5</span>行<span class="string">"hello JSP"</span> --&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">out.write(<span class="string">"Hello JSP...&lt;br/&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>在翻译后的Servlet中代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">out.write(<span class="string">"Hello JSP...&lt;br/&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>另外，在某一个脚本片段中的Java代码可以是不完整的，但是在JSP中所有的脚本片段加在一起，必须是完整符合Java语法。例如，在JSP中代码如下：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123; %&gt;</span><br><span class="line">Hello JSP~~~&lt;br/&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>在翻译后的Servlet中：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123; </span><br><span class="line">  out.write(<span class="string">"\r\n"</span>);</span><br><span class="line">  out.write(<span class="string">"\t\t\tHello JSP~~~&lt;br/&gt;\r\n"</span>);</span><br><span class="line">  out.write(<span class="string">"\t"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSP注释"><a href="#JSP注释" class="headerlink" title="JSP注释"></a>JSP注释</h3><p>格式：&lt;%– JSP注释内容 –%&gt;</p><p>作用：（1）为代码添加解释说明 （2）将一些暂时不需要执行的代码注释掉。</p><p>在JSP翻译时，注释内容不会参与翻译，而是直接被丢弃</p><p>面试题：考察JSP中的JSP注释、Java注释、html注释</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- </span><br><span class="line">&lt;% out.write( <span class="string">"aaaaa&lt;br/&gt;"</span> ); %&gt;</span><br><span class="line"> --%&gt;</span><br><span class="line">&lt;% <span class="comment">//out.write( "bbbbb&lt;br/&gt;" ); %&gt;</span></span><br><span class="line">&lt;!-- </span><br><span class="line">&lt;% out.write( <span class="string">"ccccc&lt;br/&gt;"</span> ); %&gt;</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure><p>问题：（1）上面输出的三行内容，在访问时，会显示哪一行内容？</p><p>第一行被JSP注释给注释了，JSP注释的内容不会参与翻译，也不会执行，更不会发送给浏览器，也不会在浏览器上显示。</p><p>第二行被Java注释给注释了，放在脚本片段中的内容会参与翻译，会将其中的Java代码复制到翻译后的Servlet中，但由于代码被注释了，所以不会执行，也不会发送给浏览器，更不会在浏览器上显示。</p><p>第三行被html注释给注释了，html注释在JSP中是模板元素，注释本身会发送给浏览器，注释中的脚本片段会参与翻译，其中的java代码也会执行，也会将内容（ccccc）发送给浏览器，但由于发送到浏览器后的ccccc被html注释包裹，因此也不会显示在浏览器上。</p><p>（2）上面输出的三行内容，哪一行会发送到浏览器中？（不管是否显示）</p><p>其中第三行内容会发送到浏览器中，但不会显示，因为前后有html注释。</p><h3 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h3><p>指令的格式：<code>&lt;%@ 指令名称 若干属性声明... %&gt;</code></p><p>指令的作用：用于指挥JSP解析引擎如何将一个JSP翻译成一个Servlet程序。</p><p><strong>1、page指令</strong>：用于声明JSP的基本属性信息（比如JSP使用的编码，JSP使用的开发语言等）</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span>%&gt;</span><br><span class="line">-- language属性用于指定当前JSP使用的开发语言，目前只有java语言支持</span><br><span class="line"></span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">"java.util.Date"</span>%&gt;</span><br><span class="line">-- <span class="keyword">import</span>属性用于导入包，如果不导入包，在使用其他包下的类时，就需要在类名前面加上包路径，例如： java.util.Date date = <span class="keyword">new</span> java.util.Date();</span><br><span class="line"></span><br><span class="line">&lt;%@ page pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">-- pageEncoding属性是用于指定当前JSP使用的编码，Eclipse工具会根据这个编码保存JSP文件。</span><br><span class="line">保证pageEncoding属性指定的编码和JSP文件保存时使用的编码相同,可以避免JSP文件出现乱码!</span><br></pre></td></tr></table></figure><p><strong>2、taglib指令</strong>：用于引入JSTL标签库或者其他的自定义标签库</p><p>后面讲解JSTL标签库时会讲解！</p><h2 id="JSP标签技术"><a href="#JSP标签技术" class="headerlink" title="JSP标签技术"></a>JSP标签技术</h2><p>在JSP页面中写入大量的java代码会导致JSP页面中html代码和java代码混杂在一起，会造成jsp页面结构的混乱，导致后期难于维护，并且代码难以复用。</p><p>于是在JSP的2.0版本中，sun提出了JSP标签技术，推荐使用标签来代替JSP页面中java代码，并且推荐，JSP2.0以后不要在JSP页面中出现任何一行java代码。</p><h3 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a>EL表达式</h3><p>格式：<code>${ 常量/表达式/变量 }</code> （放在EL中的变量得先存入域中，才可以获取变量的值）</p><p>作用：（1）计算放在其中的表达式的结果，将结果输出在当前位置。</p><p>（2）主要作用：用于从域对象中获取数据，将获取到的数据输出在当前位置。</p><p>域对象：pageContext、request、session、application</p><p><strong>1、获取常量、表达式、变量的值（变量得先存入域中）</strong></p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$&#123; <span class="string">"hello el"</span> &#125; </span><br><span class="line">hello el&lt;br/&gt;</span><br><span class="line">$&#123; <span class="number">100</span>+<span class="number">123</span> &#125;</span><br><span class="line">$&#123; <span class="number">12</span>*<span class="number">12</span> &gt; <span class="number">143</span> ? <span class="string">"yes"</span> : <span class="string">"no"</span> &#125; &lt;br/&gt;</span><br><span class="line"></span><br><span class="line">&lt;% </span><br><span class="line">String name = <span class="string">"马云"</span>;</span><br><span class="line">request.setAttribute( <span class="string">"name123"</span> , name );</span><br><span class="line">%&gt;</span><br><span class="line">$&#123; name123 &#125;</span><br><span class="line">&lt;%= request.getAttribute(<span class="string">"name123"</span>) %&gt;</span><br><span class="line">&lt;%-- 在EL表达式中书写变量,底层会根据变量名到四个作用域中寻找该名称的属性值</span><br><span class="line">如果找到对应的属性值, 就直接返回, 输出到当前位置; 如果找不到就接着寻找</span><br><span class="line">直到找完四个作用域, 最后还找不到就什么都不输出!</span><br><span class="line">到四个作用域中寻找的顺序为: pageContext-&gt;request-&gt;session-&gt;application</span><br><span class="line"> --%&gt;</span><br></pre></td></tr></table></figure><p><strong>2、获取作用域中数组或集合中的元素</strong></p><p>Servlet中的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明一个数组, 为数组添加元素, 并将数组存入到域中</span></span><br><span class="line">String[] names = &#123;<span class="string">"刘德华"</span>, <span class="string">"郭富城"</span>, <span class="string">"张学友"</span>, <span class="string">"黎明"</span> &#125;;</span><br><span class="line">request.setAttribute( <span class="string">"names"</span>, names );</span><br><span class="line"><span class="comment">//将请求转发到jsp, 在JSP中获取域中的数组中的元素</span></span><br><span class="line">request.getRequestDispatcher( <span class="string">"/02-el.jsp"</span> ).forward(request, response);</span><br></pre></td></tr></table></figure><p>JSP中的代码：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- 获取从Servlet转发带过来的域中的数组中的元素 --%&gt;</span><br><span class="line">$&#123; names[<span class="number">0</span>] &#125; &lt;%-- 刘德华 --%&gt;</span><br><span class="line">$&#123; names[<span class="number">1</span>] &#125; &lt;%-- 郭富城  --%&gt;</span><br><span class="line">$&#123; names[<span class="number">2</span>] &#125; &lt;%-- 张学友 --%&gt;</span><br><span class="line">$&#123; names[<span class="number">3</span>] &#125; &lt;%-- 黎明 --%&gt;</span><br></pre></td></tr></table></figure><p><strong>3、获取作用域中map集合中的元素</strong></p><p>Servlet中的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明一个map集合,为集合添加元素, 并将map集合存入到域中</span></span><br><span class="line">Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">map.put( <span class="string">"name"</span> , <span class="string">"尼古拉斯赵四"</span> );</span><br><span class="line">map.put( <span class="string">"age"</span> ,  <span class="number">28</span> );</span><br><span class="line">map.put( <span class="string">"addr"</span>, <span class="string">"中国"</span> );</span><br><span class="line">request.setAttribute( <span class="string">"map1"</span>, map );</span><br><span class="line"><span class="comment">//将请求转发到jsp, 在JSP中获取域中的数组中的元素</span></span><br><span class="line">request.getRequestDispatcher( <span class="string">"/02-el.jsp"</span> ).forward(request, response);</span><br></pre></td></tr></table></figure><p>JSP中的代码：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123; map1.name &#125; &lt;%-- 尼古拉斯赵四 --%&gt;</span><br><span class="line">$&#123; map1.age &#125; &lt;%-- <span class="number">28</span> --%&gt;</span><br><span class="line">$&#123; map1.addr &#125; &lt;%-- 中国 --%&gt;</span><br></pre></td></tr></table></figure><p><strong>4、获取作用域中JavaBean对象的属性值</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Bean：指可重用的组件</span><br><span class="line">JavaBean：指Java中可重用的组件</span><br><span class="line">业务Bean：专门用于处理业务逻辑（例如：处理注册请求时，在将用户的注册信息保存到数据库之前，需要对注册薪资进行校验）</span><br><span class="line">实体Bean：是专门用于封装数据的（例如：User user &#x3D; new User() ...）</span><br></pre></td></tr></table></figure><p>Servlet中的代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明一个User对象, 为对象的属性赋值, 并将User对象存入到域中</span></span><br><span class="line">User u1 = <span class="keyword">new</span> User();</span><br><span class="line">u1.setName( <span class="string">"刘德华"</span> );</span><br><span class="line">u1.setAge( <span class="number">18</span> );</span><br><span class="line">u1.setAddr( <span class="string">"中国香港"</span> );</span><br><span class="line">request.setAttribute( <span class="string">"user"</span> , u1 );</span><br><span class="line"></span><br><span class="line"><span class="comment">//将请求转发到jsp, 在JSP中获取域中的数组中的元素</span></span><br><span class="line">request.getRequestDispatcher( <span class="string">"/02-el.jsp"</span> ).forward(request, response);</span><br></pre></td></tr></table></figure><p>JSP中的代码：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- </span><br><span class="line">$&#123; user.getName() &#125;</span><br><span class="line">$&#123; user.getAge() &#125;</span><br><span class="line">$&#123; user.getAddr() &#125; --%&gt;</span><br><span class="line">&lt;hr/&gt;</span><br><span class="line">&lt;%-- user.name 底层调用的仍然是 getName()方法--%&gt;</span><br><span class="line">$&#123; user.name &#125;</span><br><span class="line">&lt;%-- user.age 底层调用的仍然是 getAge()方法--%&gt;</span><br><span class="line">$&#123; user.age &#125;</span><br><span class="line">&lt;%-- user.addr 底层调用的仍然是 getAddr()方法--%&gt;</span><br><span class="line">$&#123; user.addr &#125;</span><br></pre></td></tr></table></figure><h3 id="JSTL标签库"><a href="#JSTL标签库" class="headerlink" title="JSTL标签库"></a>JSTL标签库</h3><p>JSTL标签库是为JavaWeb开发人员提供的一套标准通用的标签库；</p><p>JSTL标签库和EL配合使用可以取代JSP中大部分的Java代码；</p><p>在使用JSTL标签库之前需要完成：</p><ul><li>导入JSTL的开发包</li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401090204772-d189920485104ad0931ec9d4bb19c990.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870963-ac03fdf8669ee7824172e32954bd9fd0.png" alt="image-20200401090204772"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401090204772-d189920485104ad0931ec9d4bb19c990.png" target="_blank" rel="noopener">image-20200401090204772</a></p><ul><li>在使用JSTL标签库的JSP中引入JSTL（taglib指令）</li></ul><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401090301088-df57671a57554c4d9e0c17b2ed085c8f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870963-0b433120735bfdcd37c4abf000d1d841.png" alt="image-20200401090301088"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200401090301088-df57671a57554c4d9e0c17b2ed085c8f.png" target="_blank" rel="noopener">image-20200401090301088</a></p><hr><p><strong>其中常用的标签如下:</strong></p><p><code>1、&lt;c:set&gt;&lt;/c:set&gt;</code> – 用于往域中添加属性，或者修改域中已有的属性值</p><p><strong>c:set 标签属性总结:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(1)var -- 指定存入作用域中的属性名称</span><br><span class="line">(2)value -- 指定存入作用域中属性的值</span><br><span class="line">(3)scope -- 指定将属性存入哪一个作用域中,默认值是page,表示pageContext域</span><br><span class="line">可取值: a)page表示pageContext域 b)request表示request域</span><br><span class="line">c)session表示session域 d)application表示ServletContext域</span><br></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- request.setAttribute(<span class="string">"name"</span>, <span class="string">"张三"</span>); --%&gt;</span><br><span class="line">&lt;c:set <span class="keyword">var</span>=<span class="string">"name"</span> value=<span class="string">"张三"</span> scope=<span class="string">"request"</span>/&gt;</span><br><span class="line">$&#123; name &#125;</span><br><span class="line"></span><br><span class="line">&lt;% String job = <span class="string">"java开发工程师"</span>; %&gt;</span><br><span class="line">&lt;c:set <span class="keyword">var</span>=<span class="string">"job"</span> value=<span class="string">"&lt;%= job %&gt;"</span> scope=<span class="string">"request"</span>/&gt;</span><br><span class="line">$&#123; job &#125;</span><br><span class="line"></span><br><span class="line">&lt;c:set <span class="keyword">var</span>=<span class="string">"name"</span> value=<span class="string">"张三丰"</span> scope=<span class="string">"request"</span>/&gt;</span><br><span class="line">$&#123; name &#125;</span><br></pre></td></tr></table></figure><p><code>2、&lt;c:if&gt;&lt;/c:if&gt;</code> – 构造简单的 if…else…结构语句</p><p><strong>c:if 标签属性总结:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test属性 -- 指定一个布尔表达式，当表达式的结果为true时，将会执行（输出）c:if标签中的内容，如果表达式结果为false,将不会输出c:if标签中的内容</span><br></pre></td></tr></table></figure><p>代码示例：往域中存入一个成绩, 根据成绩判断成绩所属的等级</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;c:if test="$&#123; 3&gt;5 &#125;"&gt;yes&lt;/c:if&gt;</span><br><span class="line">&lt;c:if test="$&#123; 3&lt;=5 &#125;"&gt;no&lt;/c:if&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;!-- 根据成绩判断成绩所属的等级 --&gt;</span><br><span class="line">&lt;c:set <span class="keyword">var</span>=<span class="string">"score"</span> value=<span class="string">"-35"</span>/&gt;</span><br><span class="line">&lt;c:if test="$&#123; score&gt;=80 and score&lt;=100 &#125;"&gt;您的成绩属于: 优秀!&lt;/c:if&gt;</span><br><span class="line">&lt;c:if test="$&#123; score&gt;=60 and score&lt;80 &#125;"&gt;您的成绩属于: 中等!&lt;/c:if&gt;</span><br><span class="line">&lt;c:if test="$&#123; score&gt;=0 and score&lt;60 &#125;"&gt;您的成绩属于: 不及格!&lt;/c:if&gt;</span><br><span class="line">&lt;c:if test="$&#123; score&lt;0 or score&gt;100 &#125;"&gt;您的成绩有误!&lt;/c:if&gt;</span><br></pre></td></tr></table></figure><p><code>3、&lt;c:forEach&gt;&lt;/c:forEach&gt;</code> – 对集合或数组等中元素进行循环遍历或者是执行指定次数的循环.</p><p>(1) 遍历域中数组或集合中的元素</p><p>(2) 遍历域中map集合中的元素</p><p>(3) 遍历0~100之间的整数，将是3的倍数的数值输出到浏览器中</p><p><strong>c:forEach 标签属性总结:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(1)items: 指定需要遍历的集合或数组</span><br><span class="line">(2)var: 指定用于接收遍历过程中的每一个元素</span><br><span class="line">(3)begin: 指定循环从哪儿开始</span><br><span class="line">(4)end: 指定循环到哪儿结束</span><br><span class="line">(5)step: 指定循环时的步长, 默认值是1</span><br><span class="line">(6)varStatus: 用于表示循环遍历状态信息的对象, 这个对象上有如下属性:</span><br><span class="line">first属性: 表示当前遍历是否是第一次, 若是, 则返回true;</span><br><span class="line">last属性: 表示当前遍历是否是最后一次, 若是, 则返回true;</span><br><span class="line">count属性: 记录当前遍历是第几次</span><br></pre></td></tr></table></figure><p>代码示例：</p><h1 id="javaweb-jsp-el-jstl"><a href="#javaweb-jsp-el-jstl" class="headerlink" title="javaweb   jsp   el   jstl"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/jsp" target="_blank" rel="noopener">jsp</a>   <a href="https://www.zhangpeng.fun/tags/el" target="_blank" rel="noopener">el</a>   <a href="https://www.zhangpeng.fun/tags/jstl" target="_blank" rel="noopener">jstl</a></h1><h3 id="喜欢这篇文章？打赏一下作者吧"><a href="#喜欢这篇文章？打赏一下作者吧" class="headerlink" title="喜欢这篇文章？打赏一下作者吧"></a>喜欢这篇文章？打赏一下作者吧</h3><p>支付宝捐赠 微信捐赠</p><p><a href="https://www.zhangpeng.fun/archives/09-maven" target="_blank" rel="noopener">09-Maven</a></p><p><a href="https://www.zhangpeng.fun/archives/07-servlet" target="_blank" rel="noopener">07-Servlet</a></p><h3 id="评论"><a href="#评论" class="headerlink" title="评论"></a>评论</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="jsp" scheme="https://zpengit.github.io/tags/jsp/"/>
    
      <category term="el" scheme="https://zpengit.github.io/tags/el/"/>
    
      <category term="jstl" scheme="https://zpengit.github.io/tags/jstl/"/>
    
  </entry>
  
  <entry>
    <title>07-Servlet</title>
    <link href="https://zpengit.github.io/2020/06/11/07-Servlet/"/>
    <id>https://zpengit.github.io/2020/06/11/07-Servlet/</id>
    <published>2020-06-11T10:52:33.166Z</published>
    <updated>2020-06-11T10:45:01.718Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="07-Servlet"><a href="#07-Servlet" class="headerlink" title="07-Servlet"></a>07-Servlet</h1><h1 id="unit07-Servlet"><a href="#unit07-Servlet" class="headerlink" title="unit07-Servlet"></a>unit07-Servlet</h1><h2 id="Servlet概述"><a href="#Servlet概述" class="headerlink" title="Servlet概述"></a>Servlet概述</h2><h3 id="什么是Servlet"><a href="#什么是Servlet" class="headerlink" title="什么是Servlet?"></a>什么是Servlet?</h3><p>Servlet是由SUN公司提供的一门动态Web资源开发技术</p><p>Servlet本质上是一段Java程序，和之前的Java程序不同的是，Servlet程序无法独立运行，需要将Servlet程序放在服务器中（比如tomcat服务器），由服务器调用才可以执行。</p><p>Servlet: 服务器端的Java程序.</p><p>Servlet是运行在服务器端的Java程序，其作用是什么？</p><p>其作用是对服务器接收过来的请求进行处理（作用为处理请求）</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/329ebdac1b25e0943488cf41428e6552-f964411718354eefa88805e4d852a2c2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-807efa250b09ad2859dfe12787a17181.png" alt="329ebdac1b25e0943488cf41428e6552"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/329ebdac1b25e0943488cf41428e6552-f964411718354eefa88805e4d852a2c2.png" target="_blank" rel="noopener">329ebdac1b25e0943488cf41428e6552</a></p><h2 id="开发Servlet程序"><a href="#开发Servlet程序" class="headerlink" title="开发Servlet程序"></a>开发Servlet程序</h2><h3 id="开发Servlet程序的步骤"><a href="#开发Servlet程序的步骤" class="headerlink" title="开发Servlet程序的步骤"></a>开发Servlet程序的步骤</h3><p>第一步: 写一个类，实现一个Servlet接口或者继承Servlet接口的子类（GenericServlet/HttpServlet），并实现其中的方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Servlet接口</span><br><span class="line">|-- GenericServlet类(抽象类)</span><br><span class="line">|-- HttpServlet类</span><br></pre></td></tr></table></figure><p>第二步: 在web应用的web.xml文件中配置Servlet程序对外访问的路径。</p><p>Eclipse在创建一个Servlet时，会在web.xml文件中生成Servlet配置，所以不需要我们手动配置。</p><h3 id="使用Eclipse创建Web项目"><a href="#使用Eclipse创建Web项目" class="headerlink" title="使用Eclipse创建Web项目"></a>使用Eclipse创建Web项目</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/22432d0ee6fe5616365ecb77f5748b37-1b9cb7b3e0104334a772b535f9e21070.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-f572f5d5c2a6695723de5b3b247791d0.png" alt="22432d0ee6fe5616365ecb77f5748b37"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/22432d0ee6fe5616365ecb77f5748b37-1b9cb7b3e0104334a772b535f9e21070.png" target="_blank" rel="noopener">22432d0ee6fe5616365ecb77f5748b37</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/46a097af287c3d455ace4644c98ad27b-3b64c8e9cc14433b96ab71a4294851e6.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-17923ca722a306147b53d5ec832c4f32.png" alt="46a097af287c3d455ace4644c98ad27b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/46a097af287c3d455ace4644c98ad27b-3b64c8e9cc14433b96ab71a4294851e6.png" target="_blank" rel="noopener">46a097af287c3d455ace4644c98ad27b</a></p><p>以上是Web项目在工程视图(Project)和包视图（package）下结构，推荐使用包视图！</p><p><strong>1、创建一个Web工程:</strong> 在左侧窗口中, 点击<strong>鼠标右键</strong> —&gt; <strong>New</strong> —&gt;<br><strong>Dynamic Web Project</strong>。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/22fa5f600a0bdd2206b028c42d7feab3-bad3eb0adbed40c3b52c9fc9626f7dac.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-0f0c8533cee626148ef088525f0d59fe.png" alt="22fa5f600a0bdd2206b028c42d7feab3"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/22fa5f600a0bdd2206b028c42d7feab3-bad3eb0adbed40c3b52c9fc9626f7dac.png" target="_blank" rel="noopener">22fa5f600a0bdd2206b028c42d7feab3</a></p><p><strong>2、接着会弹出如下窗口:</strong></p><p>![创建Web项目](JAVAWEB-<a href="https://www.zhangpeng.fun/upload/2020/06/f534b2420e73dc56b14042eb95c91cc0-04c191c180a149e180f288412e4d95ea.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-adc04b51186c6441922501660c634b39.png" alt="f534b2420e73dc56b14042eb95c91cc0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f534b2420e73dc56b14042eb95c91cc0-04c191c180a149e180f288412e4d95ea.png" target="_blank" rel="noopener">f534b2420e73dc56b14042eb95c91cc0</a></p><p><strong>注意：</strong></p><p>(1) 3.0版本不会创建web.xml文件,<br>并且创建Servlet时也不会在web.xml文件中生成Servlet相关的配置信息, 记得改为2.5。</p><p>(2) Target runtime选项中如果没有可选的服务器，可点击右侧的”New<br>Runtime…”进行配置。</p><p>详细操作步骤在《5.2配置Target runtime（Web项目运行环境）》</p><p><strong>3、Eclipse中创建的Web工程的目录结构：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200219170618551-9dcf6085bf7f4f9f817810e945cfff61.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-975fbadb92e09e21717af2b35a68d5e1.png" alt="image-20200219170618551"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200219170618551-9dcf6085bf7f4f9f817810e945cfff61.png" target="_blank" rel="noopener">image-20200219170618551</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1) day09: 工程名称&#x2F;项目名称</span><br><span class="line">(2) src: 源码目录, 创建的java源文件、配置文件（properties、xml文件等）都可以放在src源码目录下</span><br><span class="line">(3) build&#x2F;classes: 编译文件的输出目录, src源码目录中的文件编译后会输出到classes目录下。</span><br><span class="line">其中的classes目录在发布时会放在WEB-INF目录下，随着项目一起发布到服务器中</span><br><span class="line">(4) WebContent: 就是Web应用的目录，其中可以存放 html、css、js、jsp、图片以及编译后的class文件、jar包、web.xml文件等. 将来发布项目到服务器，其实就是将WebContent中的所有内容一起发布到服务器中。</span><br><span class="line">(5) WebContent&#x2F;WEB-INF&#x2F;lib: 用于存放当前项目所依赖的jar包。比如要访问mysql数据库，需要导入mysql驱动包，直接将jar包拷贝到lib目录下即可！（也不用再去做 build path --&gt; add to build path）</span><br></pre></td></tr></table></figure><h3 id="使用Eclipse创建Servlet"><a href="#使用Eclipse创建Servlet" class="headerlink" title="使用Eclipse创建Servlet"></a>使用Eclipse创建Servlet</h3><p>1、选中项目中的src目录，鼠标右键 —&gt; New —&gt; Servlet</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b363459bbe88da812109f0863d80b552-e2721bcb77dd4300b07b471e82efd5c3.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-0013c7081ea7b392e58430962f4d9bc2.png" alt="b363459bbe88da812109f0863d80b552"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b363459bbe88da812109f0863d80b552-e2721bcb77dd4300b07b471e82efd5c3.png" target="_blank" rel="noopener">b363459bbe88da812109f0863d80b552</a></p><p>2、在弹出的窗口中，根据提示填写内容：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4226a1514a967a42ec6d49e23b725939-0c86f3dd515b4cfe90638c60067a8c12.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-000ccd9bc84b97aed7790668baf520cb.png" alt="4226a1514a967a42ec6d49e23b725939"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4226a1514a967a42ec6d49e23b725939-0c86f3dd515b4cfe90638c60067a8c12.png" target="_blank" rel="noopener">4226a1514a967a42ec6d49e23b725939</a></p><p>3、点击finish即可完成Servlet创建过程, 创建好的Servlet如下:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3d2214e9146db1b26b6038f61c3a8014-ae0a79e472744cdcbeccaddd234e215c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-1992d2943f200d10c6ab911cc04600f0.png" alt="3d2214e9146db1b26b6038f61c3a8014"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3d2214e9146db1b26b6038f61c3a8014-ae0a79e472744cdcbeccaddd234e215c.png" target="_blank" rel="noopener">3d2214e9146db1b26b6038f61c3a8014</a></p><p>通过Eclipse创建Servlet，默认继承HttpServlet。由于HttpServlet也是Servlet接口的子类，让HelloServlet继承HttpServlet，相当于间接实现了Servlet接口。</p><p>继承HttpServlet类，默认会覆盖doGet方法和doPost方法，两个方法的作用为：</p><p>*** doGet方法：**当浏览器发送请求的方式为GET提交时, 将会调用doGet方法来处理请求</p><p>*** doPost方法：**当浏览器发送请求的方式为POST提交时,<br>将会调用doPost方法来处理请求</p><p>提示：如果当GET提交和POST提交处理代码相同时，可以将代码写在其中一个方法里（例如写在doGet中），并在另外一个方法（例如doPost）中调这个方法。这样一来,不管是GET提交还是POST提交,最终doGet方法都会执行,都会对请求进行处理!!</p><h3 id="Servlet在web-xml中的配置"><a href="#Servlet在web-xml中的配置" class="headerlink" title="Servlet在web.xml中的配置"></a>Servlet在web.xml中的配置</h3><p>在通过Eclipse创建Servlet时，会自动在web.xml文件中进行Servlet相关信息的配置</p><p>（注意：如果是复制Servlet类文件，但配置信息不会跟着复制，需要自己手动添加配置，否则复制的Servlet将无法访问！）</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.tedu.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/HelloServlet<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>关于上面的配置信息：</strong></p><p><strong>a)</strong> Eclipse每创建一个Servlet,<br>就会在web.xml文件中添加两个标签：<servlet>和<servlet-mapping>标签（可以将这两个标签看成一个组的标签）</p><p><strong>b)</strong><br><servlet>和<servlet-mapping>标签内都会有一个<servlet-name>标签，标签的内容可以更改，但要求更改后的这两个<servlet-name>标签的内容也必须一致。</p><p><strong>c)</strong> <servlet-class>标签用于配置Servlet类的全路径名(即包名+类名)</p><p>需要注意：如果在创建Servlet后修改了Servlet类的名称，这个地方也要一起更改，否则将会出现”ClassNotFoundException”<br>即类找不到异常</p><p><strong>d)</strong><br><url-pattern>标签用于配置浏览器以什么路径访问当前Servlet（即Servlet对外访问的路径），默认的路径是：/类名</p><p>例如：上面为HelloServlet配置的<url-pattern>为<br><strong>/HelloServlet</strong>，因此我们在浏览器中的访问路径则为：</p><p><a href="http://xn--tiqt5l0ys/web" target="_blank" rel="noopener">http://主机名/web</a>项目访问路径**/HelloServlet**</p><h3 id="运行Servlet程序、访问测试"><a href="#运行Servlet程序、访问测试" class="headerlink" title="运行Servlet程序、访问测试"></a>运行Servlet程序、访问测试</h3><p><strong>1、访问Servlet方式一：</strong></p><p>若是第一次运行，需要先创建tomcat服务器，即在Servers窗口中点击链接可创建一个tomcat服务器，且只需创建一次即可！</p><p>(1)发布项目到服务器：在服务器上右键 –&gt; 点击 “<strong>add and remove”</strong> 将当前web项目发布到服务器中，并点击完成。</p><p>(2)启动tomcat服务器：在服务器上右键 Start 即可启动服务器</p><p>(3)通过浏览器访问Servlet：打开本地浏览器，通过路径访问，即可访问Servlet程序</p><p><code>http://localhost:8080/项目名称/HelloServlet</code></p><p><strong>2、访问Servlet方式二：</strong></p><p><strong>(1) 在运行的Servlet上点击右键 –</strong>-&gt; <strong>“Run As”</strong> —&gt; <strong>“1 Run on Server”</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/329006b7629a8f0b0c9bddfc90fba675-53536761ae5e4f7d907b34e4cc28cbec.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-9443fa750e65f7d6a8e4cabc7188aa33.png" alt="329006b7629a8f0b0c9bddfc90fba675"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/329006b7629a8f0b0c9bddfc90fba675-53536761ae5e4f7d907b34e4cc28cbec.png" target="_blank" rel="noopener">329006b7629a8f0b0c9bddfc90fba675</a></p><p>(2) 在弹出的窗口中，直接点击完成即可！！！</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6340e1bd76974184a91c55595864123b-1e8d1e17b16a426a936d986f54a54740.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-1dfcb44f193229513b7eda1f22456ef7.png" alt="6340e1bd76974184a91c55595864123b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6340e1bd76974184a91c55595864123b-1e8d1e17b16a426a936d986f54a54740.png" target="_blank" rel="noopener">6340e1bd76974184a91c55595864123b</a></p><p>(3) 运行结果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f478e638564b90f44fdd1ef210c11f30-2a3d5087f9c64026bbb063fac5a8c61b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-57cfb0a2937a10c3bfbe650542c68207.png" alt="f478e638564b90f44fdd1ef210c11f30"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/f478e638564b90f44fdd1ef210c11f30-2a3d5087f9c64026bbb063fac5a8c61b.png" target="_blank" rel="noopener">f478e638564b90f44fdd1ef210c11f30</a></p><p>或者打开浏览器，复制上图中的路径：</p><p><a href="http://localhost:8080/Hello/HelloServlet%EF%BC%8C%E7%B2%98%E8%B4%B4%E5%88%B0%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%9C%B0%E5%9D%80%E6%A0%8F%E4%B8%AD%EF%BC%8C%E5%9B%9E%E8%BD%A6%E8%AE%BF%E9%97%AE%EF%BC%9A" target="_blank" rel="noopener">http://localhost:8080/Hello/HelloServlet，粘贴到浏览器的地址栏中，回车访问：</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/12910389bb2a950777329cc3568e8ec7-2dca77be31254d629aa4f07dc0eb1740.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-f51b4860c486c6d04fde5fe3fbe8dc7f.png" alt="12910389bb2a950777329cc3568e8ec7"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/12910389bb2a950777329cc3568e8ec7-2dca77be31254d629aa4f07dc0eb1740.png" target="_blank" rel="noopener">12910389bb2a950777329cc3568e8ec7</a></p><h3 id="Eclipse默认发布Web应用的位置"><a href="#Eclipse默认发布Web应用的位置" class="headerlink" title="Eclipse默认发布Web应用的位置"></a>Eclipse默认发布Web应用的位置</h3><p>Tomcat服务器中默认只有一台虚拟主机,叫做localhost主机</p><p>而localhost主机发布web应用的位置是webapps。</p><p>将day09发布到localhost主机中,但为什么day09项目没有在webapps目录下?</p><p>-——————————————————————————————————-</p><p>默认情况下,发布一个Web应用到localhost主机中，只需要将Web应用的目录拷贝到webapps目录下即可完成发布!</p><p>而将Eclipse和Tomcat整合之后，通过Eclipse发布一个web应用到tomcat服务器中，发布的路径默认被改成了:</p><p>[工作空间]\.metadata\.plugins\org.eclipse.wst.server.core\tmp0\wtpwebapps</p><p><strong>如何修改Eclipse默认发布Web应用的目录位置:</strong></p><p>(1)关闭服务器,将服务器中的所有应用移除</p><p>(2)在服务器上右键 –&gt; clean</p><p>(3)双击tomcat服务器,在弹出窗口中找到 Server location, 选择第二个选项</p><p>并将下方的Deploy Path改为: webapps 改完后，Ctrl+s保存配置即可!!</p><h3 id="Eclipse如何发布一个Web应用"><a href="#Eclipse如何发布一个Web应用" class="headerlink" title="Eclipse如何发布一个Web应用"></a>Eclipse如何发布一个Web应用</h3><p>当通过eclipse将day09项目发布到服务器中,是直接将day09拷贝到服务器中对应的目录下吗?</p><p>发布的过程如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/66b1236906843df1bfc1d002a36a0ea7-7ebdde9fe46d442c9da59b3de916bae9.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-a88df68eddb40967e63c566fc7451fe9.png" alt="66b1236906843df1bfc1d002a36a0ea7"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/66b1236906843df1bfc1d002a36a0ea7-7ebdde9fe46d442c9da59b3de916bae9.png" target="_blank" rel="noopener">66b1236906843df1bfc1d002a36a0ea7</a></p><h2 id="Servlet调用过程"><a href="#Servlet调用过程" class="headerlink" title="Servlet调用过程"></a>Servlet调用过程</h2><p>通过浏览器访问服务器中的一个Servlet程序，这个Servlet程序是如何执行的？又是如何被调用的？</p><p>localhost/Hello/HelloServlet</p><p>参考&lt;&lt;Servlet调用过程图&gt;&gt;</p><h2 id="扩展-修改Servlet模版"><a href="#扩展-修改Servlet模版" class="headerlink" title="扩展:修改Servlet模版"></a>扩展:修改Servlet模版</h2><p>通过Eclipse可以直接创建一个Servlet类，这相比通过记事本等文本编辑工具创建Servlet，可以节省配置Servlet的时间，提高了我们的开发效率。</p><p>但是通过Eclipse生成的Servlet类中包含了许多我们不需要的注释和默认实现代码，这些每次都删除也非常占用时间。</p><p>接下来可以通过添加模版代码的形式，来生成Servlet的内容，以便于提高我们的开发效率。</p><p><strong>1、先创建一个Servlet，将其中的内容修改为自己期望的模版格式，并复制其中的内容，例如：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> $&#123;enclosing_package&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * author: bjzhangsz@tedu.cn</span></span><br><span class="line"><span class="comment"> * datetime: $&#123;date&#125; $&#123;time&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> $</span>&#123;primary_type_name&#125; extends HttpServlet &#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">       </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、点击菜单栏中的window –&gt; Preferences</strong>：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/61ff91aedf878c76b0e51b94ffdca92a-a960f07128a9403eb327f0527a2d3806.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-2fd5822deeeb97fd7ac112de242e35fc.png" alt="61ff91aedf878c76b0e51b94ffdca92a"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/61ff91aedf878c76b0e51b94ffdca92a-a960f07128a9403eb327f0527a2d3806.png" target="_blank" rel="noopener">61ff91aedf878c76b0e51b94ffdca92a</a></p><p><strong>3、在出现的窗口左侧依次点击：Java –&gt; Editor –&gt; templates<br>--&gt;(在右边的窗口中) 点击New… ：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/35b3781ebd2acd7a178db29783dc5a6a-4368c51b7f69471aaa86d3974b69bc0d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-9829655c651b49ea32a47d61ba39134c.png" alt="35b3781ebd2acd7a178db29783dc5a6a"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/35b3781ebd2acd7a178db29783dc5a6a-4368c51b7f69471aaa86d3974b69bc0d.png" target="_blank" rel="noopener">35b3781ebd2acd7a178db29783dc5a6a</a></p><p><strong>4、在出现的新窗口中填写如下内容：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7dcab79636bff53d51b35d449adffebd-8057c04f7b9c41958bdbfb8fcadd5f75.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-8cd10a148213fbcafa3117b662a33729.png" alt="7dcab79636bff53d51b35d449adffebd"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7dcab79636bff53d51b35d449adffebd-8057c04f7b9c41958bdbfb8fcadd5f75.png" target="_blank" rel="noopener">7dcab79636bff53d51b35d449adffebd</a></p><p><strong>5、替换包路径和类名（作用是在新建Servlet生成的Servlet模版中使用当前类的包路径和类型）</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/cfc14076c3b3e9187afa6594a5ba08a8-24eb50edfee64770a568922126ad4162.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-dff1df92e083b59dbfdab17253aab1d8.png" alt="cfc14076c3b3e9187afa6594a5ba08a8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/cfc14076c3b3e9187afa6594a5ba08a8-24eb50edfee64770a568922126ad4162.png" target="_blank" rel="noopener">cfc14076c3b3e9187afa6594a5ba08a8</a></p><p>效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/82d8ec98345ff6e99c7caf7fce40c38f-a34f30a37e5a4323a682e652de6c5d12.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-6b710a9ecf07989021544a7037ca794a.png" alt="82d8ec98345ff6e99c7caf7fce40c38f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/82d8ec98345ff6e99c7caf7fce40c38f-a34f30a37e5a4323a682e652de6c5d12.png" target="_blank" rel="noopener">82d8ec98345ff6e99c7caf7fce40c38f</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3e4ab784b24d0682572a1d92ec58098e-ed1e4e21d24e4e4d8d7ceef01be8a2dd.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-7722bbb501224cdc43430b18c480d416.png" alt="3e4ab784b24d0682572a1d92ec58098e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/3e4ab784b24d0682572a1d92ec58098e-ed1e4e21d24e4e4d8d7ceef01be8a2dd.png" target="_blank" rel="noopener">3e4ab784b24d0682572a1d92ec58098e</a></p><p>效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a7026f1287e078eb5561ff5ff7ff2ebe-a98eb751a3c94a20b3efed4c5e6a3091.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-8663e66338a57724878f2c187a9f8394.png" alt="a7026f1287e078eb5561ff5ff7ff2ebe"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a7026f1287e078eb5561ff5ff7ff2ebe-a98eb751a3c94a20b3efed4c5e6a3091.png" target="_blank" rel="noopener">a7026f1287e078eb5561ff5ff7ff2ebe</a></p><p><strong>6、点击OK保存，创建新的Servlet文件，测试</strong>：</p><p>将Servlet中的所有内容全选删除，并输入”servlet”，接着按 “Alt+ /“<br>提示即可生成自己想要的Servlet模版内容!</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0f1925b9e96b93a6e13e7aa674ec2e35-9e7236f75bec45c0ab5667ff211e7f2b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-9d6d7338a67ae46df4d23ce6ad770a16.png" alt="0f1925b9e96b93a6e13e7aa674ec2e35"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/0f1925b9e96b93a6e13e7aa674ec2e35-9e7236f75bec45c0ab5667ff211e7f2b.png" target="_blank" rel="noopener">0f1925b9e96b93a6e13e7aa674ec2e35</a></p><p>效果如下:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a5ada366c84bcef88e797f7126db4433-e0810f481f4a40f4962ba0e0161a85b7.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-f22d89ffc587b13cb2be603a600db7b6.png" alt="a5ada366c84bcef88e797f7126db4433"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a5ada366c84bcef88e797f7126db4433-e0810f481f4a40f4962ba0e0161a85b7.png" target="_blank" rel="noopener">a5ada366c84bcef88e797f7126db4433</a></p><h2 id="request和response介绍"><a href="#request和response介绍" class="headerlink" title="request和response介绍"></a>request和response介绍</h2><p>request是代表HTTP请求信息的对象，response是代表HTTP响应信息的对象。</p><p>当浏览器发请求访问服务器中的某一个Servlet时，服务器将会调用Servlet中的service方法来处理请求。在调用service方法之前会创建出request和response对象。</p><p>其中request对象中封装了浏览器发送给服务器的请求信息（请求行、请求头、请求实体等），response对象中将会封装服务器要发送给浏览器的响应信息（状态行、响应头、响应实体），在service方法执行完后，服务器再将response中的数据取出，按照HTTP协议的格式发送给浏览器。</p><p>每次浏览器访问服务器，服务器在调用service方法处理请求之前都会创建request和response对象。（即，服务器每次处理请求都会创建request和response对象）</p><p>在请求处理完，响应结束时，服务器会销毁request和response对象。</p><h2 id="request对象"><a href="#request对象" class="headerlink" title="request对象"></a>request对象</h2><h3 id="获取请求参数"><a href="#获取请求参数" class="headerlink" title="获取请求参数"></a>获取请求参数</h3><p><strong>问题1、什么是请求参数？</strong></p><p>所谓的请求参数，就是浏览器发送给服务器的数据（不区分请求方式），例如：通过表单向服务器提交的用户名、密码等，或者在超链接后面通过问号提交的数据，都是请求参数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;day10&#x2F;TestParam?user&#x3D;zhangsan&amp;pwd&#x3D;123&amp;like&#x3D;篮球&amp;like&#x3D;足球</span><br></pre></td></tr></table></figure><p><strong>问题2、如何获取请求参数？</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(1)request.getParameter(String paramName)</span><br><span class="line">-- 根据请求参数的名字获取对应的参数值，返回值是一个字符串；</span><br><span class="line">-- 如果一个参数有多个值，该方法只会返回第一个值。</span><br><span class="line">-- 如果获取的是一个不存在的参数，返回值为null</span><br><span class="line">(2)request.getParameterValues(String paramName)</span><br><span class="line">-- 根据请求参数的名字获取该名字对应的所有参数值组成的数组，返回值是一个字符串数组，其中包含了这个参数名对应的所有参数值</span><br><span class="line">-- 如果获取的是一个不存在的参数，返回值为null</span><br></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.获取请求参数中的用户名(user)</span></span><br><span class="line">String user = request.getParameter(<span class="string">"user"</span>);</span><br><span class="line">System.out.println( <span class="string">"user="</span>+user );</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.获取请求参数中的爱好(like)</span></span><br><span class="line">String[] like = request.getParameterValues( <span class="string">"like"</span> );</span><br><span class="line">System.out.println( <span class="string">"like="</span>+Arrays.toString( like ) );</span><br></pre></td></tr></table></figure><p><strong>问题3、获取请求参数时的中文乱码问题？</strong></p><p>在获取中文的请求参数时，可能会出现乱码问题（和请求方式、tomcat服务器版本有关），具体可以分为以下三种情况：</p><p>（1）如果请求是GET提交，并且tomcat是8.0及以后的版本，GET提交的中文参数，在获取时不会出现乱码问题！（8.0以后的tomcat包括8.0在获取GET提交的中文参数时，已经处理中文乱码问题。）</p><p>（2）如果请求是POST提交，不管是哪个版本的tomcat服务器，在获取中文参数时，都会出现乱码问题。因为tomcat底层在接收POST提交的参数时，默认会使用iso8859-1编码接收，而这个编码中没有中文字符，所以在接收中文参数时，一定会出现中文乱码问题！</p><p>解决方法是：通知服务器在接收POST提交的参数时，使用utf-8编码来接收!</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br></pre></td></tr></table></figure><p>注意：这行代码不会影响GET提交，只对POST提交有效！</p><p>这行代码要放在任何获取参数的代码之前执行！</p><p>（3）如果请求是GET提交，并且tomcat是7.0及以前的版本，GET提交的中文参数，在获取时会出现乱码问题！</p><p>解决方法：在[tomcat安装目录]/ conf/server.xml文件的(修改端口的)Connector标签上，添加一个 URIEncoding=”utf-8” 属性，如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"80"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">redirectPort</span>=<span class="string">"8443"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">URIEncoding</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>同时在[Eclipse]/Servers/[当前tomcat服务器对应的配置目录]/server.xml文件中，在Connector标签上，添加一个 URIEncoding=”utf-8” 属性，同上！</p><h3 id="实现请求转发"><a href="#实现请求转发" class="headerlink" title="实现请求转发"></a>实现请求转发</h3><p>请求转发是服务器内部资源的一种跳转方式，即当浏览器发送请求访问服务器中的某一个资源（A）时，该资源将请求转交给另外一个资源（B）进行处理并且由资源B做出响应的过程，就叫做请求转发。</p><p>请求转发和重定向都是资源的跳转方式，但是跳转的过程有所不同。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200304232156159-8747e37f805240129ebe3ceed345a095.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-663ab0d1b8c024707c7fa05070e94092.png" alt="image-20200304232156159"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200304232156159-8747e37f805240129ebe3ceed345a095.png" target="_blank" rel="noopener">image-20200304232156159</a></p><p><strong>请求转发的特点：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（1）转发是一次请求，一次响应</span><br><span class="line">（2）请求转发前后，浏览器的地址栏地址不会发生变化。（浏览器--访问--&gt; A --转发--&gt; B，地址栏地址始终指向A的地址）</span><br><span class="line">（3）请求转发前后的request对象是同一个（转发前在A中的request和转发到B后，B中的request对象和A中的request对象是同一个。基于这一点，可以通过request从A带数据到B）</span><br><span class="line">（4）请求转发前后的两个资源必须属于同一个Web应用，否则将无法进行转发。（A--转发--&gt;B，A和B必须属于同一个Web应用！）</span><br></pre></td></tr></table></figure><p><strong>请求转发实现:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.getRequestDispatcher(url地址/转发到资源的地址).forward(req, res);</span><br></pre></td></tr></table></figure><p><strong>代码示例：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//从当前Servlet转发到 index.jsp(http://localhost/day10/index.jsp)</span></span><br><span class="line"><span class="comment">//request.getRequestDispatcher("/index.jsp").forward(request, response);</span></span><br><span class="line">request.getRequestDispatcher(<span class="string">"index.jsp"</span>).forward(request, response);</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200221171059404-8b77b5154ad44577b2a9161e40561bbe.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-adc72a02bae2898118bccf91a1ed40fe.png" alt="image-20200221171059404"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200221171059404-8b77b5154ad44577b2a9161e40561bbe.png" target="_blank" rel="noopener">image-20200221171059404</a></p><h3 id="作为域对象使用"><a href="#作为域对象使用" class="headerlink" title="作为域对象使用"></a>作为域对象使用</h3><p>request在实现转发时，通过request.setAttribute方法和request.getAttribute方法带数据到目的地时，就是通过request对象中的map集合带数据，这个request对象上的map集合以及request对象所在的范围即称之为是一个域对象。</p><p>如果一个对象具备可以被访问的范围，通过这个对象上的map集合可以在整个范围内实现数据的共享。这样的对象就叫做域对象。</p><p>在request对象上提供了往域对象(map)中存数据的方法以及取数据的方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request.setAttribute(String attrName, Object attrValue);</span><br><span class="line">-- 往request域中存入一个域属性，属性名（key）只能是字符串,属性值(value)可以是任意类型。</span><br><span class="line">request.getAttribute(String attrName);</span><br><span class="line">-- 根据属性名(key)获取对应的属性值(value)。返回的是一个Object类型的对象。</span><br></pre></td></tr></table></figure><p><strong>request域对象所具备的三大特征:</strong></p><p>**生命周期：**在服务器调用Servlet程序的service方法之前，会创建代表请求的request对象，在请求处理完，响应结束时，会销毁request对象。</p><p>**作用范围：**在一次请求范围内，都可以获取到同一个request对象。</p><p>**主要功能：**和请求转发配合使用，从Servlet带数据到JSP（带数据到目的地）</p><p>**扩展内容：**request对象的getParameter和getAttribute方法有什么区别?</p><ul><li>getParameter()方法是用于获取(从浏览器发送过来的)请求参数的，请求参数不能设置，只能是浏览器发送给服务器，在服务器端再通过getParameter方法获取请求中的参数</li><li>getAttribute()方法是用于从request域中获取域属性时用的，域属性得先存入到域中（即得先通过setAttribute方法将数据存入request域中），再通过getAttribute()方法从域中获取。</li></ul><h3 id="案例-模拟查询所有门店功能"><a href="#案例-模拟查询所有门店功能" class="headerlink" title="案例:模拟查询所有门店功能"></a>案例:模拟查询所有门店功能</h3><p><strong>1、创建一个Servlet程序，用于处理查询所有门店信息请求</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoorListServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse</span></span></span><br><span class="line"><span class="function"><span class="params">response)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        response.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        <span class="comment">//1.模拟查询数据库, 查询所有门店集合</span></span><br><span class="line">        List&lt;String&gt; doorList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        doorList.add(<span class="string">"01, 永和北三环西路店, 010-67676767"</span>);</span><br><span class="line">        doorList.add(<span class="string">"02, 永和西直门店, 010-68976347"</span>);</span><br><span class="line">        doorList.add(<span class="string">"03, 永和东直门店, 010-78397647"</span>);</span><br><span class="line">        doorList.add(<span class="string">"04, 永和北京西店, 010-78764397"</span>);</span><br><span class="line">        doorList.add(<span class="string">"05, 永和天安门店, 010-78769743"</span>);</span><br><span class="line">        <span class="comment">//2.将数据存入request域中</span></span><br><span class="line">        request.setAttribute( <span class="string">"list"</span>, doorList );</span><br><span class="line">        <span class="comment">//3.将请求转发到 door_list.jsp 中, 取出所有门店显示在页面中</span></span><br><span class="line">        request.getRequestDispatcher(<span class="string">"door_list.jsp"</span>)</span><br><span class="line">        .forward(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、创建一个JSP，用于显示所有门店信息</strong></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;显示所有门店信息&lt;/h3&gt;</span><br><span class="line">    &lt;%</span><br><span class="line">        <span class="comment">//获取request域中的门店信息集合</span></span><br><span class="line">        List&lt;String&gt; list =(List&lt;String&gt;)request.getAttribute(<span class="string">"list"</span>);</span><br><span class="line">        <span class="comment">//遍历门店集合, 将门店信息输出在网页上</span></span><br><span class="line">        <span class="keyword">for</span>( String door : list )&#123;</span><br><span class="line">        out.write( door +<span class="string">"&lt;br/&gt;"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    %&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><h2 id="response对象"><a href="#response对象" class="headerlink" title="response对象"></a>response对象</h2><p>response是代表HTTP响应信息的对象。</p><h3 id="向客户端发送数据"><a href="#向客户端发送数据" class="headerlink" title="向客户端发送数据"></a>向客户端发送数据</h3><p>PrintWriter out = response.getWriter();</p><p>由于服务器在通过response获取的流发送数据时，默认使用iso8859-1编码，而这个编码中没有中文字符，所以在通过response获取的流发送中文数据时，会出现乱码问题。</p><p>解决方法是：在响应数据之前，通知服务器使用utf-8发送数据。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  通知服务器在响应数据时,使用utf-8编码</span></span><br><span class="line"><span class="comment"> * 也能通知浏览器使用utf-8接收服务器发送的数据 */</span></span><br><span class="line">response.setContentType( <span class="string">"text/html;charset=utf-8"</span> );</span><br><span class="line">PrintWriter out = response.getWriter();</span><br><span class="line">out.write( <span class="string">"你好"</span> );</span><br></pre></td></tr></table></figure><h3 id="实现重定向"><a href="#实现重定向" class="headerlink" title="实现重定向"></a>实现重定向</h3><p>当浏览器向服务器发请求访问某一个资源A，资源A在响应时通知浏览器需要再进一步请求才能获取到对应的资源，浏览器再次发请求访问服务器中的资源B，最终由资源B响应浏览器要获取的资源，这个过程叫做重定向。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200304232136926-9055888036a44411ba51d9249c3a5e61.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870862-1277161a985e177f7296e41d5f5229e1.png" alt="image-20200304232136926"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200304232136926-9055888036a44411ba51d9249c3a5e61.png" target="_blank" rel="noopener">image-20200304232136926</a></p><p><strong>重定向的特点：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（1）重定向是两次请求、两次响应</span><br><span class="line">（2）重定向前后，浏览器的地址栏地址会发生变化。（因为两次请求都是通过浏览器发起，浏览器知道这个跳转的过程，因此地址栏地址会变化）</span><br><span class="line">（3）重定向前后的request对象不是同一个（因为重定向是两次请求，服务器会根据两次请求创建两个不同的request对象，request对象不是同一个，也就不能在重定向时通过request带数据到目的地。）</span><br><span class="line">（4）重定向前后的两个资源可以是来自不同的web应用，甚至可以是来自不同的服务器。(进行跳转的两个资源之间没有限制)</span><br></pre></td></tr></table></figure><p><strong>实现代码：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response.sendRedirect(所重定向到资源的URL地址);</span><br></pre></td></tr></table></figure><p><strong>代码示例：</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试1: 从当前Servlet（day10/TestRedirect）重定向到day10/index.jsp</span></span><br><span class="line"><span class="comment">// http://localhost/day10/TestRedirect</span></span><br><span class="line"><span class="comment">// http://localhost/day10/index.jsp</span></span><br><span class="line">response.sendRedirect( <span class="string">"http://localhost/day10/index.jsp"</span> );</span><br><span class="line">response.sendRedirect( <span class="string">"/day10/index.jsp"</span> );</span><br><span class="line">response.sendRedirect( <span class="string">"/index.jsp"</span> ); <span class="comment">//错误路径</span></span><br><span class="line">response.sendRedirect( <span class="string">"index.jsp"</span> ); <span class="comment">//正确路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试2: 从当前Servlet重定向到day09/index.jsp</span></span><br><span class="line">response.sendRedirect( <span class="string">"http://localhost/day09/index.jsp"</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试3: 从当前Servlet重定向到百度首页</span></span><br><span class="line">response.sendRedirect( <span class="string">"http://www.baidu.com"</span> );</span><br></pre></td></tr></table></figure><p>总结：什么时候用转发（forward）？什么时候用重定向（redirect）？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1)如果希望跳转前后地址栏地址不会发生变化, 只能使用转发; 如果希望跳转前后地址栏地址会发生变化, 只能使用重定向</span><br><span class="line">(2)如果希望在跳转前后, 能够通过request对象带数据到目的地, 只能使用转发</span><br><span class="line">(3)如果仅仅是做一个跳转,没有其他要求,此时推荐使用转发(转发是一次请求,一次响应,可以减少访问服务器的次数,降低服务器的压力)</span><br></pre></td></tr></table></figure><h1 id="javaweb-servlet"><a href="#javaweb-servlet" class="headerlink" title="javaweb   servlet"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/servlet" target="_blank" rel="noopener">servlet</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="servlet" scheme="https://zpengit.github.io/tags/servlet/"/>
    
  </entry>
  
  <entry>
    <title>06-tomcat、HTTP</title>
    <link href="https://zpengit.github.io/2020/06/11/06-tomcat%E3%80%81HTTP/"/>
    <id>https://zpengit.github.io/2020/06/11/06-tomcat%E3%80%81HTTP/</id>
    <published>2020-06-11T10:52:27.507Z</published>
    <updated>2020-06-11T10:44:48.486Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="06-tomcat、HTTP"><a href="#06-tomcat、HTTP" class="headerlink" title="06-tomcat、HTTP"></a>06-tomcat、HTTP</h1><h1 id="unit06-tomcat、HTTP"><a href="#unit06-tomcat、HTTP" class="headerlink" title="unit06-tomcat、HTTP"></a>unit06-tomcat、HTTP</h1><h2 id="服务器概述"><a href="#服务器概述" class="headerlink" title="服务器概述"></a>服务器概述</h2><h3 id="什么是服务器"><a href="#什么是服务器" class="headerlink" title="什么是服务器?"></a>什么是服务器?</h3><p>服务器：分为服务器硬件 和 服务器软件。在硬件服务器（计算机）上安装了服务器软件，才可以对外提供服务。</p><p>比如：让其他的计算机来访问当前服务器，为其他的计算机提供服务。</p><p>(1) 服务器硬件：是指在互联网上具有独立IP地址的计算机，比如我们自己用的计算机也可以作为服务器使用。</p><p>(2) 服务器软件：就是一个计算机程序，比如MySQL服务器软件，tomcat服务器软件。服务器软件分为很多类型，比如：ftp服务器，数据库服务器，web服务器软件，邮件服务器等。</p><h3 id="什么是Web服务器"><a href="#什么是Web服务器" class="headerlink" title="什么是Web服务器?"></a>什么是Web服务器?</h3><p>(1) web服务器是指驻留在互联网上的某种类型的计算机程序。当浏览器访问服务器，请求服务器上的文件时，服务器将会处理该请求，并将请求的文件响应给浏览器，并会附带一些信息告诉浏览器如何查看该文件（即文件的类型）</p><p>(2) web服务器是可以向 “发出请求的浏览器提供文档” 的程序，比如在访问百度时，其实就是在访问百度的服务器。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/14bcab6ec3d58f3fea59d35a1c618a16-8a5b25279f4d4e29a0a4eff04270a917.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-e967e1c39a1bcb36fad98ec78ef3672b.png" alt="14bcab6ec3d58f3fea59d35a1c618a16"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/14bcab6ec3d58f3fea59d35a1c618a16-8a5b25279f4d4e29a0a4eff04270a917.png" target="_blank" rel="noopener">14bcab6ec3d58f3fea59d35a1c618a16</a></p><p>tomcat就是一个web服务器软件，是由apache组织提供的一款服务器软件，特点：小巧灵活，免费开源，简单易用。</p><h2 id="tomcat下载、安装、启动、配置"><a href="#tomcat下载、安装、启动、配置" class="headerlink" title="tomcat下载、安装、启动、配置"></a>tomcat下载、安装、启动、配置</h2><h3 id="下载tomcat服务器"><a href="#下载tomcat服务器" class="headerlink" title="下载tomcat服务器"></a>下载tomcat服务器</h3><p>下载地址：<a href="http://tomcat.apache.org/" target="_blank" rel="noopener">http://tomcat.apache.org/</a></p><p>tomcat有很多版本，有解压版 和 安装版，还分windows （还分为32位和64位版）和<br>linux版，根据自己的需求，选择对应的版本下载。</p><p>tomcat服务器运行需要jdk的支持，版本对应为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tomcat5 需要jdk4以上支持</span><br><span class="line">tomcat6 需要jdk5以上支持</span><br><span class="line">tomcat7 需要jdk6以上支持</span><br><span class="line">tomcat8 需要jdk7以上支持</span><br></pre></td></tr></table></figure><h3 id="安装、启动tomcat服务器"><a href="#安装、启动tomcat服务器" class="headerlink" title="安装、启动tomcat服务器"></a>安装、启动tomcat服务器</h3><p><strong>1、安装tomcat服务器</strong></p><p>绿色版解压之后就可以使用(原则：安装的路径中不要包含中文和空格)</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/609168f9983f96449b7c33f3ebe1890a-a81bacb2bf0a48fe8983608ae441e6b2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-12085f1690b3fd2e2dca866e486ed9dc.png" alt="609168f9983f96449b7c33f3ebe1890a"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/609168f9983f96449b7c33f3ebe1890a-a81bacb2bf0a48fe8983608ae441e6b2.png" target="_blank" rel="noopener">609168f9983f96449b7c33f3ebe1890a</a></p><p>解压后还需要配置JAVA_HOME环境变量，该变量指向jdk的根目录，指定tomcat启动时使用哪一个位置的jdk。</p><p><strong>2、启动tomcat服务器</strong></p><hr><p><strong>如何配置JAVA_HOME环境变量：</strong></p><p>变量名: JAVA_HOME</p><p>变量值: C:\Program Files\Java\jdk1.8.0_45</p><p>-——————————————————————————-</p><p>（扩展内容）配置Path变量的两种方式：</p><p>方式一：</p><p>Path=**C:\Program Files\Java\jdk1.8.0_45\bin;**xxx;xxx;xxx;</p><p>方式二：</p><p>JAVA_HOME=C:\Program Files\Java\jdk1.8.0_45</p><p>Path=%JAVA_HOME%\bin;xxx;xxx;xxx;</p><p>-——————————————————————————-</p><p><strong>启动、关闭tomcat服务器：</strong></p><p>通过 [tomcat根目录]\bin\startup.bat 可以启动tomcat服务器；</p><p>通过 [tomcat根目录]\bin\shutdown.bat 可以关闭tomcat服务器；</p><p><strong>访问测试服务器：</strong></p><p>在tomcat服务器启动后，服务器会默认监听8080端口，可以通过如下地址访问tomcat服务器的主页：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8080</span><br></pre></td></tr></table></figure><h3 id="修改tomcat默认端口"><a href="#修改tomcat默认端口" class="headerlink" title="修改tomcat默认端口"></a>修改tomcat默认端口</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218164109285-d8522652b8bd492f93d8802709b4872a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-75b24290444aaaf196648d6351003a66.png" alt="image-20200218164109285"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218164109285-d8522652b8bd492f93d8802709b4872a.png" target="_blank" rel="noopener">image-20200218164109285</a></p><p>tomcat服务器在启动时，默认监听的端口是8080，这意味着，我们在访问tomcat服务器时，就需要在主机名（localhost）或者IP地址（127.0.0.1）等后面加上端口。这样非常不方便。</p><p>可以将<code>8080</code>端口改为<code>80</code>端口，因为80端口非常特殊，可以省略不写（只有80端口可以省略，其他端口可在访问时必须得加上）</p><p>修改方法：找到 [tomcat安装目录]\conf\server.xml 文件并打开该文件，将文件中的 69 行的 标签上的 port 属性的值改为 80即可。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"80"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span></span></span><br><span class="line"><span class="tag">           <span class="attr">redirectPort</span>=<span class="string">"8443"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>改完后，保存文件，重新启动服务器（只有在服务器启动时，才会重新加载server.xml文件）再次启动的服务器就会监听新的端口。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218164951343-64e514d1b3de4bc190110a65d602c489.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-a56cb9d82fd61edd36001d2629f5c021.png" alt="image-20200218164951343"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218164951343-64e514d1b3de4bc190110a65d602c489.png" target="_blank" rel="noopener">image-20200218164951343</a></p><p><strong>** 扩展问题：FAQ端口占用问题 **：</strong></p><p>在启动tomcat服务器时，可能会遇到端口占用问题，如下图：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c6008ed65c694512f4b81a2d9fe1877f-428d9cc38bd34b46b12fed33e7c54902.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-f1b6061c34c18f7396e336be85b0977d.png" alt="c6008ed65c694512f4b81a2d9fe1877f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c6008ed65c694512f4b81a2d9fe1877f-428d9cc38bd34b46b12fed33e7c54902.png" target="_blank" rel="noopener">c6008ed65c694512f4b81a2d9fe1877f</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218165319049-d96c5c66c3b5454d98a1666a8f4d1514.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-15f2e9749c38e275db5855571f8afeb4.png" alt="image-20200218165319049"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200218165319049-d96c5c66c3b5454d98a1666a8f4d1514.png" target="_blank" rel="noopener">image-20200218165319049</a></p><p>原因分析:</p><p>**情况一：**可能是之前的tomcat服务器没有完全关闭，仍然在占用80端口，导致服务器再次启动时，启动失败。</p><blockquote><p>解决方式：运行shutdown.bat文件，将tomcat按照正常流程再关闭一次即可。如果再次启动服务器成功，说明问题已解决，否则看情况二。</p></blockquote><p>**情况二：**可能是其他程序占用了80端口，导致服务器启动失败。</p><blockquote><p>解决方式：打开一个cmd窗口，通过 netstat -ano 命令查看当前系统中活动的进程，找到80端口对应的进程编号（PID），根据进程编号将进程结束即可！</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">协议  本地地址         外部地址        状态           PID</span><br><span class="line">TCP  0.0.0.0:80      0.0.0.0:0      LISTENING     6520</span><br><span class="line">TCP  0.0.0.0:135     0.0.0.0:0      LISTENING     448</span><br><span class="line">...</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill &#x2F;f &#x2F;pid 进程编号</span><br></pre></td></tr></table></figure><h2 id="tomcat目录结构"><a href="#tomcat目录结构" class="headerlink" title="tomcat目录结构"></a>tomcat目录结构</h2><p>tomcat目录结构介绍</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/af86c51c1b50075b001b791487750003-b97d45949f45447795b71d68be4b7c45.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-00424fb147e8dc1ebadecabe8efac138.png" alt="af86c51c1b50075b001b791487750003"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/af86c51c1b50075b001b791487750003-b97d45949f45447795b71d68be4b7c45.png" target="_blank" rel="noopener">af86c51c1b50075b001b791487750003</a></p><p>tomcat服务器安装根目录下有很多子目录，这些目录的作用是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bin：用于存放tomcat服务器中批处理文件的目录(xx.bat&#x2F;xx.sh)</span><br><span class="line">conf：用于存放tomcat服务器中的配置文件的目录(其中server.xml文件是tomcat服务器中非常重要的一个文件。)</span><br><span class="line">lib：用于存放tomcat服务器运行时所依赖的jar包。</span><br><span class="line">logs：用于存放tomcat服务器运行时产生的日志文件(启动tomcat服务器时会打印很多日志信息,这些日志信息还会以文件形式保存到logs目录下)</span><br><span class="line">temp：用于存放tomcat服务器产生的临时文件，tomcat会自己清理，可以忽略该目录</span><br><span class="line">webapps：是localhost【虚拟主机】默认管理的目录，将开发好的【web应用】程序放在webapps目录下，就可以通过浏览器访问localhost主机中的Web资源文件了。</span><br><span class="line">可以简单的理解为：webapps目录就是web资源（html、css、js、图片、jsp等）的存放目录，将web资源文件放在该目录下，就可以通过浏览器来访问。</span><br><span class="line"></span><br><span class="line">work：用于存放tomcat服务器产生的工作文件（JSP翻译后的Servlet文件会放在work目录下；session对象序列化后产生的文件也会放在work目录下；）</span><br></pre></td></tr></table></figure><h2 id="虚拟主机和Web应用"><a href="#虚拟主机和Web应用" class="headerlink" title="虚拟主机和Web应用"></a>虚拟主机和Web应用</h2><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200328095145558-ad7280a7401b4cdb94a03f79fc9c0855.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-aaf2cd7dde386c96c48b24a29e578f9f.png" alt="image-20200328095145558"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200328095145558-ad7280a7401b4cdb94a03f79fc9c0855.png" target="_blank" rel="noopener">image-20200328095145558</a></p><p>总结：</p><p>（1）虚拟主机就是tomcat服务器中配置的一个站点，在tomcat服务器中默认提供了一个localhost虚拟主机，这个主机的发布目录是webapps目录，这样意味着，将Web应用放在webapps目录下，就表示发不到了localhost虚拟主机中。</p><p>（2）Web应用就是一个存放了很多Web资源（html、css、js、jsp、servlet、图片等）的目录，将Web应用发布到虚拟主机中，就可以通过浏览器来访问Web资源中的资源文件了。</p><h2 id="web应用"><a href="#web应用" class="headerlink" title="web应用"></a>web应用</h2><h3 id="web应用的目录结构"><a href="#web应用的目录结构" class="headerlink" title="web应用的目录结构"></a>web应用的目录结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">news(目录,web应用)</span><br><span class="line">  |-- 其他目录, 放在news根目录或者其他目录中的资源文件,浏览器可以直接访问</span><br><span class="line">  |-- WEB-INF目录, 放在这个目录下的资源文件是受保护的,浏览器不能直接访问(不是不能访问,是不能直接访问) </span><br><span class="line">   |-- classes目录, 用于存放编译后的class文件</span><br><span class="line">   |-- lib目录, 用于存放web应用所依赖的jar包</span><br><span class="line">   |-- web.xml文件, 用于存放和web应用相关的一些配置（配置Servlet、配置主页、配置session的超时时间等）</span><br></pre></td></tr></table></figure><p>其中news就是一个目录, 同时也是一个web应用程序, 其中可以包含很多的资源文件。</p><h3 id="部署web应用到虚拟主机中"><a href="#部署web应用到虚拟主机中" class="headerlink" title="部署web应用到虚拟主机中"></a>部署web应用到虚拟主机中</h3><p>直接将Web应用的目录拷贝到虚拟主机所管理的目录下，就发布到了虚拟主机中</p><p>例如：将news目录拷贝webapps目录下，由于webapps目录是localhost主机默认管理的目录，所以就相当于将news应用发布到 了localhost主机中。</p><p>通过如下路径规则就可以访问localhost主机下的news应用下的资源文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:端口&#x2F;news&#x2F;xxx</span><br></pre></td></tr></table></figure><h2 id="扩展内容（了解）"><a href="#扩展内容（了解）" class="headerlink" title="扩展内容（了解）"></a>扩展内容（了解）</h2><p>访问tomcat服务器主页：<a href="http://localhost/" target="_blank" rel="noopener">http://localhost</a></p><p>访问news/hello.html：<a href="http://localhost/news/hello.html" target="_blank" rel="noopener">http://localhost/news/hello.html</a></p><p>能否将访问 news/hello.html 的路径缩短一些（比如只通过主机名就可以访问news/hello.html这个网页）</p><h3 id="配置WEB应用的主页"><a href="#配置WEB应用的主页" class="headerlink" title="配置WEB应用的主页"></a>配置WEB应用的主页</h3><p>如果没有将 hello.html 配置为当前Web应用的主页，在访问 hello.html 时的路径为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;news&#x2F;hello.html</span><br></pre></td></tr></table></figure><p>如果将 hello.html 配置为当前Web应用的主页，再次访问 hello.html 时的路径为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;news</span><br></pre></td></tr></table></figure><p>在上的路径中，/hello.html 这个路径可以加，也可以省略。</p><p>将 hello.html 配置为当前应用的主页，方式为：找到 [当前Web应用]/WEB-INF/web.xml文件并打开，在web.xml文件的根标签内部添加如下配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee</span></span></span><br><span class="line"><span class="tag"><span class="string">                      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">version</span>=<span class="string">"3.1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/hello.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/hello1.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">welcome-file</span>&gt;</span>/hello2.html<span class="tag">&lt;/<span class="name">welcome-file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">welcome-file-list</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure><p>配置完后，需要重启服务器，配置才会生效。</p><h3 id="配置缺省的-默认的-WEB应用"><a href="#配置缺省的-默认的-WEB应用" class="headerlink" title="配置缺省的(默认的)WEB应用"></a>配置缺省的(默认的)WEB应用</h3><p>上面已经将news/hello.html配置为news应用的主页，访问hello.html时路径为：<a href="http://localhost/news/" target="_blank" rel="noopener">http://localhost/news/</a></p><p>如果不将 news 应用配置为默认的Web应用，在访问 news 下的 hello.html(主页)时的访问路径为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;news&#x2F;</span><br></pre></td></tr></table></figure><p>如果将 news 应用配置为缺省的（默认的）Web应用，在访问 hello.html(主页)时的路径就变成了：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost&#x2F;</span><br></pre></td></tr></table></figure><p>如何将 news 配置为缺省的（默认的）Web应用（缺省Web应用只能有一个）？：</p><p><strong>将Web应用的名字改为一个大写的ROOT</strong>，当前Web应用就是一个默认的Web应用，再访问这个Web应用下的资源文件时，访问的路径中就可以不用写Web应用的名称了。</p><h3 id="打war包"><a href="#打war包" class="headerlink" title="打war包"></a>打war包</h3><p>war包和jar包都是java程序中的一种压缩包格式，如果开发一个Java基础工程，可以将其中编译后的class文件和相关的配置文件打成一个jar包。</p><p>可以将一个Web应用打成一个war包，这样做的好处有：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(1) 将web应用打成一个war包，传输起来更加方便，而且文件体积会变小。</span><br><span class="line">(2) 将war包发布到服务器中，服务器能识别war包格式，会自动将war包解压发布！</span><br></pre></td></tr></table></figure><p><strong>打war包的方法是：</strong></p><p>进入到web应用的目录下，将Web应用目录下的所有子目录和文件全部选中，右键压缩成一个 xxx.zip 包，再把 xxx.zip 改为 xxx.war即可!!</p><p>需要注意的是，如果有以下问题，可能会导致war不会自动解压：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1) 在将Web应用打成一个压缩包时，没有打成一个 xxx.zip，而是使用 rar格式或者其他格式,会导致自动解压失败!</span><br><span class="line">(2) 打成的war包的名字 和 已发布的web应用的名字不能冲突,会导致自动解压失败!</span><br><span class="line">(3) war包中包含的目录名和文件名是中文的,也会导致自动解压失败!</span><br></pre></td></tr></table></figure><h2 id="HTTP协议概述"><a href="#HTTP协议概述" class="headerlink" title="HTTP协议概述"></a>HTTP协议概述</h2><h3 id="什么是HTTP协议"><a href="#什么是HTTP协议" class="headerlink" title="什么是HTTP协议?"></a>什么是HTTP协议?</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/14bcab6ec3d58f3fea59d35a1c618a16-8a5b25279f4d4e29a0a4eff04270a917.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-e967e1c39a1bcb36fad98ec78ef3672b.png" alt="14bcab6ec3d58f3fea59d35a1c618a16"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/14bcab6ec3d58f3fea59d35a1c618a16-8a5b25279f4d4e29a0a4eff04270a917.png" target="_blank" rel="noopener">14bcab6ec3d58f3fea59d35a1c618a16</a></p><p>HTTP协议是用于规定浏览器和服务器之间的通信方式/规则</p><p>主要规定了浏览器给服务器发送的请求信息的格式</p><p>以及规定了服务器给浏览器发送响应信息的格式</p><p>HTTP协议在工作时所遵循的基本原则：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）一次请求，只对应一次响应</span><br><span class="line">（2）请求只能由浏览器发起，服务器只能被动的等待请求，根据请求作出回应。</span><br></pre></td></tr></table></figure><h2 id="HTTP协议详解"><a href="#HTTP协议详解" class="headerlink" title="HTTP协议详解"></a>HTTP协议详解</h2><p>IE浏览器的插件：HttpWatch，可以监听浏览器和服务器通信的内容。</p><h3 id="HTTP请求"><a href="#HTTP请求" class="headerlink" title="HTTP请求"></a>HTTP请求</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/169364c50b950ea4df4647e274a7298d-808cfabfef514ca386a51afcf5b59bec.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-65df22ba71d31f95eaf8555566646c88.png" alt="169364c50b950ea4df4647e274a7298d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/169364c50b950ea4df4647e274a7298d-808cfabfef514ca386a51afcf5b59bec.png" target="_blank" rel="noopener">169364c50b950ea4df4647e274a7298d</a></p><p><strong>1、请求行</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET  &#x2F;news&#x2F;hello.html  HTTP&#x2F;1.1</span><br></pre></td></tr></table></figure><p>（1）GET：表示请求方式，在HTTP协议中一共定义了7种提交方式，但是我们只用GET和POST。</p><p>（2）/news/hello.html：请求资源路径，表示浏览器请求的是哪一个Web应用以及哪一个web资源文件。</p><p>（3）HTTP/1.1：请求所遵循的协议和版本。</p><p><strong>2、若干请求头</strong></p><p>请求头都是Key-Value结构,例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200219143453111-e6c22e0eed8048cf8ee95463afcb217f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-aa482dd22a885e6dcb28cfa144e50196.png" alt="image-20200219143453111"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200219143453111-e6c22e0eed8048cf8ee95463afcb217f.png" target="_blank" rel="noopener">image-20200219143453111</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Host：localhost -- 通知服务器，浏览器要请求的是哪一台虚拟主机。</span><br><span class="line">Accept：text&#x2F;html, appliaction&#x2F;xhtml+xml,...  -- 通知服务器，浏览器能接收的响应数据类型。</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>（空白行，用于分隔请求头和请求实体）</p><p><strong>3、请求实体内容</strong></p><p>如果请求方式为 GET 提交，请求实体是没有内容的！</p><p>如果请求方式为 POST 提交，并且请求中携带了数据，请求实体中才会有内容！</p><h3 id="HTTP响应"><a href="#HTTP响应" class="headerlink" title="HTTP响应"></a>HTTP响应</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/08e49b1b985988b040fe437d4aab7e62-364817632b19431ea8498e2858a8213c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-b768924a62e780c29d8ff2b70e61db27.png" alt="08e49b1b985988b040fe437d4aab7e62"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/08e49b1b985988b040fe437d4aab7e62-364817632b19431ea8498e2858a8213c.png" target="_blank" rel="noopener">08e49b1b985988b040fe437d4aab7e62</a></p><p><strong>1、状态行</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br></pre></td></tr></table></figure><p>（1）HTTP/1.1：表示响应所遵循的协议和版本</p><p>（2）200：状态码，三位的数字，表示服务器对请求处理的结果。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">200: 表示请求处理成功</span><br><span class="line">302: 表示请求重定向(即需要再进一步请求才可以获取到相应的资源)</span><br><span class="line">304&#x2F;307: 表示通知浏览器使用缓存</span><br><span class="line">404: 表示浏览器请求的资源不存在(浏览器的问题, 请求路径错误)</span><br><span class="line">500: 表示服务器在处理请求的过程中抛出了异常。</span><br></pre></td></tr></table></figure><p>（3）OK：描述短语（可以忽略），也表示服务器对请求处理的结果，和状态码表示的结果一致。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">200：OK</span><br><span class="line">404：Not Found</span><br><span class="line">500: Internal Server Error</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>2、若干响应头</strong>：也是key-value格式</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Content-Type: 表示服务器响应的数据类型，text&#x2F;html,  image&#x2F;*...</span><br><span class="line">Content-Length: 表示服务器响应数据的长度, 例如: 384 &#x2F;字节</span><br><span class="line">Set-Cookie: 和cookie技术相关的一个头, 后面会提到。</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>3、响应实体内容</strong></p><p>响应实体就是浏览器所请求文件的内容。例如：浏览器向服务器请求一个hello.html文件，服务器会找到hello.html文件，将文件的内容作为响应实体发送给浏览器。</p><h3 id="内容补充"><a href="#内容补充" class="headerlink" title="内容补充"></a>内容补充</h3><p><strong>1、问题1：请求方式什么时候是GET提交？什么时候是POST提交？</strong></p><p>只有当使用表单（form），并且在表单上明确的通过method指定提交方式为POST时，请求方式才是POST提交，其他方式都是GET提交（AJAX除外）</p><p><strong>思考：判断以下请求方式是GET还是POST?</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1)&lt;form action&#x3D;&quot;#&quot;&gt;&lt;&#x2F;form&gt;--- GET提交</span><br><span class="line">(2)&lt;form action&#x3D;&quot;#&quot; method&#x3D;&quot;GET&quot;&gt;&lt;&#x2F;form&gt;--- GET提交</span><br><span class="line">(3)&lt;form action&#x3D;&quot;#&quot; method&#x3D;&quot;POST&quot;&gt;&lt;&#x2F;form&gt;--- POST提交</span><br><span class="line">(4)点击超链接访问服务器，例如：</span><br><span class="line">&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.baidu.com&quot;&gt;百度一下&lt;&#x2F;a&gt;--- GET提交</span><br><span class="line">(5)直接在浏览器的地址栏中书写URL地址访问服务器--- GET提交</span><br></pre></td></tr></table></figure><p><strong>2、问题2：GET提交和POST提交有什么区别？</strong></p><p>主要体现在请求参数传输过程的不相同</p><p>GET提交：</p><ul><li>将数据通过问号拼接在地址栏URL地址的后面，相对非常不安全。</li><li>将数据拼接在地址栏URL地址的后面，数据量是有限制的，通常不能超过1KB或者4KB。</li></ul><p>POST提交：（form）</p><ul><li>POST提交是通过请求实体将数据提交给服务器，不会显示在地址栏上，因此相对更加安全。</li><li>POST提交通过请求实体提交数据，数据量理论上是没有限制的。</li></ul><p><strong>3、总结：</strong></p><ul><li>如果只是单纯做一个跳转，请求中没有数据，尽量使用GET提交。</li><li>如果在请求中有数据，但数据量不大，并且数据没有隐私性，也尽量使用GET提交。</li><li>如果在请求中有数据，数据量比较大或者数据较为隐私，此时推荐使用POST提交。</li></ul><h2 id="将Tomcat整合到Eclipse中"><a href="#将Tomcat整合到Eclipse中" class="headerlink" title="将Tomcat整合到Eclipse中"></a>将Tomcat整合到Eclipse中</h2><p>将Tomcat服务器整合到Eclipse工具中，可以通过Eclipse启动、关闭tomcat服务器，更重要的是，可以非常方便的将在Eclipse中创建的Web项目发布到Tomcat服务器中运行。</p><h3 id="方式一：在window偏好设置中配置Tomcat"><a href="#方式一：在window偏好设置中配置Tomcat" class="headerlink" title="方式一：在window偏好设置中配置Tomcat"></a>方式一：在window偏好设置中配置Tomcat</h3><p>1、点击Window –&gt; Preferences(偏好设置):</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184907773-c068f75e117b452e96eacdda3629290b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-33d99beadbe4e2bd83eaa817be08d928.png" alt="image-20200311184907773"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184907773-c068f75e117b452e96eacdda3629290b.png" target="_blank" rel="noopener">image-20200311184907773</a></p><p>2、在偏好设置窗口中点击 Server –&gt; Runtime Environments –&gt; add:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184913436-efcc98f4a38b4540be01b86a52ef8a3a.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-3085434e0e2f84d7c2d79f925bb0083b.png" alt="image-20200311184913436"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184913436-efcc98f4a38b4540be01b86a52ef8a3a.png" target="_blank" rel="noopener">image-20200311184913436</a></p><p>3、在弹出的窗口中选择 –&gt; Apache –&gt; Apache Tomcat v8.5，需要注意的是，这里得根据自己安装的tomcat版本进行选择，比如我安装是8.5版本的tomcat，所以这里选择Apache Tomcat v8.5。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184921087-a96d03ec4d474e03b5fd86e8517cb2ed.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-29e56e2b3ba174cc0dff1e2ce3327b08.png" alt="image-20200311184921087"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184921087-a96d03ec4d474e03b5fd86e8517cb2ed.png" target="_blank" rel="noopener">image-20200311184921087</a></p><p>4、在下面的窗口中配置tomcat服务器的安装根目录，可以直接把路径复制到第二个输入框中；也可以点击后面的 Browse按钮在文件管理器中选择tomcat服务器安装根目录。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184932405-f372a9ec30174fe19950188f1e87a40b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-1eff52cf1f2eff60e277a97a7c758762.png" alt="image-20200311184932405"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184932405-f372a9ec30174fe19950188f1e87a40b.png" target="_blank" rel="noopener">image-20200311184932405</a></p><p>最后点击finish即可完成将Tomcat整合到Eclipse中的配置。</p><h3 id="方式二：在创建Web项目时配置Tomcat"><a href="#方式二：在创建Web项目时配置Tomcat" class="headerlink" title="方式二：在创建Web项目时配置Tomcat"></a>方式二：在创建Web项目时配置Tomcat</h3><p>1、如果在创建Web项目时，Target runtime选项中没有配置可选的服务器，可以点击右面的选项进行配置</p><p>点击后进入下一步操作。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184950046-d4f074a8f9df4014b1cc242e93f8bf0f.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-5cdd343b130239fb7eccacd5c8b55bd7.png" alt="image-20200311184950046"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311184950046-d4f074a8f9df4014b1cc242e93f8bf0f.png" target="_blank" rel="noopener">image-20200311184950046</a></p><p>2、在弹出的窗口中选择 –&gt; Apache –&gt; Apache Tomcat v8.5，需要注意的是，这里得根据自己安装的tomcat版本进行选择，比如我安装是8.5版本的tomcat，所以这里选择Apache Tomcat v8.5。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185003036-6aad122dd03941f3a2eff0a732a15ff2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-bc3360238f05f4f0032170d31a58ba40.png" alt="image-20200311185003036"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185003036-6aad122dd03941f3a2eff0a732a15ff2.png" target="_blank" rel="noopener">image-20200311185003036</a></p><p>3、在下面的窗口中配置tomcat服务器的安装根目录，可以直接把路径复制到第二个输入框中；也可以点击后面的 Browse按钮在文件管理器中选择tomcat服务器安装根目录。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185013454-a249195912554ead9a0dbbc0dda8f636.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-651a82b55796779593a3b1a367a439e8.png" alt="image-20200311185013454"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185013454-a249195912554ead9a0dbbc0dda8f636.png" target="_blank" rel="noopener">image-20200311185013454</a></p><p>最后点击finish即可完成将Tomcat整合到Eclipse中的配置。</p><p>4、上一步完成后，回到Web项目创建的视图窗口，再查看”Target runtime”选项，如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185028965-c67fb892887348bfbe14aa6455aae23e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-98fad052a1f2266ce673bb6613d5abea.png" alt="image-20200311185028965"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185028965-c67fb892887348bfbe14aa6455aae23e.png" target="_blank" rel="noopener">image-20200311185028965</a></p><h3 id="将整合到Eclipse中的tomcat从Eclipse中删除"><a href="#将整合到Eclipse中的tomcat从Eclipse中删除" class="headerlink" title="将整合到Eclipse中的tomcat从Eclipse中删除"></a>将整合到Eclipse中的tomcat从Eclipse中删除</h3><p>如果要将整合到Eclipse中的tomcat从Eclipse删除：点击Windows –&gt; Preferences –&gt; Server –&gt; Runtime Environments，选中要删除的服务器，点击右侧的删除按钮即可删除，最后点击Apply and Close保存设置即可！</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185037713-8f23f4070ceb406f97699b50c9016b07.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-0da77b21e4ca2ecdd1e9539aff12634e.png" alt="image-20200311185037713"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200311185037713-8f23f4070ceb406f97699b50c9016b07.png" target="_blank" rel="noopener">image-20200311185037713</a></p><h3 id="在Eclipse中创建Server及移除Server"><a href="#在Eclipse中创建Server及移除Server" class="headerlink" title="在Eclipse中创建Server及移除Server"></a>在Eclipse中创建Server及移除Server</h3><p>上面讲解了如何将Tomcat整合到Eclipse中，整合之后，需要在Eclipse中创建一个Server才可以进行启动tomcat、关闭tomcat等操作。</p><p>1、Eclipse中找到Servers窗口：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/53ee068642a0174e038b8d61fe0791e8-15fab5c3242e486389fe2048d5ec5e00.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-7273efca193ac912d12ca67bc82940e8.png" alt="53ee068642a0174e038b8d61fe0791e8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/53ee068642a0174e038b8d61fe0791e8-15fab5c3242e486389fe2048d5ec5e00.png" target="_blank" rel="noopener">53ee068642a0174e038b8d61fe0791e8</a></p><p>2、如果没有可以到Window –&gt; Show View –&gt; Other中搜索”servers”，如下图:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4c3f46765ddae7d3cac4287efe14fa6e-69e222c9ff48445ebeda58bc97e1e8e5.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-0448735b945dc1d7c5d7d22c80f159f3.png" alt="4c3f46765ddae7d3cac4287efe14fa6e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4c3f46765ddae7d3cac4287efe14fa6e-69e222c9ff48445ebeda58bc97e1e8e5.png" target="_blank" rel="noopener">4c3f46765ddae7d3cac4287efe14fa6e</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/cf2948fcf3af5900fc2b70f8769e9b05-815e4a1603514b5da570b985fde82a58.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-e854b4ab5e577a8cea26651af679a26b.png" alt="cf2948fcf3af5900fc2b70f8769e9b05"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/cf2948fcf3af5900fc2b70f8769e9b05-815e4a1603514b5da570b985fde82a58.png" target="_blank" rel="noopener">cf2948fcf3af5900fc2b70f8769e9b05</a></p><p>3、在Server窗口中点击“No servers are available…”链接：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ba09d4090bccbc59c3d1057bcab8d07d-673d8cb391264bd59bb01238e0391722.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-1cca5c521038ed45ec3e564746dc9596.png" alt="ba09d4090bccbc59c3d1057bcab8d07d"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ba09d4090bccbc59c3d1057bcab8d07d-673d8cb391264bd59bb01238e0391722.png" target="_blank" rel="noopener">ba09d4090bccbc59c3d1057bcab8d07d</a></p><p>4、在弹出的窗口中，保持默认配置，直接点击完成</p><p>如果弹出的窗口中默认的服务器不是tomcat，则说明在此之前没有将Tomcat整合到Eclipse中。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/08e1747f402c1be68ae9cf62ee7719e0-61c84d2c21064e8382518164daa5943b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-7044d4c4d201212f2e9316955ff257d8.png" alt="08e1747f402c1be68ae9cf62ee7719e0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/08e1747f402c1be68ae9cf62ee7719e0-61c84d2c21064e8382518164daa5943b.png" target="_blank" rel="noopener">08e1747f402c1be68ae9cf62ee7719e0</a></p><p>5、在上一步点完成后，Eclipses左侧会多出一个Servers项目，Servers窗口中会出现创建的Server，也就是tomcat服务器。</p><p>注意：①处的Servers项目不能关闭（close），更不能删除（delete）</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/dfd52724dc14ed43f7c48ca16ac85da4-426cb96dad9a4630b963ad781f445ef4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-8ac5ce091b3ed554c8c204833d438563.png" alt="dfd52724dc14ed43f7c48ca16ac85da4"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/dfd52724dc14ed43f7c48ca16ac85da4-426cb96dad9a4630b963ad781f445ef4.png" target="_blank" rel="noopener">dfd52724dc14ed43f7c48ca16ac85da4</a></p><p>6、在创建完Server后，双击tomcat，可以修改Tomcat服务器配置</p><p>(1)将Server Locations中的选项切换为第二个选项</p><p>(2)将Deploy Path右侧的输入框中的内容改为webapps。ctrl+s保存配置即可</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200328164951699-9d3014ff11e84ed7bf347805f43c9440.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-cd3d3aa2535f802c2ce880db3a378125.png" alt="image-20200328164951699"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200328164951699-9d3014ff11e84ed7bf347805f43c9440.png" target="_blank" rel="noopener">image-20200328164951699</a></p><p>以上配置是为了保证在Eclipse中发布Web应用到tomcat服务器中时，可以将项目发布到tomcat服务器的webapps目录下。</p><p>如果不配置，会导致tomcat服务器中webapps下的Web应用无法访问。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/28b8712f4f5114a24acde35017275a93-f7e18dcf2d8244c4bdfa2421f648163b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-8f41c7b847d1f53f73a7afc7e04d51c6.png" alt="28b8712f4f5114a24acde35017275a93"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/28b8712f4f5114a24acde35017275a93-f7e18dcf2d8244c4bdfa2421f648163b.png" target="_blank" rel="noopener">28b8712f4f5114a24acde35017275a93</a></p><p>7、如果要移除添加的Server，需要同时删除①处的Servers项目（右键delete，要彻底从硬盘上删除），以及删除②处的tomcat服务器（右键delete）</p><p><a href="file:///C:/Users/zhangsz/Desktop/media/dfd52724dc14ed43f7c48ca16ac85da4.png"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-ea14d98ed2b80ac2593fb1a77f193aa5.png" alt=""></a></p><h3 id="tomcat右键选项介绍"><a href="#tomcat右键选项介绍" class="headerlink" title="tomcat右键选项介绍"></a>tomcat右键选项介绍</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/1eec7770246693752b0eaa984ca7e92c-1584273824888-75751560e3e74ca8944a28d988efcfeb.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-fad667a8f8880123d7db41692fd54854.png" alt="1eec7770246693752b0eaa984ca7e92c-1584273824888"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1eec7770246693752b0eaa984ca7e92c-1584273824888-75751560e3e74ca8944a28d988efcfeb.png" target="_blank" rel="noopener">1eec7770246693752b0eaa984ca7e92c-1584273824888</a></p><p>a) Start：用于启动tomcat服务器，如果已启动，则显示 ReStart，作用是重启服务器</p><p>b) Stop：用于停止服务器</p><p>c) Add and Remove：将Web应用部署到tomcat服务器中，或者移除服务器中部署的Web应用</p><p>d) Clean：作用是将发布到Eclipse自己的webapps目录中的项目删除再重新部署</p><p>e) Clean Tomcat Work Directory：作用是将在tomcat运行过程中存入work目录的文件删除</p><h3 id="tomcat启动失败常见原因"><a href="#tomcat启动失败常见原因" class="headerlink" title="tomcat启动失败常见原因"></a>tomcat启动失败常见原因</h3><p><strong>问题1：tomcat服务器启动失败-1</strong></p><p>如果在启动服务器时，服务器启动失败，并弹出窗口显示如下异常信息：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/25c037cb7399daf7127195a451115c07-1584273824889-50d107a30e4e4a78a904456bf8a511b7.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-29719217619a9c0b37efb754177dd69a.png" alt="25c037cb7399daf7127195a451115c07-1584273824889"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/25c037cb7399daf7127195a451115c07-1584273824889-50d107a30e4e4a78a904456bf8a511b7.png" target="_blank" rel="noopener">25c037cb7399daf7127195a451115c07-1584273824889</a></p><p>根据上面的描述信息，可以看出是8005、8080、8009端口被同时占用了，此时只有一种可能，就是之前已经启动了tomcat或者之前开启的tomcat没有完全关闭导致的。</p><p>解决方式：到tomcat安装目录找到bin目录中的shutdown.bat文件，双击运行将服务器关闭，再到Eclipse中启动服务器即可！</p><p><strong>问题2：tomcat服务器启动失败-2</strong></p><p>如果在启动服务器时，服务器启动失败，并弹出窗口显示如下异常信息：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d4e3c02075eb7f39ac1ea72e31aab137-1584273824889-de964102d6cd42ed813fef227bd04270.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870809-9bcd99b737ebc8d341fe8145232c0598.png" alt="d4e3c02075eb7f39ac1ea72e31aab137-1584273824889"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d4e3c02075eb7f39ac1ea72e31aab137-1584273824889-de964102d6cd42ed813fef227bd04270.png" target="_blank" rel="noopener">d4e3c02075eb7f39ac1ea72e31aab137-1584273824889</a></p><p><strong>解决方法：</strong></p><p>(1) 可以先将服务器中所有的Web应用移除（在服务器上右键，<strong>Add and Remove</strong>--&gt;<strong>Remove All</strong>--&gt;<strong>Finish</strong>）</p><p>(2) 再分别执行服务器右键选项中的<strong>clean</strong>和<strong>Clean Tomcat Work Directory</strong></p><p>(3)再次启动服务器，如果启动没有报错，则说明tomcat服务器本身没有问题，再将要运行的项目发布到tomcat中，再次启动服务器，观察是否有错误。如果有则说明是项目本身的问题。</p><p>(4)如果移除了所有的Web应用，启动tomcat服务器报错，则说明tomcat本身就有问题，可以将tomcat服务器重新配置一次到Eclipse中(将tomcat和Server项目删除，再点击链接重新创建Server)</p><h1 id="javaweb-tomcat-http"><a href="#javaweb-tomcat-http" class="headerlink" title="javaweb   tomcat   http"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/tomcat" target="_blank" rel="noopener">tomcat</a>   <a href="https://www.zhangpeng.fun/tags/http" target="_blank" rel="noopener">http</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="http" scheme="https://zpengit.github.io/tags/http/"/>
    
      <category term="tomcat" scheme="https://zpengit.github.io/tags/tomcat/"/>
    
  </entry>
  
  <entry>
    <title>05-jQuery</title>
    <link href="https://zpengit.github.io/2020/06/11/05-jQuery/"/>
    <id>https://zpengit.github.io/2020/06/11/05-jQuery/</id>
    <published>2020-06-11T10:52:21.920Z</published>
    <updated>2020-06-11T10:44:29.848Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="05-jQuery"><a href="#05-jQuery" class="headerlink" title="05-jQuery"></a>05-jQuery</h1><h1 id="unit05-jQuery"><a href="#unit05-jQuery" class="headerlink" title="unit05-jQuery"></a>unit05-jQuery</h1><h2 id="jQuery简介"><a href="#jQuery简介" class="headerlink" title="jQuery简介"></a>jQuery简介</h2><h3 id="什么是jQuery-了解"><a href="#什么是jQuery-了解" class="headerlink" title="什么是jQuery(了解)"></a>什么是jQuery(了解)</h3><p>jQuery: JavaScript Query JS查询</p><p>jQuery是一门轻量的、免费开源的JS函数库（就是JS的简单框架）</p><p>jQuery可以极大的简化JS代码</p><p>jQuery的核心思想：“写的更少，但做的更多”</p><p><em>轻量的：是指一个技术对代码或程序的侵入程度是比较低的。</em></p><p><em>或者说代码对该技术依赖程度越低，这个技术越轻。对该技术的依赖程度越高，这个技术越重。</em></p><p><em>jQuery本质就是一个包含了很多函数的JS文件，如果要在某一个HTML中使用这个JS文件中的函数，就必须得将JS文件引入到HTML中</em></p><h3 id="jQuery的优势-了解"><a href="#jQuery的优势-了解" class="headerlink" title="jQuery的优势(了解)"></a>jQuery的优势(了解)</h3><p>(1) 可以极大的简化JS代码</p><p>(2) 可以像CSS选择器一样获取html元素</p><p>css中获取所有的div,给div添加样式:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">div&#123; css属性... &#125;</span><br></pre></td></tr></table></figure><p>jQuery中获取所有div,给div添加边框样式:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;div&quot;).css(&quot;border&quot;, &quot;2px solid red&quot;);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">JS获取id为div1的元素: document.getElementById(&quot;div1&quot;)</span><br><span class="line">jQuery获取id为div1的元素: $(&quot;#div1&quot;)</span><br></pre></td></tr></table></figure><p>(3) 可以通过修改css属性控制页面的效果</p><p>(4) 可以兼容常用的浏览器</p><p>比如: JS中的innerText属性、removeNode()函数、replaceNode( )函数 这些函数在某些浏览器中是无法使用的。</p><p>jQuery中提供了相应的函数（ text函数、remove函数、replaceWith函数 ）</p><p>常用浏览器：谷歌浏览器、火狐浏览器、苹果浏览器、欧朋浏览器等</p><h3 id="jQuery引入"><a href="#jQuery引入" class="headerlink" title="jQuery引入"></a>jQuery引入</h3><p>jQuery的函数库文件就是一个普通的JS文件，引入jQuery和引入JS文件的方式一样。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 在使用jQuery之前，必须先引入jQuery的函数库文件 --&gt;</span><br><span class="line">&lt;script src=<span class="string">"js/jquery-1.8.3.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>在引入jQuery函数库文件时，如果文件引入路径错误，则会导致文件引入失败，如下图：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200217103533313-8e1ac59d625745479b4d5082b6745f4b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870741-60d8fdf8e624fd55b17587b006775bc2.png" alt="image-20200217103533313"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200217103533313-8e1ac59d625745479b4d5082b6745f4b.png" target="_blank" rel="noopener">image-20200217103533313</a></p><h3 id="文档就绪事件函数"><a href="#文档就绪事件函数" class="headerlink" title="文档就绪事件函数"></a>文档就绪事件函数</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在使用jQuery之前，必须先引入jQuery的函数库文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery-1.8.3.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//1.获取id为demo的h1元素</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> h1 = <span class="built_in">document</span>.getElementById( <span class="string">"demo"</span> );</span></span><br><span class="line"><span class="actionscript"><span class="comment">//2.获取h1元素中的内容( innerHTML )</span></span></span><br><span class="line">alert( h1.innerHTML );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>jQuery的引入示例...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>问题描述：上面的代码在执行时，会报一个错误：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200217105525351-eba46d071c4f4f4e8071eb09f139847c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870741-a19b529a1de4695ac6d00da9d37714f0.png" alt="image-20200217105525351"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200217105525351-eba46d071c4f4f4e8071eb09f139847c.png" target="_blank" rel="noopener">image-20200217105525351</a></p><p>原因描述：在执行获取id为demo的元素时, h1元素还没有被浏览器加载到，所以获取不到h1元素。</p><p><strong>解决方式一：</strong></p><p>将script标签移到body内部，也就是h1元素的后面</p><p>这样浏览器在加载时，会先加载h1元素，再执行获取h1元素的代码，由于在获取h1元素之前，h1元素已经被浏览器加载过了，所以后面再获取就能够获取到！</p><p>代码示例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>jQuery的引入示例...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//1.获取id为demo的h1元素</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> h1 = <span class="built_in">document</span>.getElementById( <span class="string">"demo"</span> );</span></span><br><span class="line"><span class="actionscript"><span class="comment">//2.获取h1元素中的内容( innerHTML )</span></span></span><br><span class="line">alert( h1.innerHTML );</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>解决方式二：</strong></p><p>将获取元素的代码放在文档就绪事件函数中，文档就绪事件函数会在浏览器加载完所有的html元素后（也就是加载完最后一个html元素时）会立即执行。</p><p>由于整个html网页都被加载了，h1元素肯定也被加载了，此时再获取h1元素就一定能获取到。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在使用jQuery之前，必须先引入jQuery的函数库文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery-1.8.3.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//1.获取id为demo的h1元素</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> h1 = <span class="built_in">document</span>.getElementById( <span class="string">"demo"</span> );</span></span><br><span class="line"><span class="actionscript"><span class="comment">//2.获取h1元素中的内容( innerHTML )</span></span></span><br><span class="line">alert( h1.innerHTML );</span><br><span class="line">&#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>jQuery的引入示例...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>解决方式三：</strong></p><p>将获取元素的代码放在一个自定义的函数中，并将该函数绑定在h1元素的点击事件上，当我们点击h1元素时会执行自定义的函数，函数执行时才获取h1元素，此时就能够获取到h1元素。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在使用jQuery之前，必须先引入jQuery的函数库文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery-1.8.3.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//1.获取id为demo的h1元素</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> h1 = <span class="built_in">document</span>.getElementById( <span class="string">"demo"</span> );</span></span><br><span class="line"><span class="actionscript"><span class="comment">//2.获取h1元素中的内容( innerHTML )</span></span></span><br><span class="line">alert( h1.innerHTML );</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">onclick</span>=<span class="string">"fn1()"</span>&gt;</span>jQuery的引入示例...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>总结：什么时候该使用文档就绪事件函数?</strong></p><p>如果在获取元素时，获取元素的代码执行的时机，比元素本身加载的时间还要早，如果元素还没有加载就获取，必然是获取不到的。</p><p>可以将获取元素的代码放在文档就绪事件函数中，等浏览器加载完整个网页后，文档就绪事件函数才会执行，此时所有的元素都被加载了，再获取任何元素都能获取到！</p><p>jQuery提供的文档就绪事件函数（简写形式）：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//在浏览器加载完整个html网页后立即执行</span></span></span><br><span class="line">  &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其完整写法为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//在浏览器加载完整个html网页后立即执行</span></span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>JS也为我们提供了文档就绪事件函数，其写法为：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//在浏览器加载完整个html网页后立即执行</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="jQuery选择器-重点掌握"><a href="#jQuery选择器-重点掌握" class="headerlink" title="jQuery选择器(重点掌握)"></a>jQuery选择器(重点掌握)</h2><h3 id="基本选择器"><a href="#基本选择器" class="headerlink" title="基本选择器"></a>基本选择器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>)元素名选择器</span><br><span class="line">$(<span class="string">"div"</span>) -- 选中所有的div元素</span><br><span class="line">$(<span class="string">"span"</span>) -- 选中所有的span元素</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)<span class="class"><span class="keyword">class</span>/类选择器</span></span><br><span class="line">$(".s1") -- 选中所有class值为s1的元素(class值为s1的元素可能是任何元素)</span><br><span class="line">$(<span class="string">"span.s1"</span>) -- 选中所有<span class="class"><span class="keyword">class</span>值为<span class="title">s1</span>的<span class="title">span</span>元素</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">(3)<span class="title">id</span>选择器</span></span><br><span class="line">$("#one") -- 选中id为one的元素</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>)多元素选择器</span><br><span class="line">$(<span class="string">"div,span,.s1,#one"</span>) -- 选中所有的div元素,以及所有的span元素,以及所有<span class="class"><span class="keyword">class</span>值为<span class="title">s1</span>的元素,以及<span class="title">id</span>为<span class="title">one</span>的元素</span></span><br></pre></td></tr></table></figure><h3 id="层级选择器"><a href="#层级选择器" class="headerlink" title="层级选择器"></a>层级选择器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div span"</span>) -- 选中所有div内部的所有span元素</span><br><span class="line">$(<span class="string">"#one span"</span>) -- 选中id为one的元素内部的所有span元素</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#two+span"</span>) -- 选中id为two的元素后面紧邻的span兄弟元素</span><br><span class="line">$(<span class="string">"#two"</span>).next(<span class="string">"span"</span>) -- 选中id为two的元素后面紧邻的span兄弟元素</span><br><span class="line">$(<span class="string">"#two"</span>).prev(<span class="string">"span"</span>) -- 选中id为two的元素前面紧邻的span兄弟元素</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#two~span"</span>) -- 选中id为two的元素后面所有的span兄弟元素</span><br><span class="line">$(<span class="string">"#two"</span>).nextAll(<span class="string">"span"</span>) -- 选中id为two的元素后面所有的span兄弟元素</span><br><span class="line">$(<span class="string">"#two"</span>).prevAll(<span class="string">"span"</span>) -- 选中id为two的元素前面所有的span兄弟元素</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#two"</span>).siblings(<span class="string">"span"</span>) -- 选中id为two的元素前、后所有的span兄弟元素</span><br></pre></td></tr></table></figure><h3 id="基本过滤选择器"><a href="#基本过滤选择器" class="headerlink" title="基本过滤选择器"></a>基本过滤选择器</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>) 选中第一个div元素</span><br><span class="line">$(<span class="string">"div:first"</span>)</span><br><span class="line">$(<span class="string">"div:eq(0)"</span>)</span><br><span class="line">$(<span class="string">"div"</span>).eq(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>) 选中最后一个div元素</span><br><span class="line">$(<span class="string">"div:last"</span>)</span><br><span class="line">$(<span class="string">"div:eq(-1)"</span>)</span><br><span class="line">$(<span class="string">"div"</span>).eq(<span class="number">-1</span>)</span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>) 选中第n+<span class="number">1</span>个div元素(n从零开始)</span><br><span class="line">$(<span class="string">"div:eq(n)"</span>)</span><br><span class="line">$(<span class="string">"div"</span>).eq(n)</span><br></pre></td></tr></table></figure><h2 id="综合案例"><a href="#综合案例" class="headerlink" title="综合案例"></a>综合案例</h2><h3 id="创建表格元素"><a href="#创建表格元素" class="headerlink" title="创建表格元素"></a>创建表格元素</h3><p><strong>练习1：创建单行单列的表格</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTable1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.创建一个table元素</span></span><br><span class="line"><span class="keyword">var</span> $tab = $(<span class="string">"&lt;table&gt;&lt;/table&gt;"</span>);</span><br><span class="line"><span class="comment">//2.创建一个tr元素</span></span><br><span class="line"><span class="keyword">var</span> $tr = $(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="comment">//3.创建一个td元素, 并为td添加内容</span></span><br><span class="line"><span class="keyword">var</span> $td = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>);</span><br><span class="line">$td.html(<span class="string">"Hello TD~~"</span>);</span><br><span class="line"><span class="comment">//4.将td添加到tr元素内部</span></span><br><span class="line">$tr.append( $td );</span><br><span class="line"><span class="comment">//5.将tr添加到table元素内部</span></span><br><span class="line">$tab.append( $tr );</span><br><span class="line"><span class="comment">//6.将table添加到body元素内部</span></span><br><span class="line">$(<span class="string">"body"</span>).append( $tab ); </span><br><span class="line"></span><br><span class="line"><span class="comment">//$("body").append( "&lt;table&gt;&lt;tr&gt;&lt;td&gt;Hello~~TD...&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;" );</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习2.1：创建单行6列的表格</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTable2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.创建一个table元素</span></span><br><span class="line"><span class="keyword">var</span> $tab = $(<span class="string">"&lt;table&gt;&lt;/table&gt;"</span>);</span><br><span class="line"><span class="comment">//2.创建一个tr元素</span></span><br><span class="line"><span class="keyword">var</span> $tr = $(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123; </span><br><span class="line"><span class="comment">//3.创建一个td元素, 并为td添加内容</span></span><br><span class="line"><span class="keyword">var</span> $td = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>);</span><br><span class="line">$td.html(<span class="string">"Hello TD~~"</span>);</span><br><span class="line"><span class="comment">//4.将td添加到tr元素内部</span></span><br><span class="line">$tr.append( $td );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5.将tr添加到table元素内部</span></span><br><span class="line">$tab.append( $tr );</span><br><span class="line"><span class="comment">//6.将table添加到body元素内部</span></span><br><span class="line">$(<span class="string">"body"</span>).append( $tab ); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习2.2：创建5行6列的表格</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTable2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.创建一个table元素</span></span><br><span class="line"><span class="keyword">var</span> $tab = $(<span class="string">"&lt;table&gt;&lt;/table&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;<span class="number">5</span>;j++)&#123; <span class="comment">//外层循环:控制行数</span></span><br><span class="line"><span class="comment">//2.创建一个tr元素</span></span><br><span class="line"><span class="keyword">var</span> $tr = $(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++)&#123; <span class="comment">//内层循环:控制列数</span></span><br><span class="line"><span class="comment">//3.创建一个td元素, 并为td添加内容</span></span><br><span class="line"><span class="keyword">var</span> $td = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>);</span><br><span class="line">$td.html(<span class="string">"Hello TD~~"</span>);</span><br><span class="line"><span class="comment">//4.将td添加到tr元素内部</span></span><br><span class="line">$tr.append( $td );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5.将tr添加到table元素内部</span></span><br><span class="line">$tab.append( $tr );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//6.将table添加到body元素内部</span></span><br><span class="line">$(<span class="string">"body"</span>).append( $tab ); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>练习3：创建指定行和列的表格</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTable3</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//获取用户输入的行数和列数(js方式)</span></span><br><span class="line"><span class="comment">//var rows = document.getElementById("rows").value;</span></span><br><span class="line"><span class="comment">//var cols = document.getElementById("cols").value;</span></span><br><span class="line"><span class="keyword">var</span> rows = $(<span class="string">"#rows"</span>).val();</span><br><span class="line"><span class="keyword">var</span> cols = $(<span class="string">"#cols"</span>).val();</span><br><span class="line"><span class="built_in">console</span>.log(rows+<span class="string">" : "</span>+cols);</span><br><span class="line"><span class="comment">//1.创建一个table元素</span></span><br><span class="line"><span class="keyword">var</span> $tab = $(<span class="string">"&lt;table&gt;&lt;/table&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;rows;j++)&#123; <span class="comment">//外层循环:控制行数</span></span><br><span class="line"><span class="comment">//2.创建一个tr元素</span></span><br><span class="line"><span class="keyword">var</span> $tr = $(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;cols;i++)&#123; <span class="comment">//内层循环:控制列数</span></span><br><span class="line"><span class="comment">//3.创建一个td元素, 并为td添加内容</span></span><br><span class="line"><span class="keyword">var</span> $td = $(<span class="string">"&lt;td&gt;&lt;/td&gt;"</span>);</span><br><span class="line">$td.html(<span class="string">"Hello TD~~"</span>);</span><br><span class="line"><span class="comment">//4.将td添加到tr元素内部</span></span><br><span class="line">$tr.append( $td );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//5.将tr添加到table元素内部</span></span><br><span class="line">$tab.append( $tr );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//6.将table添加到body元素内部</span></span><br><span class="line">$(<span class="string">"body"</span>).append( $tab ); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="仿QQ好友列表"><a href="#仿QQ好友列表" class="headerlink" title="仿QQ好友列表"></a>仿QQ好友列表</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 通过jQuery实现仿QQ列表好友列表 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">openDiv</span>(<span class="params">thisobj</span>)</span>&#123; <span class="comment">//thisobj是一个js对象 --转成--&gt; jQuery对象</span></span><br><span class="line"><span class="comment">//先将其他三个分组关闭( 将其他三个分组内的div设置为隐藏 )</span></span><br><span class="line">$(<span class="string">"table span"</span>).not(thisobj).next(<span class="string">"div"</span>).hide(); <span class="comment">//css("display", "none")</span></span><br><span class="line"><span class="comment">//根据被点击的分组找到分组内的好友列表, 切换好友列表的展示状态</span></span><br><span class="line">$(thisobj).next(<span class="string">"div"</span>).toggle(); <span class="comment">//如果元素显示则切换为隐藏, 如果隐藏则切换为显示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="模拟员工信息管理系统"><a href="#模拟员工信息管理系统" class="headerlink" title="模拟员工信息管理系统"></a>模拟员工信息管理系统</h3><p>练习1：添加员工信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addEmp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.获取要添加的员工信息(id, name, email, salary)</span></span><br><span class="line"><span class="keyword">var</span> id = $(<span class="string">"#box1 input[name='id']"</span>).val().trim();</span><br><span class="line"><span class="keyword">var</span> name = $(<span class="string">"#box1 input[name='name']"</span>).val().trim();</span><br><span class="line"><span class="keyword">var</span> email = $(<span class="string">"#box1 input[name='email']"</span>).val().trim();</span><br><span class="line"><span class="keyword">var</span> salary = $(<span class="string">"#box1 input[name='salary']"</span>).val().trim();</span><br><span class="line"><span class="built_in">console</span>.log(id+<span class="string">" : "</span>+name+<span class="string">" : "</span>+email+<span class="string">" : "</span>+salary);</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.校验员工信息</span></span><br><span class="line"><span class="comment">//2.1.添加的员工信息不能为空!</span></span><br><span class="line"><span class="keyword">if</span>( id == <span class="string">""</span> || name == <span class="string">""</span> || email == <span class="string">""</span> || salary == <span class="string">""</span> )&#123;</span><br><span class="line">alert( <span class="string">"添加的员工信息不能为空!"</span> );</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.2.添加的员工id不能重复! (id=3)</span></span><br><span class="line"><span class="comment">//获取所有的tr元素, 并遍历所有的tr元素</span></span><br><span class="line"><span class="keyword">var</span> flag = <span class="literal">false</span>; <span class="comment">//false表示id是不存在的!!!</span></span><br><span class="line">$(<span class="string">"table tr"</span>).each(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">//this(JS对象)表示当前被遍历的元素 </span></span><br><span class="line"><span class="comment">// this --转换为jQuery对象--&gt; $( this ) </span></span><br><span class="line"><span class="keyword">var</span> _id = $(<span class="keyword">this</span>).find(<span class="string">"td:eq(1)"</span>).text();</span><br><span class="line"><span class="comment">//拿着用户输入的id和当前员工的id进行比较</span></span><br><span class="line"><span class="keyword">if</span>( id == _id )&#123; <span class="comment">//只要有一个相等,就说明id已存在,则停止添加</span></span><br><span class="line">alert(<span class="string">"您输入的员工ID已存在, 请重新添加!"</span>);</span><br><span class="line">flag = <span class="literal">true</span>; <span class="comment">//true表示id已存在!!</span></span><br><span class="line"><span class="comment">//return; 放在这里的return不能终止程序的执行</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">if</span>( flag )&#123; <span class="comment">//true表示id已存在!!</span></span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//3.将员工信息添加到页面上(添加到table中)</span></span><br><span class="line"><span class="comment">//&gt;&gt;创建一个tr元素</span></span><br><span class="line"><span class="keyword">var</span> $tr = $(<span class="string">"&lt;tr&gt;&lt;/tr&gt;"</span>);</span><br><span class="line"><span class="comment">//&gt;&gt;创建5个td元素,并将员工信息添加到td中</span></span><br><span class="line"><span class="keyword">var</span> $td1 = $(<span class="string">"&lt;td&gt;&lt;input type='checkbox'/&gt;&lt;/td&gt;"</span>); <span class="comment">//复选框</span></span><br><span class="line"><span class="keyword">var</span> $td2 = $(<span class="string">"&lt;td&gt;"</span>+id+<span class="string">"&lt;/td&gt;"</span>); <span class="comment">//ID</span></span><br><span class="line"><span class="keyword">var</span> $td3 = $(<span class="string">"&lt;td&gt;"</span>+name+<span class="string">"&lt;/td&gt;"</span>); <span class="comment">//name</span></span><br><span class="line"><span class="keyword">var</span> $td4 = $(<span class="string">"&lt;td&gt;"</span>+email+<span class="string">"&lt;/td&gt;"</span>); <span class="comment">//email</span></span><br><span class="line"><span class="keyword">var</span> $td5 = $(<span class="string">"&lt;td&gt;"</span>+salary+<span class="string">"&lt;/td&gt;"</span>); <span class="comment">//email</span></span><br><span class="line"><span class="comment">//&gt;&gt;将td元素添加到tr中</span></span><br><span class="line">$tr.append( $td1 ).append( $td2 ).append( $td3 ).append( $td4 ).append( $td5 );</span><br><span class="line"></span><br><span class="line"><span class="comment">//&gt;&gt;将tr元素添加到table中</span></span><br><span class="line">$(<span class="string">"table"</span>).append( $tr );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>练习2：删除员工信息</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delEmp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.获取所选中员工所在的tr行 (获取所有被选中的复选框)</span></span><br><span class="line"><span class="comment">//$("input:checked").parents("tr").remove(); //会连接表头一起删除</span></span><br><span class="line">$(<span class="string">"input:checked"</span>).parent(<span class="string">"td"</span>).parent(<span class="string">"tr"</span>).remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>练习3：修改员工信息（自己完成）</p><p>练习4：实现全选或全不选</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkAll</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//1.获取全选复选框的选中状态( 选中(true)?  没选中(false)? )</span></span><br><span class="line"><span class="keyword">var</span> isCheck = $(<span class="string">"#all"</span>).prop(<span class="string">"checked"</span>); <span class="comment">//true|false</span></span><br><span class="line"><span class="comment">//2.获取所有普通复选框, 将全选框的选中状态设置给所有普通复选框</span></span><br><span class="line">$(<span class="string">"input[type='checkbox'][id!='all']"</span>).prop(<span class="string">"checked"</span>,isCheck);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="jQuery总结"><a href="#jQuery总结" class="headerlink" title="jQuery总结"></a>jQuery总结</h2><h3 id="html元素操作"><a href="#html元素操作" class="headerlink" title="html元素操作"></a>html元素操作</h3><p><strong>1、创建元素</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"&lt;div&gt;&lt;/div&gt;"</span>) -- 创建一个div元素，返回的是一个表示div元素的jQuery对象</span><br><span class="line">$(<span class="string">"&lt;div&gt;xxxx&lt;/div&gt;"</span>) -- 创建一个包含内容的div元素，返回的是一个表示div元素的jQuery对象</span><br></pre></td></tr></table></figure><p><strong>2、添加子元素</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$parent.append( $child ) -- 父元素调用方法添加子元素</span><br><span class="line">$(<span class="string">"body"</span>).append( <span class="string">"&lt;div&gt;我是新来的...&lt;/div&gt;"</span> ); -- 往body元素内部追加一个div子元素</span><br></pre></td></tr></table></figure><p><strong>3、删除元素</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).remove() -- 删除所有的div元素</span><br><span class="line"></span><br><span class="line">JS删除所有div元素：</span><br><span class="line"><span class="comment">//获取所有的div元素(返回的是所有div组成的数组)</span></span><br><span class="line"><span class="keyword">var</span> divArr = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"div"</span>); <span class="comment">//div数组</span></span><br><span class="line"><span class="comment">//遍历div数组,依次删除每一个div元素</span></span><br><span class="line"><span class="keyword">var</span> len = divArr.length;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">    <span class="comment">//通过当前元素的父元素删除当前元素(始终删除第一个)</span></span><br><span class="line">    divArr[<span class="number">0</span>].parentNode.removeChild( divArr[<span class="number">0</span>] );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4、替换元素</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).replaceWith(<span class="string">"&lt;p&gt;我是来替换的…&lt;/p&gt;"</span>)</span><br></pre></td></tr></table></figure><h3 id="html元素内容和值的操作"><a href="#html元素内容和值的操作" class="headerlink" title="html元素内容和值的操作"></a>html元素内容和值的操作</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  这是一个div11元素</span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>这是一个span元素<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    这是一个div1111元素</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>1、html()函数 (类似于js中的innerHTML属性)</strong></p><p>-- 用于获取或设置元素的内容，比如为div、span、p、h1、table、tr、td等元素设置内容</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).html() -- 获取所有div中的第一个div的内容</span><br><span class="line">$(<span class="string">"div"</span>).html(<span class="string">"xxxx"</span>) -- 为所有div设置内容</span><br></pre></td></tr></table></figure><p><strong>2、text()函数 (类似于js中的innerText属性，innerText在部分浏览器中不兼容)</strong></p><p>-- 用于获取或设置元素的文本内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;div&quot;).text() -- 获取所有div中的所有文本内容</span><br><span class="line">$(&quot;div&quot;).text(&quot;xxxx&quot;) -- 为所有div设置文本内容</span><br></pre></td></tr></table></figure><p><strong>3、val()函数</strong> (类似于js中的value属性)</p><p>-- 获取或设置表单项元素的value值(input/select/option/textarea)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"input"</span>).val() -- 获取所有input元素中的第一个input元素的value值</span><br><span class="line">$(<span class="string">"input"</span>).val(值) -- 为所有的input元素设置value值</span><br></pre></td></tr></table></figure><h3 id="元素属性和css属性操作"><a href="#元素属性和css属性操作" class="headerlink" title="元素属性和css属性操作"></a>元素属性和css属性操作</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"inp"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><strong>1、prop()函数</strong> – 用于获取或设置元素的属性值</p><p>在jQuery1.6版本之后才有这个函数，1.6之前版本的jQuery可以使用attr()函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"input[type='checkbox']"</span>).prop(<span class="string">"checked"</span>)</span><br><span class="line">-- 获取input复选框的选中状态, 返回<span class="literal">true</span>表示复选框为选中状态,返回<span class="literal">false</span>表示复选框为取消选中状态</span><br><span class="line">$(<span class="string">"input[type='checkbox']"</span>).prop(<span class="string">"checked"</span>, <span class="literal">true</span>)</span><br><span class="line">-- 设置所匹配的复选框元素为选中状态</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#inp"</span>).prop(<span class="string">"name"</span>); <span class="comment">//获取id为inp元素的name属性值, 返回useranme</span></span><br><span class="line">$(<span class="string">"#inp"</span>).prop(<span class="string">"name"</span>,<span class="string">"user"</span>); <span class="comment">//为id为inp的元素设置name属性值, name属性值就会变成user</span></span><br></pre></td></tr></table></figure><p><strong>2、css()函数</strong> – 用于获取或设置元素的css属性值</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"#div1"</span>).css(<span class="string">"width"</span>) -- 获取id为div1元素的宽度</span><br><span class="line">$(<span class="string">"#div1"</span>).css(<span class="string">"width"</span>,<span class="string">"200px"</span>) -- 设置id为div1元素的宽度为<span class="number">200</span>px</span><br><span class="line">$(<span class="string">"#div1"</span>).css(&#123;</span><br><span class="line"><span class="string">"width"</span> : <span class="string">"200px"</span>,</span><br><span class="line"><span class="string">"height"</span> : <span class="string">"150px"</span>,</span><br><span class="line"><span class="string">"border"</span> : <span class="string">"5px solid red"</span>,</span><br><span class="line"><span class="string">"background"</span> : <span class="string">"pink"</span></span><br><span class="line">&#125;); <span class="comment">// 设置id为div1元素的宽度为200px、高度为150px、边框以及背景颜色等样式</span></span><br></pre></td></tr></table></figure><h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><p><strong>1、each() 函数</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(selector).each(function( index,element )&#123;&#125;)</span><br><span class="line">-- each()函数可以遍历$(selector)选择器选中的所有元素(即每次都选择器选中的元素中获取一个元素,并执行function 函数)</span><br><span class="line">-- function中的index -- 表示遍历的元素的下标</span><br><span class="line">-- function中的element -- 表示当前正在遍历的元素(也可以通过this获取)</span><br></pre></td></tr></table></figure><p><strong>2、show()/hide() 函数</strong></p><p>show() – 设置元素由隐藏变为显示</p><p>hide() – 设置元素由显示变为隐藏</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).show() -- 设置所有的div元素为显示</span><br></pre></td></tr></table></figure><p>等价于:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).css(<span class="string">"display"</span>, <span class="string">"block"</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">"div"</span>).hide() -- 设置所有的div元素为隐藏</span><br></pre></td></tr></table></figure><p>等价于:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">"div"</span>).css(<span class="string">"display"</span>, <span class="string">"none"</span>)</span><br></pre></td></tr></table></figure><p><strong>2、toggle()/slideToggle()</strong></p><p>toggle() – 切换元素的显示状态, 如果元素是显示的, 则切换为隐藏, 否则切换为显示</p><p>slidToggle() –切换元素的显示状态, 如果元素是显示的, 则切换为隐藏，否则切换为显示，切换为显示为下拉状态，隐藏为收缩状态。</p><h2 id="扩展-为元素绑定点击事件"><a href="#扩展-为元素绑定点击事件" class="headerlink" title="扩展:为元素绑定点击事件"></a>扩展:为元素绑定点击事件</h2><p>以点击事件为例，为元素绑定点击事件的方式为:</p><p><strong>方式1(js版)：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    alert(<span class="string">"input按钮被点击了..."</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;input onclick="fn()" type="button" value="点我~!" /</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方式2(js版)：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//获取id为btn的元素</span></span><br><span class="line"><span class="keyword">var</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">"btn"</span>);</span><br><span class="line">btn.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">alert(<span class="string">"input按钮被点击了..."</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;input id="btn" type="button" value="点我~!" /</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方式3(jQuery版)：</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//当点击btn按钮时,触发点击事件执行其中的函数</span></span><br><span class="line">    $(<span class="string">"#btn"</span>).click( <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">"input按钮被点击了..."</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;body&gt;</span></span><br><span class="line"><span class="regexp">&lt;input id="btn" type="button" value="点我~!" /</span>&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br></pre></td></tr></table></figure><h1 id="javaweb-jquery"><a href="#javaweb-jquery" class="headerlink" title="javaweb   jquery"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/jquery" target="_blank" rel="noopener">jquery</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="jquery" scheme="https://zpengit.github.io/tags/jquery/"/>
    
  </entry>
  
  <entry>
    <title>04-JavaScript</title>
    <link href="https://zpengit.github.io/2020/06/11/04-JavaScript/"/>
    <id>https://zpengit.github.io/2020/06/11/04-JavaScript/</id>
    <published>2020-06-11T10:52:15.871Z</published>
    <updated>2020-06-11T10:44:14.187Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="04-JavaScript"><a href="#04-JavaScript" class="headerlink" title="04-JavaScript"></a>04-JavaScript</h1><h1 id="unit04-JavaScript"><a href="#unit04-JavaScript" class="headerlink" title="unit04-JavaScript"></a>unit04-JavaScript</h1><h2 id="JavaScript简介"><a href="#JavaScript简介" class="headerlink" title="JavaScript简介"></a>JavaScript简介</h2><h3 id="什么是JavaScript-了解"><a href="#什么是JavaScript-了解" class="headerlink" title="什么是JavaScript(了解)"></a>什么是JavaScript(了解)</h3><p>全称叫做JavaScript，简称叫做JS</p><p>由NetScape(网景)公司提供，是一门专门嵌入在浏览器中执行的脚本语言</p><p>JS运行在浏览器中，负责实现网页中的动画效果</p><p>或者是实现表单校验等功能</p><h3 id="JS特点和优势-了解"><a href="#JS特点和优势-了解" class="headerlink" title="JS特点和优势(了解)"></a>JS特点和优势(了解)</h3><p><strong>1、特点：</strong></p><p>(1)JS是一门直译式的语言(边解释边执行，没有编译的过程)</p><p>(2)JS是一门基于对象的语言(JS中没有类的概念,也没有编译的过程)</p><p>JS中是有对象的(内置对象、自定义对象)</p><p>(3)JS是一门弱类型的语言(Java:强类型)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在java中:</span><br><span class="line"><span class="built_in">String</span> s = <span class="string">"abc"</span>;</span><br><span class="line">int n = <span class="number">100</span>;</span><br><span class="line">在JS中:</span><br><span class="line"><span class="keyword">var</span> s = <span class="number">100</span>;</span><br><span class="line">s = <span class="string">"abc"</span>;</span><br><span class="line">s = <span class="literal">true</span>;</span><br><span class="line">s = [];</span><br><span class="line">s = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p><strong>2、优势：</strong></p><p>(1)JS具有良好的交互性</p><p>(2)JS具有一定的安全性(只能在浏览器内部运行,不能访问浏览器以外的资源)</p><p>(3)JS具有跨平台性(JS 浏览器)</p><p>( JS语言是跨平台的，是因为有浏览器，但浏览器不跨平台</p><p>Java语言是跨平台的，是因为有虚拟机，但虚拟主机不跨平台 )</p><h3 id="在HTML书写JS的方式"><a href="#在HTML书写JS的方式" class="headerlink" title="在HTML书写JS的方式"></a>在HTML书写JS的方式</h3><p><strong>1、在script标签内部可以书写JS代码：</strong></p><p>在head或者body标签内部可以添加一个script标签，在script标签内部可以直接书写JS代码！</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在script标签内部可以书写JS注释和JS代码 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="comment">//JS的单行注释</span></span></span><br><span class="line"><span class="actionscript">  <span class="comment">/* JS的多行注释 */</span></span></span><br><span class="line"><span class="actionscript">alert( <span class="string">"在html中引入JS的第一种方式..."</span> );</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、通过script标签引入外部的JS文件</strong></p><p>在head或body标签内部，可以通过script标签引入外部的JS文件。例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过script标签可以引入外部的JS文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"demo.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意：(1)在引入js文件的script标签内部不要书写JS代码,例如:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"demo.js"</span>&gt;</span></span><br><span class="line"><span class="actionscript">alert( <span class="number">111</span> ); <span class="comment">//这里的代码不会执行</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>(2)不要将引入JS文件的script标签自闭，因为可能会导致文件引入失败，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"demo.js"</span> /&gt;</span></span><br></pre></td></tr></table></figure><p><strong>扩展内容：也可以直接在元素上书写JS代码</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 直接在元素上书写JS代码：</span></span><br><span class="line"><span class="comment">onclick属性用于给当前元素绑定点击事件：点击元素就会触发事件，执行相应函数</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"点我~"</span> <span class="attr">onclick</span>=<span class="string">"alert('叫你点你还真敢点啊!!!')"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"别点我"</span>  <span class="attr">onclick</span>=<span class="string">"console.log( new Date() )"</span>/&gt;</span></span><br></pre></td></tr></table></figure><h2 id="JavaScript语法"><a href="#JavaScript语法" class="headerlink" title="JavaScript语法"></a>JavaScript语法</h2><h3 id="注释格式"><a href="#注释格式" class="headerlink" title="注释格式"></a>注释格式</h3><p>JS的注释符号和Java的注释符号相同，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单行注释内容</span></span><br><span class="line"><span class="comment">/* 多行注释内容 */</span></span><br></pre></td></tr></table></figure><h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p><strong>1、基本数据类型</strong></p><p><strong>(1)数值类型(number)</strong></p><p>在JS中，所有的数值在底层都是浮点型，但是在处理和显示的过程中会自动的和整型进行转换。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">例如：2.4+3.6&#x3D;6</span><br><span class="line">特殊值：Infinity(无穷大) &#x2F; -Infinity(负无穷大) &#x2F; NaN(非数字)</span><br></pre></td></tr></table></figure><p><strong>(2)字符串类型(string)</strong></p><p>在JS中，字符串类型属于基本数据类型，字符串常量可以使用单引号或者使用双引号引起来。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="string">"Hello JS"</span>;</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="string">'Hello JS'</span>;</span><br></pre></td></tr></table></figure><p>另外，JS中字符串类型有对应的包装对象（String），在需要时会自动的和包装对象进行转换。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="string">"Hello JS"</span>;</span><br><span class="line"><span class="built_in">console</span>.log( <span class="keyword">typeof</span> s1 ); <span class="comment">//string</span></span><br><span class="line"><span class="keyword">var</span> s2 = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"Hello JS"</span>);</span><br><span class="line"><span class="built_in">console</span>.log( <span class="keyword">typeof</span> s2 ); <span class="comment">//object</span></span><br><span class="line"><span class="comment">//不管是基本数据类型s1, 还是对象类型s2, 都可以当作对象来用</span></span><br><span class="line"><span class="built_in">console</span>.log( s1.valueOf() ); <span class="comment">//s1是基本数据类型, 会转成对象, 调用valueOf函数</span></span><br><span class="line"><span class="built_in">console</span>.log( s2.valueOf() );</span><br></pre></td></tr></table></figure><p><strong>(3)布尔类型(boolean)</strong></p><p>布尔类型的值有两个，分别为true和false。</p><p>(4)undefined</p><p>undefined类型的值只有一个，就是undefined，表示变量未定义(但不是指对象没有声明)。</p><p>是指声明了变量，但没有为变量赋值，该变量的值就是undefined。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1.undefined类型 */</span></span><br><span class="line"><span class="keyword">var</span> x;</span><br><span class="line">alert( x ); <span class="comment">//undefined</span></span><br><span class="line">alert( y ); <span class="comment">//抛异常</span></span><br></pre></td></tr></table></figure><p>(5)null</p><p>null类型的值也只有一个，就是null，表示空值。</p><p>可以作为函数的返回值，表示函数返回的是一个空的对象。</p><p>注意：null和undefined类型的变量是不能调用函数或属性的，会抛异常！</p><p><strong>2、复杂数据类型</strong></p><p>主要指对象(JS的内置对象、自定义的对象、函数、数组)</p><h3 id="变量声明"><a href="#变量声明" class="headerlink" title="变量声明"></a>变量声明</h3><p>JS中是通过var关键字声明变量，声明的变量是不区分类型，可以指向任意的数据。例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">100</span>;</span><br><span class="line">x = <span class="string">"abc"</span>;</span><br><span class="line">x = <span class="literal">true</span>;</span><br><span class="line">x = [];</span><br><span class="line">x = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">x = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">x = &#123;&#125;;</span><br></pre></td></tr></table></figure><p>另外，JS中多次声明同名的变量不会出现语法错误，例如：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 2.变量的定义 */</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="string">"Hello"</span>; <span class="comment">// var s; s="Hello";</span></span><br><span class="line"><span class="keyword">var</span> s = <span class="number">123</span>; <span class="comment">// var s; s=123; 第二次声明变量x没有生效</span></span><br><span class="line">alert( s ); <span class="comment">//123</span></span><br></pre></td></tr></table></figure><h3 id="JS运算符"><a href="#JS运算符" class="headerlink" title="JS运算符"></a>JS运算符</h3><p>JS和Java中的运算符大致相同，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">算术运算符: +，-，*，&#x2F;，%，++，--</span><br><span class="line">赋值运算符: &#x3D;，+&#x3D;，-&#x3D;，*&#x3D;，&#x2F;&#x3D;，%&#x3D;</span><br><span class="line">比较运算符: &#x3D;&#x3D;，!&#x3D;，&gt;，&gt;&#x3D;，&lt;，&lt;&#x3D;</span><br><span class="line">位运算符: &amp; ， |</span><br><span class="line">逻辑运算符: &amp;&amp; ，||</span><br><span class="line">前置逻辑运算符: ! (not)</span><br><span class="line">三元运算符: 表达式 ? 表达式 : 表达式</span><br><span class="line">。。。</span><br></pre></td></tr></table></figure><h3 id="JS语句"><a href="#JS语句" class="headerlink" title="JS语句"></a>JS语句</h3><p>JS中的语句和Java中的语句也大致相同</p><p><strong>1、if分支结构</strong></p><p>if分支结构用于基于不同的条件来执行不同的动作。语法结构如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (条件 <span class="number">1</span>)&#123;</span><br><span class="line">当条件 <span class="number">1</span> 为 <span class="literal">true</span> 时执行的代码</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (条件 <span class="number">2</span>)&#123;</span><br><span class="line">当条件 <span class="number">2</span> 为 <span class="literal">true</span> 时执行的代码</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">当条件 <span class="number">1</span> 和 条件 <span class="number">2</span> 都不为 <span class="literal">true</span> 时执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、switch语句</strong></p><p>使用 switch 语句来选择要执行的多个代码块之一。语法结构如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(n)&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">执行代码块 <span class="number">1</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        执行代码块 <span class="number">2</span></span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">与 <span class="keyword">case</span> <span class="number">1</span> 和 <span class="keyword">case</span> <span class="number">2</span> 不同时执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行原理：首先设置表达式 n（通常是一个变量）。随后表达式的值会与结构中的每个case 的值做比较。如果存在匹配，则与该 case 关联的代码块会被执行。请使用 break来阻止代码自动地向下一个 case 运行。</p><p><strong>3、for循环语句</strong> – 循环代码块一定的次数</p><p>for 循环的语法结构如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (语句 <span class="number">1</span>; 语句 <span class="number">2</span>; 语句 <span class="number">3</span>)&#123;</span><br><span class="line">被执行的代码块</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4、while循环</strong> – 在指定条件为真时循环执行代码块</p><p>JS中while循环也分为while和do/while循环，下面为while循环语法结构:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (条件)&#123;</span><br><span class="line">需要执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>while 循环会在指定条件为真时循环执行代码块。</p><p><code>案例1：if分支案例: 接收用户输入的成绩，判断成绩所属的等级</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">80~100(包括80，也包括100) 优秀</span><br><span class="line">60~80(包括60，但不包括80) 中等</span><br><span class="line">0~60(包括0，但不包括60) 不及格</span><br></pre></td></tr></table></figure><p>其他值 输入有误</p><p>代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> score = prompt(<span class="string">"请输入您的成绩: "</span>);</span><br><span class="line"><span class="keyword">if</span>( score &gt;= <span class="number">80</span> &amp;&amp; score &lt;=<span class="number">100</span> )&#123;</span><br><span class="line">alert(<span class="string">"您的成绩属于: 优秀!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>( score &gt;= <span class="number">60</span> &amp;&amp; score &lt; <span class="number">80</span> )&#123;</span><br><span class="line">alert(<span class="string">"您的成绩属于: 中等!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>( score &gt;= <span class="number">0</span> &amp;&amp; score &lt; <span class="number">60</span> )&#123;</span><br><span class="line">alert(<span class="string">"您的成绩属于: 不及格!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">alert(<span class="string">"您的输入有误, 请重新输入!"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>案例2：switch语句案例—实现一个简易的计算器：</p><p>可以接收用户输入的两个数值和一个操作符(+、-、*、/)，根据操作符号的不同，对两个数值执行不同的运算。</p><p>代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.接收用户输入的数值和运算符, 中间用空格分隔</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = prompt(<span class="string">"请输入数值1、运算符、数值2，中间用空格分隔："</span>); <span class="comment">//"10 + 5"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.对用户输入的内容进行切割(以空格作为分隔符切割)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = str.split(<span class="string">" "</span>); <span class="comment">// ["10", "+", "5"]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num1 = arr[<span class="number">0</span>] - <span class="number">0</span> ;</span><br><span class="line"><span class="keyword">var</span> opt = arr[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">var</span> num2 = arr[<span class="number">2</span>] - <span class="number">0</span> ;</span><br><span class="line"><span class="comment">//3.通过switch分支实现计算器</span></span><br><span class="line"><span class="keyword">switch</span>( opt )&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"+"</span>:</span><br><span class="line">alert( <span class="string">"两个数的和为: "</span>+( num1+num2 ) );</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"-"</span>:</span><br><span class="line">alert( <span class="string">"两个数的差为: "</span>+( num1-num2 ) );</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"*"</span>:</span><br><span class="line">alert( <span class="string">"两个数的乘积为: "</span>+( num1*num2 ) );</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"/"</span>:</span><br><span class="line">alert( <span class="string">"两个数的商为: "</span>+( num1/num2 ) );</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">alert( <span class="string">"您输入的运算符有误, 请重新输入!"</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>案例3：for循环语句案例</p><p>遍历1<del>100之间的所有整数，求1</del>100之间所有整数的和，并输出到控制台;</p><p>代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>( i &lt;= <span class="number">100</span> )&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br><span class="line">alert( <span class="string">"1~100之间所有整数的和为: "</span>+sum );</span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">var</span> i=<span class="number">0</span>; i&lt;=<span class="number">100</span>; i++)&#123;</span><br><span class="line">sum += i;</span><br><span class="line">&#125;</span><br><span class="line">alert( <span class="string">"1~100之间所有整数的和为: "</span>+sum );</span><br><span class="line"><span class="comment">//--------------------------------------</span></span><br></pre></td></tr></table></figure><p>案例4：while循环语句案例</p><p>遍历下面数组中的元素，将元素输出到控制台。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var arr &#x3D; [123, &quot;abc&quot;, false, new Object() ];</span><br></pre></td></tr></table></figure><p>代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">123</span>, <span class="string">"abc"</span>, <span class="literal">false</span>, <span class="keyword">new</span> <span class="built_in">Object</span>() ];</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>( index &lt; arr.length )&#123;</span><br><span class="line"><span class="built_in">console</span>.log( arr[index] );</span><br><span class="line">index++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>( <span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.length; i++ )&#123;</span><br><span class="line"><span class="built_in">console</span>.log( arr[i] );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JS数组"><a href="#JS数组" class="headerlink" title="JS数组"></a>JS数组</h3><p>Array 对象用于在单个的变量中存储多个值。</p><p><strong>JS数组的声明方式一:</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明一个空数组,长度为零</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [];</span><br><span class="line"><span class="comment">//声明一个数组，并为数组设置初始值</span></span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="string">"Hello"</span>, <span class="number">111</span>, <span class="literal">false</span>, <span class="keyword">new</span> <span class="built_in">Object</span>() ];</span><br></pre></td></tr></table></figure><p><strong>JS数组的声明方式二:</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明一个空数组，长度为零</span></span><br><span class="line"><span class="keyword">var</span> arr3 = <span class="keyword">new</span> <span class="built_in">Array</span>();</span><br><span class="line"><span class="comment">//声明一个数组，并为数组设置初始值</span></span><br><span class="line"><span class="keyword">var</span> arr4 = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"Hello"</span>, <span class="number">111</span>, <span class="literal">false</span>, <span class="keyword">new</span> <span class="built_in">Object</span>());</span><br></pre></td></tr></table></figure><p><strong>数组中的细节问题:</strong></p><p>(1)JS中的数组可以存储任意类型的数据</p><p>(2)JS中的数组长度是可以被任意改变的</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"此处数组的长度为: "</span>+arr1.length ); <span class="comment">// 0</span></span><br><span class="line">arr1.length = <span class="number">5</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"此处数组的长度为: "</span>+arr1.length ); <span class="comment">// 5</span></span><br><span class="line">arr1[<span class="number">9</span>] = <span class="string">"a"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"此处数组的长度为: "</span>+arr1.length ); <span class="comment">// 10</span></span><br><span class="line">arr1[<span class="number">99</span>] = <span class="string">"b"</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"此处数组的长度为: "</span>+arr1.length ); <span class="comment">// 100</span></span><br></pre></td></tr></table></figure><h3 id="JS函数"><a href="#JS函数" class="headerlink" title="JS函数"></a>JS函数</h3><p>函数就是一个具有功能的代码块, 可以反复调用</p><p>函数就是包裹在花括号中的代码块，前面使用了关键词 function。</p><p><strong>JS中声明函数的方式为:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function 函数名称([参数列表])&#123;</span><br><span class="line">函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var 变量名&#x2F;函数名 &#x3D; function([参数列表])&#123;</span><br><span class="line">函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用函数: 函数名称([参数列表]);</p><h3 id="综合练习"><a href="#综合练习" class="headerlink" title="综合练习"></a>综合练习</h3><p>(自己完成)声明一个函数fn，在函数中实现：遍历指定的两个数值(例如1和100)之间的整数，将是3的倍数的数值存入到一个数组中，并将数组返回。</p><p>1、声明fn函数</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x,y</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=x,j=<span class="number">0</span>;i&lt;y;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i%<span class="number">3</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        arr[j] = i;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2、调用fn函数, 获取1~100之间是3的倍数的数值组成的数组</p><p>var arr = fn(1,100);</p><p>3、遍历数组中的元素, 输出在网页上(提示: document.write(“输出的内容”) )</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;arr.length;i++)&#123;</span><br><span class="line"><span class="built_in">document</span>.write(arr[i]+<span class="string">" "</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h2><p>DOM: Document Object Model，文档对象模型，其实就是JS专门为访问html元素提供的一套API。</p><h3 id="案例：电灯开关"><a href="#案例：电灯开关" class="headerlink" title="案例：电灯开关"></a>案例：电灯开关</h3><p>点击电灯可以实现开/关灯，代码实现如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> flag = <span class="string">"off"</span>; <span class="comment">//flag表示灯的状态, off表示灯是关闭的!</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeImg</span>(<span class="params"> </span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.通过id获取img元素(返回是一个JS对象)</span></span><br><span class="line">    <span class="keyword">var</span> imgObj = <span class="built_in">document</span>.getElementById(<span class="string">"img1"</span>);</span><br><span class="line">    <span class="keyword">if</span>( flag == <span class="string">"off"</span> )&#123; <span class="comment">// 表明灯是关闭状态, 点击后则需要打开</span></span><br><span class="line">    imgObj.src = <span class="string">"imgs/on.gif"</span>;</span><br><span class="line">    flag = <span class="string">"on"</span>; <span class="comment">// 更新灯的状态为开灯</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; <span class="comment">// flag="on" 表名灯是打开状态, 点击后则需要关闭</span></span><br><span class="line">    imgObj.src = <span class="string">"imgs/off.gif"</span>;</span><br><span class="line">    flag = <span class="string">"off"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例：增删改元素"><a href="#案例：增删改元素" class="headerlink" title="案例：增删改元素"></a>案例：增删改元素</h3><p>点击网页中的按钮对html元素进行操作</p><p>练习1、添加元素:添加一个div元素到body中</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addNode</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个新的div元素(返回的是一个JS对象, 表示新创建的div元素)</span></span><br><span class="line">    <span class="keyword">var</span> newDivObj = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>); <span class="comment">// \&lt;div\&gt;\&lt;/div\&gt;</span></span><br><span class="line">    newDivObj.innerHTML = <span class="string">"我是新来的...."</span>;</span><br><span class="line">    <span class="comment">//2.获取body元素(body是父元素)</span></span><br><span class="line">    <span class="keyword">var</span> bodyObj = <span class="built_in">document</span>.body;</span><br><span class="line">    <span class="comment">//3.通过父元素(body)添加子元素(newDivObj)</span></span><br><span class="line">    bodyObj.appendChild( newDivObj );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>练习2、删除元素: 删除id为div_2的元素</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deleteNode</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.获取要删除的元素(id为div_2)</span></span><br><span class="line">    <span class="keyword">var</span> div2 = <span class="built_in">document</span>.getElementById(<span class="string">"div_2"</span>);</span><br><span class="line">    <span class="comment">//2.获取id为div_2的元素的父元素</span></span><br><span class="line">    <span class="keyword">var</span> parent = div2.parentNode;</span><br><span class="line">    <span class="comment">//3.通过父元素删除子元素</span></span><br><span class="line">    parent.removeChild( div2 );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>练习3、更新元素内容：将div_3的内容更新为当前时间</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateNode</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//1.获取id为div_3的元素</span></span><br><span class="line">    <span class="keyword">var</span> div3 = <span class="built_in">document</span>.getElementById(<span class="string">"div_3"</span>);</span><br><span class="line">    <span class="comment">//2.获取表示当前时间的字符串</span></span><br><span class="line">    <span class="keyword">var</span> dateStr = <span class="keyword">new</span> <span class="built_in">Date</span>().toLocaleString();</span><br><span class="line">    <span class="comment">//3.将div_3元素的内容更新为当前时间</span></span><br><span class="line">    div_3.innerHTML = dateStr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例：网页换肤"><a href="#案例：网页换肤" class="headerlink" title="案例：网页换肤"></a>案例：网页换肤</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 练习1：执行下面的函数，切换字体大小 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resize</span>(<span class="params"> selector </span>)</span>&#123;</span><br><span class="line"><span class="comment">//获取id为newstext元素</span></span><br><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.getElementById(<span class="string">"newstext"</span>);</span><br><span class="line"><span class="comment">//将id为newstext元素的class属性值设置为 selector</span></span><br><span class="line">div.className = selector;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 练习2：执行下面的函数，为页面切换不同的皮肤</span></span><br><span class="line"><span class="comment">点击换肤链接时,执行changeStyle函数，将link标签的href属性值指向</span></span><br><span class="line"><span class="comment">不同的css文件的路径，就会使用不同的css文件中的样式 */</span></span><br><span class="line"><span class="comment">//定义数组，存放不同的皮肤（css文件的路径）</span></span><br><span class="line"><span class="keyword">var</span> styleArr = [<span class="string">"css/red.css"</span>, <span class="string">"css/green.css"</span>, <span class="string">"css/blue.css"</span>];</span><br><span class="line"><span class="keyword">var</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">changeStyle</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="comment">//获取head中的link标签(id=link)</span></span><br><span class="line"><span class="keyword">var</span> link = <span class="built_in">document</span>.getElementById(<span class="string">"link"</span>);</span><br><span class="line"><span class="comment">//将link标签的href属性值指向css文件的路径</span></span><br><span class="line">link.href = styleArr[index];</span><br><span class="line">index++;</span><br><span class="line"><span class="keyword">if</span>( index == styleArr.length )&#123; <span class="comment">//如果下标等于数组长度</span></span><br><span class="line">index = <span class="number">0</span>; <span class="comment">//则将下标重置为0</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="总结：JS获取元素"><a href="#总结：JS获取元素" class="headerlink" title="总结：JS获取元素"></a>总结：JS获取元素</h3><p><code>document.getElementById( id值 )</code> – 通过元素的id值，获取一个元素。返回的是表示该元素的js对象。</p><p><code>document.getElementsByTagName( 元素名 )</code> – 通过元素名称获取当前文档中的所有指定名称的元素，返回的是一个数组，其中包含了所有指定名称的元素。</p><p><code>document.body</code> – 获取当前文档中的body元素</p><p><code>ele.parentNode</code> – 获取当前元素的父元素。ele表示当前元素</p><h3 id="总结：JS增删改元素"><a href="#总结：JS增删改元素" class="headerlink" title="总结：JS增删改元素"></a>总结：JS增删改元素</h3><p><code>document.createElement( 元素名称 )</code> – 根据元素名称创建指定名称的元素，返回的是表示新创建元素的js对象</p><p><code>parent.appendChild( child )</code> – 通过父元素添加子元素，其中parent表示父元素，child表示子元素</p><p><code>parent.removeChild( child )</code>-- 通过父元素删除子元素，其中parent表示父元素，child表示子元素</p><p><code>ele.innerHTML</code> – 获取当前元素的html内容(从开始标签到结束标签之间的所有内容)，还可以设置当前元素的html内容(如果元素内部有内容，将会覆盖原有内容)</p><h1 id="javaweb-javascript"><a href="#javaweb-javascript" class="headerlink" title="javaweb   javascript"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/javascript" target="_blank" rel="noopener">javascript</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="javascript" scheme="https://zpengit.github.io/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>03-HTML、CSS</title>
    <link href="https://zpengit.github.io/2020/06/11/03-HTML%E3%80%81CSS/"/>
    <id>https://zpengit.github.io/2020/06/11/03-HTML%E3%80%81CSS/</id>
    <published>2020-06-11T10:52:05.979Z</published>
    <updated>2020-06-11T10:44:01.434Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="03-HTML、CSS"><a href="#03-HTML、CSS" class="headerlink" title="03-HTML、CSS"></a>03-HTML、CSS</h1><h1 id="unit-03-HTML、CSS"><a href="#unit-03-HTML、CSS" class="headerlink" title="unit 03-HTML、CSS"></a>unit 03-HTML、CSS</h1><p>HTML: 用于开发网页的一门技术</p><p>CSS: 用于修饰、渲染网页的一门技术</p><p>HTML+CSS可以开发一个非常美观、非常漂亮的网页</p><p>开发网页 盖房子</p><p>HTML标签搭建网页的结构 砖块(搭建房子的结构)</p><p>CSS属性 石灰、油漆等涂料</p><h2 id="HTML概述"><a href="#HTML概述" class="headerlink" title="HTML概述"></a>HTML概述</h2><h3 id="HTML是什么"><a href="#HTML是什么" class="headerlink" title="HTML是什么"></a>HTML是什么</h3><p>HTML(Hyper Text Markup Language): 超文本标记语言</p><p>超文本: 超级文本、超过文本（其中可以包含除了文本以外的其他数据，例如图片、音频、视频等各种格式）</p><p>标记：也叫标签、元素、节点等，就是用尖括号(&lt;&gt;)括起来的一组内容，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt; &lt;body&gt; &lt;div&gt; &lt;span&gt; &lt;table&gt;等</span><br></pre></td></tr></table></figure><p>HTML是最基础的开发网页的语言。</p><p>HTML由W3C组织提供(CSS/xml)</p><p>关于HTML的细节:</p><p>(1)使用HTML开发的网页文件通常以 .htm或.html 为后缀!</p><p>(2)使用HTML开发的网页文件由浏览器负责解析并显示（浏览器就是一个html解析器）</p><p>(3)HTML是文档的一种(txt/word/ppt/pdf等)</p><p>总结: HTML就是用于开发网页的一门语言!!</p><h3 id="HTML的结构"><a href="#HTML的结构" class="headerlink" title="HTML的结构"></a>HTML的结构</h3><p><strong>1、案例：编写我的第一个HTML网页，并用浏览器打开</strong></p><p>新建一个txt文档，将后缀名改为.html，代码实现如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>网页的标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Hello CGB1808...</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、HTML结构详解</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(1)&lt;!DOCTYPE HTML&gt; 文档声明, 用来声明HTML文档所遵循的HTML规范和版本</span><br><span class="line">上面是html5.0的声明, 也是目前最常用的版本</span><br><span class="line">(2)&lt;head&gt;&lt;&#x2F;head&gt; 头部分, 用来存放HTML文档的基本属性信息, 比如网页的标题, 文档使用的编码等, 这部分信息会被浏览器优先加载.</span><br><span class="line">(3)&lt;body&gt;&lt;&#x2F;body&gt; 体部分, 用来存放网页可视化数据. 即真正的网页数据</span><br><span class="line">(4)&lt;title&gt;&lt;&#x2F;title&gt; 声明网页的标题</span><br><span class="line">(5)&lt;meta charset&#x3D;&quot;utf-8&quot;&#x2F;&gt; 用来通知浏览器使用哪一个编码来打开HTML文档, 这个编码一定要和文件保存时的编码保持一致, 才不会出现中文乱码问题.</span><br></pre></td></tr></table></figure><h3 id="HTML语法-了解"><a href="#HTML语法-了解" class="headerlink" title="HTML语法(了解)"></a>HTML语法(了解)</h3><p><strong>1、html标签</strong></p><p>标签：也叫做标记、元素等，标签分为开始标签，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span>、<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>和结束标签，例如:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span>、<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><p>开始标签和结束标签之间还可以包含其他内容。</p><p>有些标签开始标签和结束标签之间没有内容要包裹，通常可以写成自闭标签，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span>/&gt;</span> <span class="tag">&lt;<span class="name">br</span>/&gt;</span> <span class="tag">&lt;<span class="name">hr</span>/&gt;</span> <span class="tag">&lt;<span class="name">input</span>/&gt;</span> <span class="tag">&lt;<span class="name">img</span>/&gt;</span>等</span><br></pre></td></tr></table></figure><p><strong>2、html属性</strong></p><p>在标签上可以声明属性(属性不能独立存在,必须声明在标签上)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"d1"</span> <span class="attr">class</span>=<span class="string">"c1"</span> <span class="attr">style</span>=<span class="string">"color:red;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>标签上可以声明多个属性，多个属性之间用空格分隔</p><p>标签上的属性的值可以使用单引号或者双引号引起来</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> <span class="attr">id</span>=<span class="string">"m1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">'UTF-8'</span> <span class="attr">id</span>=<span class="string">'m1'</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3、html注释</strong></p><p>格式:</p><p>注释的作用: (1)为代码添加解释说明</p><p>(2)将一些暂时不需要执行的代码注释</p><p>浏览器对于注释中的内容不会解析，也不会显示！</p><p><strong>4、html空格和换行</strong></p><p>在浏览器中，多个连续的空白字符（空格、制表符tab、换行）会被浏览器显示为一个空格。那么：</p><p>如何在网页中做一个换行：可以使用 <code>&lt;br/&gt;</code> 标签做换行</p><p>如何在网页中做一个空格：可以使用<code>&amp;nbsp;</code>或<code>&amp;emsp;</code>做空格</p><p>补充: HTML中是不区分大小写的！</p><p>HTML中对语法要求非常不严格！（比如大小写混用，或者标签只有开始没有结束，或者标签的不合理嵌套），但是我们在书写HTML时要按照规范来写。</p><h2 id="HTML标签"><a href="#HTML标签" class="headerlink" title="HTML标签"></a>HTML标签</h2><h3 id="图像标签"><a href="#图像标签" class="headerlink" title="图像标签"></a>图像标签</h3><p>通过img标签可以在网页中插入一副图像</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"imgs/meinv.jpg"</span> <span class="attr">width</span>=<span class="string">"50%"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>其中src属性用于指定图片的路径</p><p>width属性用于指定图片的宽度</p><p>height属性用于指定图片的高度</p><h3 id="超链接标签"><a href="#超链接标签" class="headerlink" title="超链接标签"></a>超链接标签</h3><p>超链接就是a标签，通过a标签可以在网页中创建指向另外一个文档的超链接</p><p>点击超链接可以跳转到另外一个网页(图片/下载路径等)，示例:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 跳转到本地的一个网页 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"01-第一个网页.html"</span>&gt;</span>01-第一个网页.html<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 跳转到百度首页 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span>&gt;</span>百度一下，你就不知道<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 点击图片跳转到tmooc --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"http://www.tmooc.cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">alt</span>=<span class="string">"tmooc"</span> <span class="attr">src</span>=<span class="string">"imgs/tmooc.png"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中 href 属性用于指定点击超链接后将要跳转到的URL地址</p><p>target属性用于指定以何种方式打开超链接</p><p>_self：默认值, 表示在当前窗口中打开超链接</p><p>_blank：表示在新的窗口中打开超链接</p><h3 id="表格标签"><a href="#表格标签" class="headerlink" title="表格标签"></a>表格标签</h3><p><strong>1.案例：在网页中插入一个3*3的表格</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>案例：在网页中插入一个3*3的表格<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span><span class="comment">&lt;!-- 用于在网页中定义一个表格 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span><span class="comment">&lt;!-- 用于定义一个表格行 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头3<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>11<span class="tag">&lt;/<span class="name">td</span>&gt;</span><span class="comment">&lt;!-- 用于定义一个单元格 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>12<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>13<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>21<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>22<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>23<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>31<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>32<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>33<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在浏览器中显示效果如下：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315184602647-56f644c4d6a5453380cc0b619449fafc.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870627-a956036d89235e6014307d13cef6666d.png" alt="image-20200315184602647"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200315184602647-56f644c4d6a5453380cc0b619449fafc.png" target="_blank" rel="noopener">image-20200315184602647</a></p><p><strong>在head标签内添加如下内容：</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="comment">/* style标签内只能书写css注释和css代码 */</span></span></span><br><span class="line">    table&#123;</span><br><span class="line"><span class="css">        <span class="selector-tag">border</span>:*2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>; <span class="comment">/* 为表格添加边框 */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">border-collapse</span>: <span class="selector-tag">collapse</span>; <span class="comment">/* 设置边框合并 */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">background-color</span>: <span class="selector-tag">pink</span>; <span class="comment">/* 为表格设置背景颜色 */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">width</span>: 70%; <span class="comment">/* 为表格设置宽度 */</span></span></span><br><span class="line"><span class="css">        <span class="comment">/* margin-left: 15%; */</span></span></span><br><span class="line"><span class="css">        <span class="comment">/* 设置表格的左外边距和右外边距自适应(保证两者始终相等) */</span></span></span><br><span class="line">        margin-left: auto;</span><br><span class="line">        margin-right: auto;</span><br><span class="line">    &#125;</span><br><span class="line">    td,th&#123;</span><br><span class="line"><span class="css">        <span class="selector-tag">border</span><span class="selector-pseudo">:2px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>; <span class="comment">/* 为单元格添加边框 */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">border-collapse</span>: *<span class="selector-tag">collapse</span>*; <span class="comment">/* 设置边框合并 */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">padding</span>: 5<span class="selector-tag">px</span>; <span class="comment">/* 设置单元格边框和内容的距离(内边距) */</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    h1&#123;</span><br><span class="line"><span class="css">        <span class="comment">/* border: 2px solid blue; */</span></span></span><br><span class="line"><span class="css">        <span class="selector-tag">text-align</span>: *<span class="selector-tag">center</span>*; <span class="comment">/* 设置元素中的内容水平居中 */</span></span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>再次刷新浏览器显示效果为：</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1ddd002a483c10386ecb086b0a9d3cc3-c7af9e76fe334c598f9d777f826169ab.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870627-4f659c2557925e136961ba35c3341aa1.png" alt="1ddd002a483c10386ecb086b0a9d3cc3"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1ddd002a483c10386ecb086b0a9d3cc3-c7af9e76fe334c598f9d777f826169ab.png" target="_blank" rel="noopener">1ddd002a483c10386ecb086b0a9d3cc3</a></p><p><strong>2、表格标签介绍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">table -- 用于在网页中定义一个表格</span><br><span class="line">tr -- 用于定义表格中的行</span><br><span class="line">td -- 用于定义表格中的单元格</span><br><span class="line">th -- 用于定义表头行中的单元格（th中的文本默认居中，并且加粗）</span><br></pre></td></tr></table></figure><p><strong>3、练习：使用表格标签在网页中生成一个表格，如下图：</strong></p><p>要求如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1) 表格内容如下图, 并设置表格边框</span><br><span class="line">(2) 设置单元格之间没有缝隙, 并设置单元格边框和内容之间的距离为5px</span><br><span class="line">(3) 设置表格的背景颜色为pink, 并设置表格的宽度为70%</span><br><span class="line">(4) 设置表格在网页中居中显示, 并为表格添加表头以及标题</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/9c1b6d984a6bbc1686b06afbe3f7c9eb-05e6d70d832642d3a5aa0225784bad7c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870627-a948370ad97d12399466d67f2d67d4b1.png" alt="9c1b6d984a6bbc1686b06afbe3f7c9eb"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9c1b6d984a6bbc1686b06afbe3f7c9eb-05e6d70d832642d3a5aa0225784bad7c.png" target="_blank" rel="noopener">9c1b6d984a6bbc1686b06afbe3f7c9eb</a></p><h3 id="表单标签"><a href="#表单标签" class="headerlink" title="表单标签"></a>表单标签</h3><p><strong>1、表单的作用: 用于向服务器提交数据</strong></p><p>向服务器提交数据的两种方式：</p><p><strong>(1)通过表单向服务器提交数据</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7ce4e5ec4aad8a37b48b07bf89e1fc81-438bd0e2bf4e439b8baac348419b99d4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870627-36a01498e65b2a1899250fa618a220f6.png" alt="7ce4e5ec4aad8a37b48b07bf89e1fc81"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7ce4e5ec4aad8a37b48b07bf89e1fc81-438bd0e2bf4e439b8baac348419b99d4.png" target="_blank" rel="noopener">7ce4e5ec4aad8a37b48b07bf89e1fc81</a></p><p>表单中可以包含表单项标签，在表单项中可以填写数据（比如用户名、密码等），填写完成后通过提交表单，可以将表单中的数据提交给相应的服务器。</p><p><strong>(2)通过超链接向服务器提交数据</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com?username&#x3D;张三&amp;pwd&#x3D;123&amp;like&#x3D;篮球</span><br></pre></td></tr></table></figure><p>在地址栏URL地址的后面通过问号(?)可以拼接参数，参数可以有多个，多个参数之间用<code>&amp;</code>分隔，参数还分为参数名（例如：username/pwd/like）以及参数值(例如:张三/123/篮球)，在回车后访问百度服务器的同时，就可以将问号后面拼接的参数一并带给百度服务器。</p><p><strong>2、表单标签</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"地址"</span> <span class="attr">method</span>=<span class="string">"提交方式"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中action属性用于**指定表单的提交地址，**例如，将action指向百度服务器，就意味着将来填写完表单后，提交表单将会把表单中的数据提交给百度服务器。</p><p>method=”GET/POST” 属性是用于<strong>指定表单的提交方式</strong>，常用的就是GET和POST提交。</p><h3 id="表单项标签"><a href="#表单项标签" class="headerlink" title="表单项标签"></a>表单项标签</h3><p>1、<code>input</code>元素：</p><p>(1)普通文本输入框(比如:用户名/昵称/邮箱/验证码等)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>(2)密码输入框(比如:密码/确认密码等)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>(3)单选框(比如:性别/部门等)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span>/&gt;</span>男</span><br></pre></td></tr></table></figure><p>(4)复选框/多选框(比如:爱好/岗位等)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"like"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>(5)普通按钮(比如:换一张图片)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"换一张"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>普通按钮本身没有功能,但我们可以通过js为按钮添加功能或添加行为</p><p>(6)提交按钮(比如:提交/注册/登录)</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交/注册/登录"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>提交按钮用于提交表单中的数据到服务器中!</p><p>2、<code>select、option</code>标签：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">*</span>"<span class="attr">city</span>"*&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"beijing"</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"shanghai"</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">"selected"</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>select用于定义一个下拉选框</p><p>option用于定义下拉选框上的选项</p><p>selected设置当前option选项默认被选中</p><p>3、<code>textarea</code>多行文本输入区域：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">*</span>"<span class="attr">description</span>"* <span class="attr">cols</span>=<span class="string">*</span>"<span class="attr">30</span>"* <span class="attr">rows</span>=<span class="string">*</span>"<span class="attr">5</span>"*</span></span><br><span class="line"><span class="tag"><span class="attr">placeholder</span>=<span class="string">*</span>"请输入描述信息<span class="attr">...</span>"*&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure><p>cols属性: 用于设置文本输入框的列数(宽度)</p><p>rows属性: 用于设置文本输入框的行数(高度)</p><p>placeholder属性: 设置输入框中的提示消息!</p><h3 id="表单细节问题"><a href="#表单细节问题" class="headerlink" title="表单细节问题"></a>表单细节问题</h3><p><strong>1、提交表单时，表单中的数据为什么没有被提交？</strong></p><p>对于表单中的表单项标签，只要是需要向服务器提交数据，该表单项上必须添加name属性；如果表单项标签上没有name属性，在表单提交时，该项将会别忽略。例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2、如何让多个单选框只能有一个被选中？</strong></p><p>要求多个单选框必须具有相同的name属性值，如果多个单选框name属性值相同，则说明是一个组的内容，一个组中的单选框只能选择其中的一个！</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>性别:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span>/&gt;</span>男</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span>/&gt;</span>女</span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3、为什么单选框、复选框选择某一项后提交的值都是on?</strong></p><p>因为单选框、复选框只能选择，不同于用户名、密码输入框，可以输入内容。</p><p>因此我们需要通过value属性为单选框或复选框设置提交的值(如果不设置默认值都是on)，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"male"</span>/&gt;</span>男</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"female"</span>/&gt;</span>女</span><br></pre></td></tr></table></figure><p><strong>4、如何设置单选框或复选框默认选中某一项?</strong></p><p>可以在单选框或复选框标签上添加一个checked=”checked”属性，就可以让当前单选框或复选框默认被选中。例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"male"</span>/&gt;</span>男</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"female"</span>/&gt;</span>女</span><br><span class="line"><span class="comment">&lt;!-- 爱好复选框/多选框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"like"</span> <span class="attr">value</span>=<span class="string">"basketball"</span>/&gt;</span>篮球</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">name</span>=<span class="string">"like"</span> <span class="attr">value</span>=<span class="string">"football"</span>/&gt;</span>足球</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"like"</span> <span class="attr">value</span>=<span class="string">"volleyball"</span>/&gt;</span>排球</span><br></pre></td></tr></table></figure><p><strong>5、如何设置下拉选框默认选中某一项?</strong></p><p>在option标签上添加一个selected=”selected”属性，可以让当前option选项默认被选中，例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">*</span>"<span class="attr">city</span>"*&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">"selected"</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>6、下拉选框中option选项上的value属性的作用是什么？</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"beijing"</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"shanghai"</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">"selected"</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果某一个选项被选中，并且该选项上添加了value属性，在提交表单时，将会提交value属性的值。</p><p>如果某一个选项被选中，该选项上没有添加value属性，在提交表单时，将会提交标签中的内容</p><h2 id="注册表单案例"><a href="#注册表单案例" class="headerlink" title="注册表单案例"></a>注册表单案例</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Insert title here<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css"><span class="comment">/* style标签内只能书写css注释和css代码 */</span></span></span><br><span class="line">table &#123;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>; <span class="comment">/* 为表格添加边框 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">border-collapse</span>: <span class="selector-tag">collapse</span>; <span class="comment">/* 设置边框合并 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>: <span class="selector-tag">lightgrey</span>; <span class="comment">/* 为表格设置背景颜色 */</span></span></span><br><span class="line"><span class="css"><span class="comment">/* margin-left: 15%; */</span></span></span><br><span class="line"><span class="css"><span class="comment">/* 设置表格的左外边距和右外边距自适应(保证两者始终相等) */</span></span></span><br><span class="line">margin-left: auto;</span><br><span class="line">margin-right: auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">td, th &#123;</span><br><span class="line"><span class="css"><span class="selector-tag">border</span>: 2<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-tag">red</span>; <span class="comment">/* 为单元格添加边框 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">border-collapse</span>: <span class="selector-tag">collapse</span>; <span class="comment">/* 设置边框合并 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span>: 5<span class="selector-tag">px</span>; <span class="comment">/* 设置单元格边框和内容的距离(内边距) */</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h1 &#123;</span><br><span class="line"><span class="css"><span class="comment">/* border: 2px solid blue; */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">text-align</span>: <span class="selector-tag">center</span>; <span class="comment">/* 设置元素中的内容水平居中 */</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>欢迎注册<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 用户名输入框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 密码输入框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>密码:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"pwd"</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 性别单选框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>性别:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">name</span>=<span class="string">"gender"</span></span></span><br><span class="line"><span class="tag"><span class="attr">value</span>=<span class="string">"male"</span> /&gt;</span>男 <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"female"</span> /&gt;</span>女</span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 爱好复选框/多选框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>爱好:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"like"</span> <span class="attr">value</span>=<span class="string">"basketball"</span> /&gt;</span>篮球</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">checked</span>=<span class="string">"checked"</span> <span class="attr">name</span>=<span class="string">"like"</span></span></span><br><span class="line"><span class="tag"><span class="attr">value</span>=<span class="string">"football"</span> /&gt;</span>足球 <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"like"</span></span></span><br><span class="line"><span class="tag"><span class="attr">value</span>=<span class="string">"volleyball"</span> /&gt;</span>排球<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 城市下拉选框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>城市:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"beijing"</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"shanghai"</span>&gt;</span>上海<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">selected</span>=<span class="string">"selected"</span>&gt;</span>广州<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span>&gt;</span>深圳<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 自我描述 多行文本输入框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>自我描述:<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">cols</span>=<span class="string">"30"</span> <span class="attr">rows</span>=<span class="string">"5"</span></span></span><br><span class="line"><span class="tag"><span class="attr">placeholder</span>=<span class="string">"请输入描述信息..."</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 提交按钮 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- colspan: 设置单元格横跨的列数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"2"</span> <span class="attr">style</span>=<span class="string">"text-align: center;"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag"><span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> /&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="CSS概述"><a href="#CSS概述" class="headerlink" title="CSS概述"></a>CSS概述</h2><h3 id="什么是CSS？-了解"><a href="#什么是CSS？-了解" class="headerlink" title="什么是CSS？(了解)"></a>什么是CSS？(了解)</h3><p>CSS: 层叠样式表，用于修饰、渲染网页的一门技术</p><p>使用css样式修饰网页，可以实现将设置样式的css代码和展示数据的html代码进行分离，增强了网页的展示能力！</p><h3 id="在HTML中引入CSS"><a href="#在HTML中引入CSS" class="headerlink" title="在HTML中引入CSS"></a>在HTML中引入CSS</h3><p><strong>方式1：通过style属性引入css（不推荐）</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">1.通过标签上的style属性给div设置样式 </span></span><br><span class="line"><span class="comment">边框:2px solid red </span></span><br><span class="line"><span class="comment">字体大小:26px</span></span><br><span class="line"><span class="comment">背景颜色为:pink</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"border:2px solid red;font-size:26px;background:pink;"</span>&gt;</span>这是一个div...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>由于上面这种方式是将css属性代码，直接写在标签上的style属性内部，如果属性太多，容易造成页面结构的混乱，不利于后期的维护。</p><p>并且将样式代码写在标签上，样式代码只对当前标签生效，代码无法复用！</p><p>因此不推荐使用这种方式！（这种通过style属性添加的样式，叫做行内样式/内联样式）</p><p><strong>方式2：通过style标签引入css</strong></p><p>在head标签内部可以添加一个style标签，在style标签内部可以直接书写css样式</p><p>这种方式是将所有的css属性代码集中在一个style标签内部统一管理，这种方式不会造成页面结构的混乱，并且可以实现代码的复用！</p><p>代码示例 ：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 2.通过style标签给span设置样式如下： </span></span><br><span class="line"><span class="comment">边框: 2px solid green</span></span><br><span class="line"><span class="comment">字体大小: 30px</span></span><br><span class="line"><span class="comment">字体加粗</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span></span><br><span class="line"><span class="css"><span class="comment">/* ****** CSS样式 ****** */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">span</span>&#123; <span class="comment">/* 为当前html中的所有span标签设置样式 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">border</span><span class="selector-pseudo">:2px</span> <span class="selector-tag">solid</span> <span class="selector-tag">green</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">font-size</span><span class="selector-pseudo">:30px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">font-weight</span><span class="selector-pseudo">:bolder</span>; <span class="comment">/* bold/bolder */</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方式3：通过link链接引入外部的css文件</strong></p><p>在head标签内部，通过一个link标签可以引入外部的CSS文件</p><p>这种方式是将所有的css代码集中在一个单独的css文件中统一管理，真正的实现了将css代码和html代码的分离，实现了代码的复用。</p><p>代码示例：html中引入demo.css文件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 3.通过link标签引入外部的css文件，为p元素设置样式如下： </span></span><br><span class="line"><span class="comment">边框: 2px solid blue;</span></span><br><span class="line"><span class="comment">字体颜色:red</span></span><br><span class="line"><span class="comment">字体设置为华文琥珀</span></span><br><span class="line"><span class="comment">设置首行文本缩进50px</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 引入demo.css文件(中的样式) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>  <span class="attr">href</span>=<span class="string">"demo.css"</span>  /&gt;</span></span><br></pre></td></tr></table></figure><p>demo.css文件</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@charset</span> <span class="string">"UTF-8"</span>;</span><br><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">2px</span> solid blue;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line"><span class="attribute">font-family</span>: 华文琥珀;</span><br><span class="line"><span class="attribute">text-indent</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h2><p>所谓的选择器就是能够在html中帮助我们选中元素进行修饰的一门技术。</p><h3 id="标签名选择器"><a href="#标签名选择器" class="headerlink" title="标签名选择器"></a>标签名选择器</h3><p>通过元素名称(或标签名称)选中指定名称的所有标签</p><p>格式: <strong>元素名/标签名{ css样式… }</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ----- 1.标签名选择器练习 ----- </span></span><br><span class="line"><span class="comment">将所有span标签的背景颜色设置为#efbdef, 设置字体大小为22px，字体加粗；*/</span></span><br><span class="line"><span class="selector-tag">span</span>&#123; <span class="comment">/* 选中所有的span元素 */</span></span><br><span class="line"><span class="attribute">background-color</span>:<span class="number">#efbdef</span>; </span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">22px</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bolder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="class选择器"><a href="#class选择器" class="headerlink" title="class选择器"></a>class选择器</h3><p>可以为元素添加一个通用的属性 – class，通过class属性为元素设置所属的组，class值相同的元素则为一组。通过class值可以选中这一组的元素，为元素添加样式。</p><p>格式：<strong>.class值{ css样式… }</strong></p><p>实例:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ----- 2.类选择器练习 ----- </span></span><br><span class="line"><span class="comment">(1)将所有的span（但是不包括div和p标签下的span）的背景颜色设置为#faf77b，边框改为2px solid cyan；</span></span><br><span class="line"><span class="comment">(2)将div下的span和内容为"span111"的span，背景颜色设置为#5eff1e、字体颜色设置</span></span><br><span class="line"><span class="comment">#ec0e7e；*/</span></span><br><span class="line"><span class="selector-class">.s1</span>&#123; <span class="comment">/* 选中所有class值为s1的元素 */</span></span><br><span class="line"><span class="attribute">background</span>: <span class="number">#faf77b</span>;</span><br><span class="line"><span class="attribute">border</span>: <span class="number">2px</span> solid cyan;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.s2</span>&#123; <span class="comment">/* 选中所有class值为s2的元素 */</span></span><br><span class="line"><span class="attribute">background</span>: <span class="number">#5eff1e</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#ec0e7e</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外，一个元素也可以设置多个class值，多个class值中间用空格分隔，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class&#x3D;&quot;s1 s2&quot; &gt;span111&lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure><p>表示当前元素同时属于多个分组，多个分组上设置的样式也会同时作用在当前元素上。</p><p>如果多个分组设置了相同的样式（但是值不一样），样式会发生冲突，写在后面的样式会覆盖前面的样式！</p><h3 id="id选择器"><a href="#id选择器" class="headerlink" title="id选择器"></a>id选择器</h3><p>通过标签上通用的属性id，可以为标签设置一个独一无二的编号（id值应该是唯一的），通过id值可以唯一的选中一个元素。</p><p>格式：<strong>#id值{ css样式 }</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ----- 3.id选择器练习 -----</span></span><br><span class="line"><span class="comment">用id选择器将第一个p标签设置字体大小为24px，字体颜色为#a06649, 首行文本缩进20px。*/</span></span><br><span class="line"><span class="selector-id">#p1</span>&#123; <span class="comment">/* 选中id值为p1的元素 */</span></span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">24px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#a06649</span>;</span><br><span class="line"><span class="attribute">text-indent</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="后代选择器"><a href="#后代选择器" class="headerlink" title="后代选择器"></a>后代选择器</h3><p>选中指定元素内部的指定后代元素</p><p>格式: <strong>祖先 后代{ css样式… }</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ----- 4.后代选择器练习 ----- </span></span><br><span class="line"><span class="comment">为p元素内部的所有span元素，设置字体大小为18px,字体颜色为红色,背景颜色为pink;*/</span></span><br><span class="line"><span class="selector-tag">p</span> <span class="selector-tag">span</span>&#123; <span class="comment">/* 匹配所有p元素内部的所有span元素 */</span></span><br><span class="line"><span class="attribute">font-size</span>:<span class="number">18px</span>;</span><br><span class="line"><span class="attribute">color</span>: red;</span><br><span class="line"><span class="attribute">background</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* p,span&#123;&#125; 匹配所有的p元素和所有的span元素 */</span></span><br></pre></td></tr></table></figure><h3 id="属性选择器"><a href="#属性选择器" class="headerlink" title="属性选择器"></a>属性选择器</h3><p>在选择器选中元素的基础上，根据元素的属性条件筛选/过滤元素</p><p>格式：<strong>选择器[属性条件]…{ css样式 }</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* ----- 5.属性选择器 ----- </span></span><br><span class="line"><span class="comment">为所有的文本输入框，设置背景颜色为#FF7CCC、字体大小22px，首行文本缩进15px；*/</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">'text'</span>]</span>&#123; <span class="comment">/* 匹配所有的input并且type值为text的元素 */</span></span><br><span class="line"><span class="attribute">background</span>: <span class="number">#FF7CCC</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">22px</span>;</span><br><span class="line"><span class="attribute">text-indent</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">'text'</span>]</span><span class="selector-attr">[name=<span class="string">'email'</span>]</span>&#123; </span><br><span class="line"><span class="comment">/* 选中所有的input并且type值为text、并且name为email的元素 */</span></span><br><span class="line"><span class="attribute">background </span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="常用属性总结"><a href="#常用属性总结" class="headerlink" title="常用属性总结"></a>常用属性总结</h2><h3 id="文本属性"><a href="#文本属性" class="headerlink" title="文本属性"></a>文本属性</h3><p>1、<code>text-align</code>：设置元素中文本水平对齐方式，其常用取值为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">left: 默认值。左对齐</span><br><span class="line">right: 右对齐</span><br><span class="line">center: 居中对齐</span><br><span class="line">justify: 两端对齐</span><br></pre></td></tr></table></figure><p>2、<code>text-decoration</code>：设置文本的下划线样式，其常用取值为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">underline: 有下划线</span><br><span class="line">none: 没有下划线</span><br></pre></td></tr></table></figure><p>3、<code>text-indent</code>：设置文本首行缩进，单位: 像素/百分比</p><p>4、<code>letter-spacing</code>：设置字符间隔/间距，其常用取值为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">normal</span><br><span class="line">像素值</span><br></pre></td></tr></table></figure><p>5、<code>text-shadow</code>：设置字体阴影，其取值为:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">像素值 像素值 像素值 颜色值</span><br><span class="line">第一个值为阴影水平位移，第二个值为阴影垂直位移，第三个值为阴影扩散值，第四个值为阴影颜色</span><br></pre></td></tr></table></figure><h3 id="字体属性"><a href="#字体属性" class="headerlink" title="字体属性"></a>字体属性</h3><p><code>font-size</code>：设置字体大小</p><p><code>font-weight</code>：设置字体粗细 bold、bolder、normal 100/200/300../900</p><p><code>font-family</code>：设置字体，比如微软雅黑、黑体、楷体等</p><p><code>color</code>：设置字体颜色</p><h3 id="背景属性"><a href="#背景属性" class="headerlink" title="背景属性"></a>背景属性</h3><p><code>background-color</code>：设置背景颜色</p><p><code>background-image</code>：设置背景图片，url(‘图片的路径’);</p><p><code>background-repeat</code>：设置或检索对象的背景图像是否及如何铺排，常用取值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">repeat(默认值,重复排列)</span><br><span class="line">repeat-x(横向重复排列,但纵向不重复)</span><br><span class="line">repaet-y(纵向重复排列,但横向不重复)</span><br><span class="line">no-repeat(不重复)</span><br></pre></td></tr></table></figure><p><code>background-position</code>：设置或检索对象的背景图像位置</p><p><code>background</code>: 背景颜色 背景图片 背景图片是否重复 背景图片的位置</p><h3 id="边框（border）"><a href="#边框（border）" class="headerlink" title="边框（border）"></a>边框（border）</h3><p>border:2px solid red; – 设置元素的边框(可以同时设置边框的宽度、样式、颜色)</p><p>border属性可以拆分为如下设置:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">border-width: 2px; -- 设置元素边框的宽度</span><br><span class="line">border-style: solid; -- 设置元素边框的样式</span><br><span class="line">border-color: red; -- 设置元素边框的颜色</span><br></pre></td></tr></table></figure><p>其中border-width、border-style、border-color也可以按照上右下左方向进行拆分，以border-width为例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">border-top-width: 2px; -- 设置上边框的宽度</span><br><span class="line">border-left-width: 2px; -- 设置左边框的宽度</span><br><span class="line">border-right-width: 2px; -- 设置右边框的宽度</span><br><span class="line">border-bottom-width: 2px; -- 设置下边框的宽度</span><br></pre></td></tr></table></figure><h3 id="其他属性"><a href="#其他属性" class="headerlink" title="其他属性"></a>其他属性</h3><p>width：设置元素的宽度</p><p>height：设置元素的高</p><h3 id="补充-颜色设置"><a href="#补充-颜色设置" class="headerlink" title="补充: 颜色设置"></a>补充: 颜色设置</h3><p>颜色取值方式常见的方式有三种:</p><p>方式一：设置颜色名，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">red、green、blue、yellow、cyan、pink、white、black等</span><br></pre></td></tr></table></figure><p>方式二：设置#加上六位的十六进制数值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#FF0000（red）、#00FF00（green）、#0000FF（blue）、#FFFF00（yellow）、#00FFFF（cyan）等</span><br></pre></td></tr></table></figure><p>方式三：设置rgb颜色值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rgb(255,0,0) 、rgb(0,255,0) 、rgb(0,0,255) 、rgb(255,255,0) 、rgb(0,255,255) 等</span><br><span class="line">（red） （green） （blue） （yellow） （cyan）</span><br></pre></td></tr></table></figure><h2 id="网页开发实战"><a href="#网页开发实战" class="headerlink" title="网页开发实战"></a>网页开发实战</h2><p>完成JT项目中的注册页面!(课下一定要自己独立完成!)</p><p>完成JT项目中的登录页面!(选作!)</p><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><h3 id="display属性"><a href="#display属性" class="headerlink" title="display属性"></a>display属性</h3><p>display用来设置元素的类型，常用取值：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">block：块级元素的默认值</span><br><span class="line">    默认情况下独占一行</span><br><span class="line">    可以设置宽高</span><br><span class="line">inline：行内元素的默认值</span><br><span class="line">    默认情况下多个行内元素可以处在同一行</span><br><span class="line">    一般不能设置宽高</span><br><span class="line">inline-block：行内块元素</span><br><span class="line">    多个元素既可以显示在同一行, 也可以设置宽和高</span><br><span class="line">none：表示隐藏元素</span><br></pre></td></tr></table></figure><h3 id="元素类型-了解"><a href="#元素类型-了解" class="headerlink" title="元素类型(了解)"></a>元素类型(了解)</h3><p>div/span/p 都是一个容器标签，用于包裹其他内容（这些元素本身不具备太多的样式！）</p><p>p: 块级元素，默认独占一行，用于包裹一段文本（写文章时用于p标签包裹每一段内容）</p><p>div: 块级元素，默认独占一行，用于包裹其他内容，将样式设置在div上，就可以作用在div的内容上。</p><p>span：行内元素，默认可以和其他元素显示在同一行。</p><p><strong>(1)块级元素（block）</strong></p><p>默认情况下，块级元素独占一行</p><p>可以设置宽和高，如果设置了就是设置的宽和高</p><p>如果不设置宽和高，其中宽是默认填满父元素，而高是由内容决定(由内容支撑)</p><p>比如: div/p/h1~h6/form/table 等元素都是块级元素</p><p><strong>(2)行内元素（inline）</strong></p><p>默认情况下，多个行内元素可以处在同一行</p><p>不能设置宽和高</p><p>比如: span/input/img/i/b 等元素都是行内元素</p><p><strong>(3)行内块元素（inline-block）</strong></p><p>既具备行内元素的特征(可以同行显示)，还具备块级元素的特征(可以设置宽和高)</p><h1 id="html-javaweb-css"><a href="#html-javaweb-css" class="headerlink" title="html   javaweb   css"></a><a href="https://www.zhangpeng.fun/tags/html" target="_blank" rel="noopener">html</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/css" target="_blank" rel="noopener">css</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="html" scheme="https://zpengit.github.io/tags/html/"/>
    
      <category term="css" scheme="https://zpengit.github.io/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>02-JDBC</title>
    <link href="https://zpengit.github.io/2020/06/11/02-JDBC/"/>
    <id>https://zpengit.github.io/2020/06/11/02-JDBC/</id>
    <published>2020-06-11T10:51:34.323Z</published>
    <updated>2020-06-11T10:43:33.225Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="02-JDBC"><a href="#02-JDBC" class="headerlink" title="02-JDBC"></a>02-JDBC</h1><h1 id="unit-02-JDBC"><a href="#unit-02-JDBC" class="headerlink" title="unit 02-JDBC"></a>unit 02-JDBC</h1><h2 id="JDBC概述"><a href="#JDBC概述" class="headerlink" title="JDBC概述"></a>JDBC概述</h2><h3 id="什么是JDBC？为什么要学习JDBC？"><a href="#什么是JDBC？为什么要学习JDBC？" class="headerlink" title="什么是JDBC？为什么要学习JDBC？"></a>什么是JDBC？为什么要学习JDBC？</h3><p>JDBC(Java Database Connectivity) Java数据库连接</p><p>其实就是利用Java语言/程序连接并访问数据库的一门技术</p><p>之前我们可以通过CMD或者navicat等工具连接数据库</p><p>但在企业开发中，更多的是通过程序（Java程序）连接并访问数据库，通过Java程序访问数据库，就需要用到JDBC这门技术。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/5fa0f308f5ff06beac3c7f18614c9ff3-36646ee82ae54b7598c113a5e46b2793.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-cee5faeba555e58abf9e043de84f01e4.png" alt="5fa0f308f5ff06beac3c7f18614c9ff3"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/5fa0f308f5ff06beac3c7f18614c9ff3-36646ee82ae54b7598c113a5e46b2793.png" target="_blank" rel="noopener">5fa0f308f5ff06beac3c7f18614c9ff3</a></p><h3 id="如何通过JDBC程序访问数据库"><a href="#如何通过JDBC程序访问数据库" class="headerlink" title="如何通过JDBC程序访问数据库?"></a>如何通过JDBC程序访问数据库?</h3><p><strong>1、提出需求：</strong></p><p>创建一个 jt_db 数据库，在库中创建一个account表，并插入三条记录，然后利用Java程序查询出account表中所有的记录，并将查询的结果打印在控制台上。</p><p><strong>2、开发步骤:</strong></p><p>(1)准备数据, 创建jt_db库, 创建account表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">drop database if exists jt_db;</span><br><span class="line">create database jt_db charset utf8;</span><br><span class="line">    use jt_db;</span><br><span class="line">    create table account(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    name varchar(50),</span><br><span class="line">    money double</span><br><span class="line">);</span><br><span class="line">insert into account values(null, &#39;tom&#39;, 1000);</span><br><span class="line">insert into account values(null, &#39;andy&#39;, 1000);</span><br><span class="line">insert into account values(null, &#39;tony&#39;, 1000);</span><br></pre></td></tr></table></figure><p>如果已经执行过课前资料中的”SQL脚本文件”，此步骤可以跳过。</p><p>(2)创建JAVA工程：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200318153229937-6d6d876ffb7f4c85864e1fdb9e717760.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-4371bb5d2e510f12cd8f085d61e0e2be.png" alt="image-20200318153229937"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200318153229937-6d6d876ffb7f4c85864e1fdb9e717760.png" target="_blank" rel="noopener">image-20200318153229937</a></p><p>(3)导入jar包——mysql驱动包：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200318153627820-7cab5f474b3944a3800b7a5166a3e0c8.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-0856f3316fbaccf0652584bfb8b776bb.png" alt="image-20200318153627820"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200318153627820-7cab5f474b3944a3800b7a5166a3e0c8.png" target="_blank" rel="noopener">image-20200318153627820</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6ba3042ef2947f314836128a5c19e2c2-50a469974ae14538a65c6aeee25510fe.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-50ec741be1eb7b08ba930d3a0f0c4222.png" alt="6ba3042ef2947f314836128a5c19e2c2"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6ba3042ef2947f314836128a5c19e2c2-50a469974ae14538a65c6aeee25510fe.png" target="_blank" rel="noopener">6ba3042ef2947f314836128a5c19e2c2</a></p><p>(4)创建类并实现JDBC程序(六个步骤)</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/dccd4a8163b4835b74e77f945d106683-95c22103a92448a68229581864b5a96c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-a56ad0e89b3ddbd0842eece6792671fb.png" alt="dccd4a8163b4835b74e77f945d106683"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/dccd4a8163b4835b74e77f945d106683-95c22103a92448a68229581864b5a96c.png" target="_blank" rel="noopener">dccd4a8163b4835b74e77f945d106683</a></p><p>代码实现:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">//1.注册数据库驱动</span></span><br><span class="line">    Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">    <span class="comment">//2.获取数据库连接</span></span><br><span class="line">    Connection conn = DriverManager.getConnection(</span><br><span class="line">        <span class="string">"jdbc:mysql://localhost:3306/jt_db?characterEncoding=utf-8"</span>,</span><br><span class="line">        <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">    <span class="comment">//3.获取传输器</span></span><br><span class="line">    Statement stat = conn.createStatement();</span><br><span class="line">    <span class="comment">//4.发送SQL到服务器执行并返回执行结果</span></span><br><span class="line">    String sql = <span class="string">"select * from account"</span>;</span><br><span class="line">    ResultSet rs = stat.executeQuery( sql );</span><br><span class="line">    <span class="comment">//5.处理结果</span></span><br><span class="line">    <span class="keyword">while</span>( rs.next() ) &#123;</span><br><span class="line">        <span class="keyword">int</span> id = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">        String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line">        <span class="keyword">double</span> money = rs.getDouble(<span class="string">"money"</span>);</span><br><span class="line">        System.out.println(id+<span class="string">" : "</span>+name+<span class="string">" : "</span>+money);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//6.释放资源</span></span><br><span class="line">    rs.close();</span><br><span class="line">    stat.close();</span><br><span class="line">    conn.close();</span><br><span class="line">    System.out.println(<span class="string">"TestJdbc.main()...."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3、执行结果:</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a37ab7234bb1beb988f4b9c01c8cee2f-451bed389d2b43b5849c80244c088cd8.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-1e772876b8c1a0cbd80c1a0d69c8007d.png" alt="a37ab7234bb1beb988f4b9c01c8cee2f"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/a37ab7234bb1beb988f4b9c01c8cee2f-451bed389d2b43b5849c80244c088cd8.png" target="_blank" rel="noopener">a37ab7234bb1beb988f4b9c01c8cee2f</a></p><h3 id="JDBC-API总结"><a href="#JDBC-API总结" class="headerlink" title="JDBC API总结"></a>JDBC API总结</h3><p><strong>1、注册数据库驱动</strong></p><p>Class.forName(“com.mysql.jdbc.Driver”);</p><p>所谓的注册驱动，就是让JDBC程序加载mysql驱动程序，并管理驱动</p><p>驱动程序实现了JDBC API定义的接口以及和数据库服务器交互的功能，加载驱动是为了方便使用这些功能。</p><p><strong>2、获取连接之数据库URL</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = DriverManager.getConnection(</span><br><span class="line">    <span class="string">"jdbc:mysql://localhost:3306/jt_db?characterEncoding=utf-8"</span>,</span><br><span class="line">    <span class="string">"root"</span>, <span class="string">"root"</span> );</span><br></pre></td></tr></table></figure><p>DriverManager.getConnection() 用于获取数据连接，返回的Connection连接对象是JDBC程序连接数据库至关重要的一个对象。</p><p><strong>参数2</strong>和<strong>参数3</strong>分别是所连接数据库的用户名和密码。</p><p><strong>参数1</strong>：”jdbc:mysql://localhost:3306/jt_db” 是连接数据库的URL，用于指定访问哪一个位置上的数据库服务器及服务器中的哪一个数据库，其写法为:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7edb0faa5fac5f29cd19411909c708cb-4c7e5b40334646668d3c2cd10b2d7cf4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-5fa1e779a6392c9120c9d4b03cddec32.png" alt="7edb0faa5fac5f29cd19411909c708cb"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7edb0faa5fac5f29cd19411909c708cb-4c7e5b40334646668d3c2cd10b2d7cf4.png" target="_blank" rel="noopener">7edb0faa5fac5f29cd19411909c708cb</a></p><p>当连接本地数据库，并且端口为3306，可以简写为如下形式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql:&#x2F;&#x2F;&#x2F;jt_db</span><br></pre></td></tr></table></figure><p><strong>3、Statement传输器对象</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Statement stat &#x3D; conn.createStatement();</span><br><span class="line">该方法返回用于向数据库服务器发送sql语句的Statement传输器对象</span><br></pre></td></tr></table></figure><p>该对象上提供了发送sql的方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">executeQuery(String sql) --</span><br><span class="line">用于向数据库发送查询类型的sql语句，返回一个ResultSet对象中</span><br><span class="line">executeUpdate(String sql) --</span><br><span class="line">用于向数据库发送更新(增加、删除、修改)类型的sql语句，返回一个int值，表示影响的记录行数</span><br></pre></td></tr></table></figure><p><strong>4、ResultSet结果集对象</strong></p><p>ResultSet对象用于封装sql语句查询的结果，也是一个非常重要的对象。该对象上提供了遍历数据及获取数据的方法。</p><p>(1)遍历数据行的方法</p><p>next() – 使指向数据行的箭头向下移动一行，并返回一个布尔类型的结果，true表示箭头指向了一行数据，false表示箭头没有指向任何数据（后面也没有数据了）</p><p>(2)获取数据的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">getInt(<span class="keyword">int</span> columnIndex)</span><br><span class="line">getInt(String columnLable)</span><br><span class="line">getString(<span class="keyword">int</span> columnIndex)</span><br><span class="line">getString(String columnLable)</span><br><span class="line">getDouble(<span class="keyword">int</span> columnIndex)</span><br><span class="line">getDouble(String columnLable)</span><br><span class="line">getObject(<span class="keyword">int</span> columnIndex)</span><br><span class="line">getObject(String columnLable)</span><br></pre></td></tr></table></figure><p><strong>5、释放资源</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rs.close();</span><br><span class="line">stat.close();</span><br><span class="line">conn.close();</span><br></pre></td></tr></table></figure><p>此处释放资源必须按照一定的顺序释放，越晚获取的越先关闭。所以先关闭<br>rs对象，再关闭stat对象，最后关闭conn对象。</p><p>另，为了避免上面的程序抛出异常，释放资源的代码不会执行，应该把释放资源的代码放在finally块中.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">...</span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rs != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        rs.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            rs = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (stat != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        stat.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            stat = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (conn != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">        conn.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            conn = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h2><p><strong>1、新增:往account表中添加一个名称为john、money为3500的记录</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 1、新增:往account表中添加一个名称为john、money为3500的记录 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//获取传输器</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line"><span class="comment">//发送sql语句到服务器执行,并返回执行结果</span></span><br><span class="line">String sql = <span class="string">"insert into account values(null, 'john', 3500)"</span>;</span><br><span class="line"><span class="keyword">int</span> rows = stat.executeUpdate( sql );</span><br><span class="line"><span class="comment">//处理结果</span></span><br><span class="line">System.out.println( <span class="string">"影响行数: "</span>+rows );</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//通过JdbcUtil工具类中的close方法释放资源</span></span><br><span class="line">JdbcUtil.close(conn, stat, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2、修改:将account表中名称为john的记录，money修改为1500</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 2、修改:将account表中名称为john的记录，money修改为1500 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//获取传输器</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line"><span class="comment">//发送sql语句到服务器执行,并返回执行结果</span></span><br><span class="line">String sql = <span class="string">"update account set money=1500 where name='john'"</span>;</span><br><span class="line"><span class="keyword">int</span> rows = stat.executeUpdate( sql );</span><br><span class="line"><span class="comment">//处理结果</span></span><br><span class="line">System.out.println( <span class="string">"影响行数: "</span>+rows );</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//通过JdbcUtil工具类中的close方法释放资源</span></span><br><span class="line">JdbcUtil.close(conn, stat, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3、查询:查询account表中名称为john的记录</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 3、查询:查询account表中id为1的记录 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//获取传输器</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line"><span class="comment">//执行sql语句,返回执行结果</span></span><br><span class="line">String sql = <span class="string">"select * from account where id=1"</span>;</span><br><span class="line">rs = stat.executeQuery( sql );</span><br><span class="line"><span class="comment">//处理结果</span></span><br><span class="line"><span class="keyword">if</span>( rs.next() ) &#123;</span><br><span class="line"><span class="keyword">int</span> id = rs.getInt(<span class="string">"id"</span>);</span><br><span class="line">String name = rs.getString(<span class="string">"name"</span>);</span><br><span class="line"><span class="keyword">double</span> money = rs.getDouble(<span class="string">"money"</span>);</span><br><span class="line">System.out.println( id+<span class="string">" : "</span>+name+<span class="string">" : "</span>+money);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">JdbcUtil.close(conn, stat, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4、删除:删除account表中名称为john的记录</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 4、删除:删除account表中名称为john的记录 */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//获取传输器</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line"><span class="comment">//发送sql语句到服务器执行,并返回执行结果</span></span><br><span class="line">String sql = <span class="string">"delete from account where name='john'"</span>;</span><br><span class="line"><span class="keyword">int</span> rows = stat.executeUpdate( sql );</span><br><span class="line"><span class="comment">//处理结果</span></span><br><span class="line">System.out.println( <span class="string">"影响行数: "</span>+rows );</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//通过JdbcUtil工具类中的close方法释放资源</span></span><br><span class="line">JdbcUtil.close(conn, stat, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>内容补充：使用单元测试测试上面的方法</p><p>单元测试：不用创建新的类，也不用提供main函数，也不用创建类的实例，就可以直接执行一个方法。能使用单元测试测试的方法需要满足以下几点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">（1）方法必须是公共的</span><br><span class="line">（2）方法必须是非静态的</span><br><span class="line">（3）方法必须是无返回值的</span><br><span class="line">（4）方法必须是无参数的</span><br></pre></td></tr></table></figure><h2 id="PreparedStatement"><a href="#PreparedStatement" class="headerlink" title="PreparedStatement"></a>PreparedStatement</h2><p>在上面的增删改查的操作中，使用的是Statement传输器对象，而在开发中我们用的更多的传输器对象是PreparedStatement对象，PreparedStatement是Statement的子接口，比Statement更加安全，并且能够提高程序执行的效率。</p><p>Statement 父对象</p><p>PreparedStatement 子对象</p><h3 id="模拟用户登录案例"><a href="#模拟用户登录案例" class="headerlink" title="模拟用户登录案例"></a>模拟用户登录案例</h3><p>(1)准备数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> jt_db;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    username <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    <span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'张三'</span>,<span class="string">'123'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span> <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'李四'</span>,<span class="string">'234'</span>);</span><br></pre></td></tr></table></figure><p>(2)创建LoginUser 类，提供 main 方法 和 login 方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"><span class="comment">/* 1、提示用户登录，提示用户输入用户名并接收用户名</span></span><br><span class="line"><span class="comment"> *  2、提示用户输入密码并接收密码</span></span><br><span class="line"><span class="comment"> *  3、根据用户名和密码查询用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// 1、提示用户登录，提示用户输入用户名并接收用户名</span></span><br><span class="line">Scanner sc = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">System.out.println( <span class="string">"请登录："</span> );</span><br><span class="line">System.out.println( <span class="string">"请输入用户名："</span> );</span><br><span class="line">String user = sc.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2、提示用户输入密码并接收密码</span></span><br><span class="line">System.out.println( <span class="string">"请输入密码："</span> );</span><br><span class="line">String pwd = sc.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3、根据用户名和密码查询用户信息</span></span><br><span class="line">login( user, pwd );</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名和密码查询用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user 用户名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pwd 密码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String pwd)</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">Statement stat = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//1.注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//2.获取传输器，执行sql并返回执行结果</span></span><br><span class="line">stat = conn.createStatement();</span><br><span class="line">String sql = <span class="string">"select * from user where username='"</span>+user+<span class="string">"' and password='"</span>+pwd+<span class="string">"'"</span>;</span><br><span class="line">rs = stat.executeQuery(sql);</span><br><span class="line">System.out.println( sql );</span><br><span class="line"><span class="comment">//3.处理结果</span></span><br><span class="line"><span class="keyword">if</span>( rs.next() ) &#123; <span class="comment">//有数据 -- 用户名密码都正确</span></span><br><span class="line">System.out.println(<span class="string">"恭喜您登录成功!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123; <span class="comment">//没数据 -- 用户名或密码不正确</span></span><br><span class="line">System.out.println(<span class="string">"登录失败, 用户名或密码不正确!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//4.释放资源</span></span><br><span class="line">JdbcUtil.close(conn, stat, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>执行时，输入：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">请登录：</span><br><span class="line">请输入用户名：</span><br><span class="line">张飞&#39;#&#39;</span><br><span class="line">请输入密码：</span><br><span class="line"></span><br><span class="line">select * from user where username&#x3D;&#39;张飞&#39;#&#39;&#39; and password&#x3D;&#39;&#39;</span><br><span class="line">恭喜您登录成功了!</span><br></pre></td></tr></table></figure><p><strong>或输入</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">请登录：</span><br><span class="line">请输入用户名：</span><br><span class="line">张飞&#39; or &#39;1&#x3D;1</span><br><span class="line">请输入密码：</span><br><span class="line"></span><br><span class="line">select * from user where username&#x3D;&#39;张飞&#39; or &#39;1&#x3D;1&#39; and password&#x3D;&#39;&#39;</span><br><span class="line">恭喜您登录成功了!</span><br></pre></td></tr></table></figure><p><strong>或输入</strong>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">请登录：</span><br><span class="line">请输入用户名：</span><br><span class="line"></span><br><span class="line">请输入密码：</span><br><span class="line">&#39; or &#39;2&#x3D;2</span><br><span class="line">select * from user where username&#x3D;&#39;&#39; and password&#x3D;&#39;&#39; or &#39;2&#x3D;2&#39;</span><br><span class="line">恭喜您登录成功了!</span><br></pre></td></tr></table></figure><h3 id="SQL注入攻击"><a href="#SQL注入攻击" class="headerlink" title="SQL注入攻击"></a>SQL注入攻击</h3><p>通过上面的案例，我们发现在执行时，不输入密码只输入用户名也可以登陆成功。这就是SQL注入攻击。</p><p>SQL注入攻击产生的原因: 由于后台执行的SQL语句是拼接而来的：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username&#x3D;&#39;&quot;+user+&quot;&#39; and password&#x3D;&#39;&quot;+pwd+&quot;&#39;</span><br></pre></td></tr></table></figure><p>其中的参数是用户提交过来的，如果用户在提交参数时，在参数中掺杂了一些SQL关键字（比如or）或者特殊符号（#、– 、’ 等），就可能会导致SQL语句语义的变化，从而执行一些意外的操作（用户名或密码不正确也能登录成功）！</p><h3 id="防止SQL注入攻击"><a href="#防止SQL注入攻击" class="headerlink" title="防止SQL注入攻击"></a>防止SQL注入攻击</h3><p>如何防止SQL注入攻击？</p><p>(1)使用正则表达式对用户提交的参数进行校验。如果参数中有（# – ‘ or等）这些符号就直接结束程序，通知用户输入的参数不合法</p><p>(2)使用PreparedStatement对象来替代Statement对象。</p><p>下面通过第二种方式解决SQL注入攻击：添加loginByPreparedSatement方法，在方法中，使用PreparedStatement来代替Statement作为传输器对象使用，代码示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据用户名和密码查询用户信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user 用户名</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pwd 密码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(String user, String pwd)</span> </span>&#123;</span><br><span class="line">Connection conn = <span class="keyword">null</span>;</span><br><span class="line">PreparedStatement ps = <span class="keyword">null</span>;</span><br><span class="line">ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="comment">//1.注册驱动并获取连接</span></span><br><span class="line">conn = JdbcUtil.getConn();</span><br><span class="line"><span class="comment">//2.获取传输器，执行sql并返回执行结果</span></span><br><span class="line">String sql = <span class="string">"select * from user where username=? and password=?"</span>;</span><br><span class="line">ps = conn.prepareStatement( sql );</span><br><span class="line"><span class="comment">//设置SQL语句中的参数</span></span><br><span class="line">ps.setString( <span class="number">1</span> , user );</span><br><span class="line">ps.setString( <span class="number">2</span> , pwd );</span><br><span class="line"><span class="comment">//执行SQL语句</span></span><br><span class="line">rs = ps.executeQuery();<span class="comment">//这里不要再传输SQL语句</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.处理结果</span></span><br><span class="line"><span class="keyword">if</span>( rs.next() ) &#123; <span class="comment">//有数据 -- 用户名密码都正确</span></span><br><span class="line">System.out.println(<span class="string">"恭喜您登录成功!"</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123; <span class="comment">//没数据 -- 用户名或密码不正确</span></span><br><span class="line">System.out.println(<span class="string">"登录失败, 用户名或密码不正确!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">//4.释放资源</span></span><br><span class="line">JdbcUtil.close(conn, ps, rs);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再次执行程序，按照上面的操作登录。此时，已经成功的防止了SQL注入攻击问题了。</p><p>PreparedStatement对象是如何防止SQL注入攻击的：</p><p>使用PreparedStatement对象是先将SQL语句的骨架发送给服务器编译，编译之后SQL语句的骨架和语义就不会再被改变了，再将SQL语句中的参数发送给服务器，即使参数中再包含SQL关键字或者特殊符号，也不会导致SQL的骨架或语义被改变，只会被当作普通的文本来处理！</p><hr><p>使用PreparedStatement对象可以防止SQL注入攻击</p><p>而且通过方法设置参数更加的方便且不易出错!</p><p>还可以从某些方面提高程序执行的效率!</p><h3 id="单元测试补充："><a href="#单元测试补充：" class="headerlink" title="单元测试补充："></a>单元测试补充：</h3><p>加了@Test注解的方法，可以通过单元测试（junit）框架测试该方法。底层会创建该方法所在类的实例，通过实例调用该方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">System.out.println(<span class="string">"TestPreparedStatement.testInsert()"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>能够使用@Test单元测试测试的方法必须满足如下几个条件:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(1)方法必须是公共的</span><br><span class="line">(2)方法必须是非静态的</span><br><span class="line">(3)方法必须是无返回值的</span><br><span class="line">(4)方法必须是无参数的</span><br></pre></td></tr></table></figure><h2 id="数据库连接池"><a href="#数据库连接池" class="headerlink" title="数据库连接池"></a>数据库连接池</h2><h3 id="什么是连接池"><a href="#什么是连接池" class="headerlink" title="什么是连接池"></a>什么是连接池</h3><p>池：指内存中的一片空间（容器，比如数组、集合）</p><p>连接池：就是将连接存放在容器中，供整个程序共享，可以实现连接的复用，减少连接创建和关闭的次数，从而提高程序执行的效率！</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d30da01edb7ccc007425c91328373339-9c919d411a8c4048a46b5f873a988a41.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-3e67de30be635d8631be96ec95fa316a.png" alt="d30da01edb7ccc007425c91328373339"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d30da01edb7ccc007425c91328373339-9c919d411a8c4048a46b5f873a988a41.png" target="_blank" rel="noopener">d30da01edb7ccc007425c91328373339</a></p><h3 id="为什么要使用连接池"><a href="#为什么要使用连接池" class="headerlink" title="为什么要使用连接池"></a>为什么要使用连接池</h3><p><strong>1、传统方式操作数据库</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ed6ceb2908a9c2a66c3336a651056ce0-3a68c4bb5a094c9fb065d6c9b84d9133.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-0c3d285b25776a4ba1094f7d6e9994c9.png" alt="ed6ceb2908a9c2a66c3336a651056ce0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/ed6ceb2908a9c2a66c3336a651056ce0-3a68c4bb5a094c9fb065d6c9b84d9133.png" target="_blank" rel="noopener">ed6ceb2908a9c2a66c3336a651056ce0</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Connection conn &#x3D; DriverManager.getConnection( url, user, pwd ); </span><br><span class="line">&#x2F;&#x2F;创建连接对象</span><br><span class="line">conn.close(); &#x2F;&#x2F;关闭连接, 销毁连接</span><br></pre></td></tr></table></figure><p>在传统方式中，每次用户需要连接访问数据库时，都是创建一个连接对象，基于这个连接对象访问数据库，用完连接后，会将连接关闭（conn.close）。</p><p>由于每次创建连接和关闭连接非常的耗时间而且耗资源因此效率低下。</p><p><strong>2、使用连接池操作数据库</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b7566731966b48e3d918bbd205d30030-06a67c0256f14746af53b0ed3d360b26.jpg" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-ef71c7f4efe2c45720ed00205423dffd.jpg" alt="b7566731966b48e3d918bbd205d30030"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/b7566731966b48e3d918bbd205d30030-06a67c0256f14746af53b0ed3d360b26.jpg" target="_blank" rel="noopener">b7566731966b48e3d918bbd205d30030</a></p><p>可以在程序一启动时，就创建一批连接放在一个连接池中（容器），当用户需要连接时，就从连接池中获取一个连接对象，用完连接后，不要关闭，而是将连接再还回连接池中，这样一来，用来用去都是池中的这一批连接，实现了连接的服用，减少了连接创建和关闭的次数，从而提高了程序执行的效率！</p><h3 id="如何使用C3P0连接池"><a href="#如何使用C3P0连接池" class="headerlink" title="如何使用C3P0连接池"></a>如何使用C3P0连接池</h3><p>dbcp/c3p0/druid</p><p>使用C3P0连接池开发步骤：</p><p><strong>1、导入开发包</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d9837a8227847f3e22aa28a9e5bf6aa5-0928bb9ea4e147be8fd15072a5ed8663.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-2133c13e332a2b5b4d862da851795f0a.png" alt="d9837a8227847f3e22aa28a9e5bf6aa5"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d9837a8227847f3e22aa28a9e5bf6aa5-0928bb9ea4e147be8fd15072a5ed8663.png" target="_blank" rel="noopener">d9837a8227847f3e22aa28a9e5bf6aa5</a></p><p><strong>2、创建数据库连接池(对象)</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ComboPooledDataSource cpds = <span class="keyword">new</span> ComboPooledDataSource();</span><br></pre></td></tr></table></figure><p><strong>3、设置连接数据库的基本信息</strong></p><p>(1)方式一：(不推荐) 直接将参数通过 pool.setXxx方法设置给c3p0程序</p><p>这种方式直接将参数写死在了程序中，后期一旦参数发生变化，就要修改程序，要重新编译项目、重新发布项目，非常麻烦。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置连接数据库的基本信息</span></span><br><span class="line">pool.setDriverClass( <span class="string">"com.mysql.jdbc.Driver"</span> );</span><br><span class="line">pool.setJdbcUrl( <span class="string">"jdbc:mysql:///jt_db?characterEncoding=utf-8"</span> );</span><br><span class="line">pool.setUser( <span class="string">"root"</span> );</span><br><span class="line">pool.setPassword( <span class="string">"root"</span> );</span><br></pre></td></tr></table></figure><p>(2)方式二：将连接参数提取到properties文件中(推荐)</p><p>在类目录下(开发时可以放在src或者类似的源码目录下)，添加一个c3p0.properties文件，配置内容如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">c3p0.driverClass</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">c3p0.jdbcUrl</span>=<span class="string">jdbc:mysql:///jt_db?characterEncoding=utf-8</span></span><br><span class="line"><span class="meta">c3p0.user</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">c3p0.password</span>=<span class="string">root</span></span><br></pre></td></tr></table></figure><p>这种方式由于是c3p0到指定的位置下寻找指定名称的properties文件，所以文件的位置必须是放在src或其他源码根目录下，文件名必须是c3p0.properties。</p><p>(3)方式三：(推荐)</p><p>在类目录下(开发时可以放在src或者类似的源码目录下)，添加一个c3p0-config.xml文件，配置内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">default-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span></span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"jdbcUrl"</span>&gt;</span>jdbc:mysql:///jt_db?characterEncoding=utf-8<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">default-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这种方式由于是c3p0到指定的位置下寻找指定名称的xml文件，所以文件的位置必须是放在src或其他源码根目录下，文件名必须是c3p0-config.xml。</p><p><strong>4、从连接池中获取一个连接对象并进行使用</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = pool.getConnection();</span><br></pre></td></tr></table></figure><p><strong>5、用完连接后将连接还回连接池中</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">JdbcUtil.*close*(conn, ps, rs);</span><br><span class="line"><span class="comment">/* 如果是自己创建的连接对象，这个连接对象没有经过任何的改动，调用</span></span><br><span class="line"><span class="comment">* conn.close方法，是将连接对象关闭</span></span><br><span class="line"><span class="comment">* 如果是从连接池中获取的连接对象，该连接对象在返回时就已经被连接池</span></span><br><span class="line"><span class="comment">* 改造了，将连接对象的close方法改为了还连接到连接池中</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="扩展：切换工作空间，修改默认编码"><a href="#扩展：切换工作空间，修改默认编码" class="headerlink" title="扩展：切换工作空间，修改默认编码"></a>扩展：切换工作空间，修改默认编码</h2><h3 id="切换新的工作空间，设置工作空间编码为utf-8"><a href="#切换新的工作空间，设置工作空间编码为utf-8" class="headerlink" title="切换新的工作空间，设置工作空间编码为utf-8"></a>切换新的工作空间，设置工作空间编码为utf-8</h3><p>(1)切换到新的工作空间目的:<br>若旧的工作空间内容过多，可能会导致eclipse不编译，甚至进入休眠状态。</p><p>(2)设置工作空间编码为utf-8，此后在当前工作空间下创建的项目编码也默认是utf-8。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eabc894e645afd2837f6fdbcd735eb89-de9ed383140848e08fc09cee4655641d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-f39998cb8d770c8d705746e5fd3fc67d.png" alt="eabc894e645afd2837f6fdbcd735eb89"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/eabc894e645afd2837f6fdbcd735eb89-de9ed383140848e08fc09cee4655641d.png" target="_blank" rel="noopener">eabc894e645afd2837f6fdbcd735eb89</a></p><h3 id="设置JSP文件的编码为utf-8"><a href="#设置JSP文件的编码为utf-8" class="headerlink" title="设置JSP文件的编码为utf-8"></a>设置JSP文件的编码为utf-8</h3><p><a href="https://www.zhangpeng.fun/upload/2020/06/8c92de12e98e8b773abbb41133baef4e-f22ce5799ba243f99003193443c9c722.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-16087e804b69b1ab0712d163c58fa37c.png" alt="8c92de12e98e8b773abbb41133baef4e"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/8c92de12e98e8b773abbb41133baef4e-f22ce5799ba243f99003193443c9c722.png" target="_blank" rel="noopener">8c92de12e98e8b773abbb41133baef4e</a></p><h2 id="扩展：JDBC实现学生信息管理系统"><a href="#扩展：JDBC实现学生信息管理系统" class="headerlink" title="扩展：JDBC实现学生信息管理系统"></a>扩展：JDBC实现学生信息管理系统</h2><h3 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h3><p>建库建表语句如下：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、创建数据库jt_db数据库(如果不存在才创建)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> jt_db <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="keyword">use</span> jt_db; <span class="comment">-- 选择jt_db数据库</span></span><br><span class="line"><span class="comment">-- 2、在 jt_db 库中创建 stu 表(学生表)</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> stu;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">2</span>),</span><br><span class="line">    addr <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    score <span class="keyword">double</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 3、往 stu 表中, 插入记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stu <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'张三'</span>,<span class="string">'男'</span>, <span class="string">'北京'</span>, <span class="number">86</span>);</span><br></pre></td></tr></table></figure><h3 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h3><p>运行程序控制台提示如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b9ad722dca6065b01a5202f85e2d89c-182a896372ee4ee4bd49583dd80b7bd9.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-7d8e6e4c4930d7648836090674fcd9ff.png" alt="4b9ad722dca6065b01a5202f85e2d89c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b9ad722dca6065b01a5202f85e2d89c-182a896372ee4ee4bd49583dd80b7bd9.png" target="_blank" rel="noopener">4b9ad722dca6065b01a5202f85e2d89c</a></p><p>输入a：查询所有学生信息</p><p>输入b：添加学生信息</p><p>输入c：根据id修改学生信息</p><p>输入d：根据id删除学生信息</p><h3 id="查询所有学生信息"><a href="#查询所有学生信息" class="headerlink" title="查询所有学生信息"></a>查询所有学生信息</h3><p>在控制台中输入操作代码”a”，效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/55a1ab054846de0d92525b6292f7b930-24e69efc97fa410382864e98e56cfc8d.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-d99e79967582a868584931572efc0e11.png" alt="55a1ab054846de0d92525b6292f7b930"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/55a1ab054846de0d92525b6292f7b930-24e69efc97fa410382864e98e56cfc8d.png" target="_blank" rel="noopener">55a1ab054846de0d92525b6292f7b930</a></p><h3 id="添加学生信息"><a href="#添加学生信息" class="headerlink" title="添加学生信息"></a>添加学生信息</h3><p>在控制台中输入操作代码”b”，效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c9f2e18f2a41668cd39ddaccd712290c-54b6cc48ddfe4e91aeada2239e95d17c.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-6271a128c8a88ec52f0ede88625dc8ee.png" alt="c9f2e18f2a41668cd39ddaccd712290c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/c9f2e18f2a41668cd39ddaccd712290c-54b6cc48ddfe4e91aeada2239e95d17c.png" target="_blank" rel="noopener">c9f2e18f2a41668cd39ddaccd712290c</a></p><h3 id="根据id修改学生信息"><a href="#根据id修改学生信息" class="headerlink" title="根据id修改学生信息"></a>根据id修改学生信息</h3><p>在控制台中输入操作代码”c”，效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/40de75c8a4f08fc4a4b581b358be6a87-ba847310e5544893b59fa7d80c3a14e2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-b51d50ed00b76525e7553b1d7969b0a7.png" alt="40de75c8a4f08fc4a4b581b358be6a87"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/40de75c8a4f08fc4a4b581b358be6a87-ba847310e5544893b59fa7d80c3a14e2.png" target="_blank" rel="noopener">40de75c8a4f08fc4a4b581b358be6a87</a></p><h3 id="根据id删除学生信息"><a href="#根据id删除学生信息" class="headerlink" title="根据id删除学生信息"></a>根据id删除学生信息</h3><p>在控制台中输入操作代码”d”，效果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9eda8bae1797eced35a1e4907009db83-9607136f386a4d789b2a73795afee68e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870560-2082bdd7cd527b875e1ff5fdc1c0bc19.png" alt="9eda8bae1797eced35a1e4907009db83"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/9eda8bae1797eced35a1e4907009db83-9607136f386a4d789b2a73795afee68e.png" target="_blank" rel="noopener">9eda8bae1797eced35a1e4907009db83</a></p><h1 id="javaweb-jdbc"><a href="#javaweb-jdbc" class="headerlink" title="javaweb   jdbc"></a><a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a>   <a href="https://www.zhangpeng.fun/tags/jdbc" target="_blank" rel="noopener">jdbc</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="jdbc" scheme="https://zpengit.github.io/tags/jdbc/"/>
    
  </entry>
  
  <entry>
    <title>01-MySQL</title>
    <link href="https://zpengit.github.io/2020/06/11/01-MySQL/"/>
    <id>https://zpengit.github.io/2020/06/11/01-MySQL/</id>
    <published>2020-06-11T10:48:58.485Z</published>
    <updated>2020-06-11T10:43:19.188Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="01-MySQL"><a href="#01-MySQL" class="headerlink" title="01-MySQL"></a>01-MySQL</h1><h1 id="unit-01-MySQL"><a href="#unit-01-MySQL" class="headerlink" title="unit 01-MySQL"></a>unit 01-MySQL</h1><h2 id="数据库概述"><a href="#数据库概述" class="headerlink" title="数据库概述"></a>数据库概述</h2><h3 id="什么是数据库？"><a href="#什么是数据库？" class="headerlink" title="什么是数据库？"></a>什么是数据库？</h3><p>所谓的数据库就是指存储和管理数据的仓库</p><p>扩展内容1：数据库有哪些分类？(了解)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">早期: 层次式数据库、网络型数据库</span><br><span class="line">现在：关系型数据库、非关系型数据库</span><br></pre></td></tr></table></figure><h3 id="什么是关系型数据库？"><a href="#什么是关系型数据库？" class="headerlink" title="什么是关系型数据库？"></a>什么是关系型数据库？</h3><p>底层以二维表的形式保存数据的库就是关系型数据库</p><p>stu-学生表</p><table><thead><tr><th>学生编号</th><th>姓名</th><th>年龄</th></tr></thead><tbody><tr><td>1001</td><td>刘沛霞</td><td>35</td></tr><tr><td>1002</td><td>陈子枢</td><td>18</td></tr></tbody></table><p><strong>扩展内容2：常见的关系型数据库有哪些？(了解)</strong></p><ul><li><p>Sql Server：微软提供，收费，适用于一些中型或大型的项目中，在java中的使用占比不高（.NET中使用的较多）</p></li><li><p>Oracle：甲骨文公司提供，收费，适用于一些大型或者超大型的项目中，在java中的使用占比非常高</p></li><li><p>mysql：瑞典MySQLAB公司提供，免费开源，适用于一些小型或者中型的项目中，在Java中的使用占比较高（小巧轻量）<br>mariadb其实就是MySQL的一个分支，用法和MySQL完全一样。</p></li><li><p>DB2：IBM公司提供，收费，在一些银行、金融等行业中使用较多。在java中的使用占比也不高。</p></li><li><p>Sqlite：迷你数据库，嵌入式设备中（安卓、苹果手机、pad）</p></li></ul><h3 id="数据库相关概念"><a href="#数据库相关概念" class="headerlink" title="数据库相关概念"></a>数据库相关概念</h3><p><strong>1、什么是数据库服务器</strong></p><p>数据库服务器就是一个软件（比如mysql软件）将数据库软件安装在电脑上，当前电脑就是一个数据库服务器。就可以对外提供存取数据的服务</p><p>在一个数据库服务器中可以创建多个数据库（dataBases），每一个数据库都是一个单独的仓库。</p><p><strong>2、什么是数据库</strong></p><p>数据库就是存储和管理数据的仓库，通常情况下，一个网站的中的所有数据会存放在一个数据库中。例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jd.com db_jd(数据库)</span><br><span class="line">taobao.com db_taobao(数据库)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>3、什么是表</strong></p><p>一个数据库中可以创建多张表，每张表用于存储一类信息（数据库），例如：</p><p>jd.com中的用户数据 tb_user(表)</p><p>jd.com中的商品数据 tb_product(表)</p><p>jd.com中的订单数据 tb_order(表)</p><p>…</p><p><strong>4、什么表记录</strong>·</p><p>一张表中可以包含多行表记录，每一行表记录用于存储某一个具体的数据</p><table><thead><tr><th>学生编号</th><th>姓名</th><th>年龄</th></tr></thead><tbody><tr><td>1001</td><td>刘沛霞</td><td>35</td></tr><tr><td>1002</td><td>陈子枢</td><td>18</td></tr><tr><td>。。。</td><td>。。。</td><td>。。。</td></tr></tbody></table><h3 id="什么是SQL语言？"><a href="#什么是SQL语言？" class="headerlink" title="什么是SQL语言？"></a>什么是SQL语言？</h3><p>SQL是一们用于操作关系型数据库的通用的语言（使用SQL可以操作所有的关系型数据库）</p><p>使用SQL可以操作数据库、表、表记录</p><p>(1)创建数据库、删除数据库、修改数据库、查询数据库</p><p>(2)创建表、删除表、修改表、查询表</p><p>(3)新增表记录、删除表记录、修改表记录、查询表记录</p><p>使用SQL也可以操作存储过程/视图/索引等。</p><p>提示：SQL是一个标准通用的操作关系型数据库的语言（普通话），每个数据库厂商为了增强自己数据库的功能，都提供了支持自己数据库的语言，称之为数据库的方言。方言不通用！</p><h2 id="连接mysql服务器"><a href="#连接mysql服务器" class="headerlink" title="连接mysql服务器"></a>连接mysql服务器</h2><p>通过命令行工具可以登录MySQL客户端，连接MySQL服务器，从而访问服务器中的数据。</p><p><strong>1、连接mysql服务器：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p密码</span><br></pre></td></tr></table></figure><p>**-u：**后面的root是用户名，这里使用的是超级管理员root；</p><p>**-p：(小写的p)**后面的root是密码，这是在安装MySQL时就已经指定的密码；</p><p><strong>2、连接mysql服务器并指定IP和端口</strong>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -proot -h127.0.0.1 -P3306</span><br></pre></td></tr></table></figure><p>**-h：**后面给出的127.0.0.1是服务器主机名或ip地址，可以省略的，默认连接本机；</p><p>**-P：(大写的P)**后面的3306是连接端口，可以省略，默认连接3306端口；</p><p><strong>3、退出客户端命令：quit或exit或 \q</strong></p><p><strong>4、FAQ：常见问题:</strong></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e23a06d3921d5d68c48d6e51024aae8a-35f7506e6016404484ce3a6c692889e0.jpg" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-ee84ca8ce5cd697e485384ddffce4133.jpg" alt="e23a06d3921d5d68c48d6e51024aae8a"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e23a06d3921d5d68c48d6e51024aae8a-35f7506e6016404484ce3a6c692889e0.jpg" target="_blank" rel="noopener">e23a06d3921d5d68c48d6e51024aae8a</a></p><p>解决方法：复制mysql安装目录下的bin目录，将bin目录的路径添加到path环境变量中!!</p><p><strong>扩展内容3：</strong></p><p>(1)在cmd中连接mysql服务器之后，可以使用 #、/**/、– 等符号添加注释，例如:</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7765164a8afaa8d26d9b31ff3356bc33-dd672006525e444e8d413dbc778e417e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-481758b70bb48b22f4d86cb156627deb.png" alt="7765164a8afaa8d26d9b31ff3356bc33"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7765164a8afaa8d26d9b31ff3356bc33-dd672006525e444e8d413dbc778e417e.png" target="_blank" rel="noopener">7765164a8afaa8d26d9b31ff3356bc33</a></p><p>(2)在cmd中连接mysql服务器之后，在书写SQL语句时，可以通过 \c 取消当前语句的执行。例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4c6edbd263d6c870ac745e34d4b207d0-c6e6f5d84f8f44828336ac49c86dd563.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-2504ee543331f7768c35a82a1dc39aeb.png" alt="4c6edbd263d6c870ac745e34d4b207d0"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4c6edbd263d6c870ac745e34d4b207d0-c6e6f5d84f8f44828336ac49c86dd563.png" target="_blank" rel="noopener">4c6edbd263d6c870ac745e34d4b207d0</a></p><h2 id="数据库及表操作"><a href="#数据库及表操作" class="headerlink" title="数据库及表操作"></a>数据库及表操作</h2><h3 id="创建、删除、查看数据库"><a href="#创建、删除、查看数据库" class="headerlink" title="创建、删除、查看数据库"></a>创建、删除、查看数据库</h3><p>提示： (1)SQL语句对大小写不敏感。推荐关键字使用大写，自定义的名称（库名，表名，列名等）使用小写。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>; <span class="comment">-- 查看当前数据库服务器中的所有库</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> mydb1; <span class="comment">-- 创建mydb1库</span></span><br></pre></td></tr></table></figure><p>(2)并且在自定义名称时，针对多个单词不要使用驼峰命名，而是使用下划线连接。(例如：tab_name，而不是 tabName )</p><p>-- 01.查看mysql服务器中所有数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure><p>-- 02.进入某一数据库（进入数据库后，才能操作库中的表和表记录）</p><p>-- 语法：USE 库名;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="keyword">test</span>;</span><br></pre></td></tr></table></figure><p>-- 查看已进入的库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATABASE</span>();</span><br></pre></td></tr></table></figure><p>-- 03.查看当前数据库中的所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 先进入某一个库,再查看当前库中的所有表</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><p>-- 04.删除mydb1库</p><p>-- 语法：DROP DATABASE 库名;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span>  mydb1;</span><br></pre></td></tr></table></figure><p><code>-- 思考：当删除的库不存在时，如何避免错误产生?</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> mydb1;</span><br></pre></td></tr></table></figure><p>-- 05.重新创建mydb1库，指定编码为utf8</p><p>-- 语法：CREATE DATABASE 库名 CHARSET 编码;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果存在mydb1,则先删除,再重建</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> mydb1 <span class="keyword">charset</span> utf8;</span><br></pre></td></tr></table></figure><p>-- 如果不存在则创建mydb1;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> mydb1 <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> <span class="keyword">charset</span> utf8;</span><br></pre></td></tr></table></figure><p>-- 06.查看建库时的语句（并验证数据库库使用的编码）</p><p>-- 语法：SHOW CREATE DATABASE 库名;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">database</span> mydb1;</span><br></pre></td></tr></table></figure><h3 id="创建、删除、查看表"><a href="#创建、删除、查看表" class="headerlink" title="创建、删除、查看表"></a>创建、删除、查看表</h3><p>-- 07.进入mydb1库，删除stu学生表(如果存在)</p><p>-- 语法：DROP TABLE 表名;</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mydb1</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> stu;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> stu;</span><br></pre></td></tr></table></figure><p>-- 08.创建stu学生表（编号[数值类型]、姓名、性别、出生年月、考试成绩[浮点型]），建表的语法：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">列名 数据类型,</span><br><span class="line">列名 数据类型,</span><br><span class="line">...</span><br><span class="line">    列名 数据类型</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>SQL语句:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> stu(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">genger <span class="built_in">varchar</span>(<span class="number">10</span>),</span><br><span class="line">birthday <span class="built_in">date</span>,</span><br><span class="line">score <span class="keyword">double</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 09.查看stu学生表结构</p><p>-- 语法：desc 表名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> stu;</span><br><span class="line">desc stu;</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200316141717739-c97f1d3b3e4741bab5c1a1f5d2ef9298.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-9bb5065a49ff4a444848751bd3d41369.png" alt="image-20200316141717739"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/image-20200316141717739-c97f1d3b3e4741bab5c1a1f5d2ef9298.png" target="_blank" rel="noopener">image-20200316141717739</a></p><h2 id="新增、更新、删除表记录"><a href="#新增、更新、删除表记录" class="headerlink" title="新增、更新、删除表记录"></a>新增、更新、删除表记录</h2><p>-- 10.往学生表(stu)中插入记录(数据)</p><p>-- 语法：INSERT INTO 表名(列名1,列名2,列名3…) VALUES(值1,值2,值3…);</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 如果是在cmd中执行插入记录的语句,先 set names gbk; 再插入记录!</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stu <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'赵伟成'</span>,<span class="string">'女'</span>,<span class="string">'2018-3-9'</span>,<span class="number">33</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stu <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'张三'</span>,<span class="string">'男'</span>,<span class="string">'2018-3-9'</span>,<span class="number">11</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> stu <span class="keyword">values</span>(<span class="literal">null</span>,<span class="string">'卫程'</span>,<span class="string">'女'</span>,<span class="string">'2022-1-11'</span>,<span class="number">55</span>);</span><br></pre></td></tr></table></figure><p>提示：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1)当为所有列插入值时，可以省写列名，但值的个数和顺序必须和声明时列的个数和顺序保持一致！</span><br><span class="line">(2)SQL语句中的值为字符串或日期时，值的两边要加上单引号（有的版本的数据库双引号也可以，但推荐使用单引号）。</span><br><span class="line">(3)(针对cmd窗口)在插入数据之前，先设置编码：set names gbk;</span><br></pre></td></tr></table></figure><p>或者用一下命令连接mysql服务器：</p><p><code>mysql --default-character-set=gbk -uroot -proot</code></p><p>-- 11.查询stu表所有学生的信息</p><p>-- 语法：SELECT 列名 | * FROM 表名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> stu;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure><p>-- 12.修改stu表中所有学生的成绩，加10分特长分</p><p>-- 修改语法: UPDATE 表名 SET 列=值,列=值,列=值…[WHERE子句];</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> stu <span class="keyword">set</span> score=score+<span class="number">10</span>;</span><br></pre></td></tr></table></figure><p>-- 13.修改stu表中编号为1的学生成绩，将成绩改为83分。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> stu <span class="keyword">set</span> score=<span class="number">83</span> <span class="keyword">where</span> <span class="keyword">id</span>=<span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>提示：where子句用于对记录进行筛选过滤，保留符合条件的记录，将不符合条件的记录剔除。</p><p>-- 14.删除stu表中所有的记录</p><p>-- 删除记录语法: DELETE FROM 表名 [where条件]</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> stu;</span><br></pre></td></tr></table></figure><p>-- 仅删除符合条件的</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> stu <span class="keyword">where</span> <span class="keyword">id</span>= <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="查询表记录"><a href="#查询表记录" class="headerlink" title="查询表记录"></a>查询表记录</h2><p><strong>-- 准备数据： 以下练习将使用db10库中的表及表记录，请先进入db10数据库!!!</strong></p><h3 id="基础查询"><a href="#基础查询" class="headerlink" title="基础查询"></a>基础查询</h3><p>SELECT 语句用于从表中选取数据。结果被存储在一个结果表中（称为结果集）。</p><p>语法：SELECT 列名称 | * FROM 表名</p><p>提示：(1) *（星号）为通配符，表示查询所有列。</p><p>(2)但使用 *（星号）有时会把不必要的列也查出来了，并且效率不如直接指定列名</p><p>-- 15.查询emp表中的所有员工，显示姓名，薪资，奖金</p><p>-- 16.查询emp表中的所有部门和职位</p><p>思考：如果查询的结果中，存在大量重复的记录，如何剔除重复记录，只保留一条？ */</p><p>-- 在select之后、列名之前，使用DISTINCT 剔除重复的记录</p><h3 id="WHERE子句查询"><a href="#WHERE子句查询" class="headerlink" title="WHERE子句查询"></a>WHERE子句查询</h3><p>WHERE子句查询语法：SELECT 列名称 | * FROM 表名称 WHERE 列 运算符 值</p><p>WHERE子句后面跟的是条件，条件可以有多个，多个条件之间用连接词（or | and）进行连接</p><p>下面的运算符可在 WHERE 子句中使用：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7b2b5598fb3af3f96d552b5d9779d892-ee7b0e0a137d418e9d13c21e67559fb5.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-93982a04f225bdd4132be92856f64d9b.png" alt="7b2b5598fb3af3f96d552b5d9779d892"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/7b2b5598fb3af3f96d552b5d9779d892-ee7b0e0a137d418e9d13c21e67559fb5.png" target="_blank" rel="noopener">7b2b5598fb3af3f96d552b5d9779d892</a></p><p>-- 17.查询emp表中薪资大于3000的所有员工，显示员工姓名、薪资</p><p>-- 18.查询emp表中总薪资(薪资+奖金)大于3500的所有员工，显示员工姓名、总薪资</p><p>-- ifnull(列, 值)函数: 判断指定的列是否包含null值，如果有null值，用第二个值替换null值</p><p>-- 注意查看上面查询结果中的表头，如何将表头中的 sal+bonus 修改为 “总薪资”</p><p>-- 使用as可以为表头指定别名</p><p>-- 另外as可以省略</p><p>-- 19.查询emp表中薪资在3000和4500之间的员工，显示员工姓名和薪资</p><p>-- 提示: between…and… 在…之间</p><p>-- 20.查询emp表中薪资为 1400、1600、1800的员工，显示员工姓名和薪资</p><p>-- 或者</p><p>-- 21.查询薪资不为1400、1600、1800的员工</p><p>方式一:</p><p>方式二:</p><p>方式三:</p><p>-- 22.(自己完成) 查询emp表中薪资大于4000和薪资小于2000的员工，显示员工姓名、薪资。</p><p>-- 23.(自己完成) 查询emp表中薪资大于3000并且奖金小于600的员工，显示员工姓名、薪资、奖金。</p><p>-- 处理null值</p><p>-- 24.查询没有部门的员工（即部门列为null值）</p><p>-- 思考：如何查询有部门的员工（即部门列不为null值）</p><h3 id="模糊查询"><a href="#模糊查询" class="headerlink" title="模糊查询"></a>模糊查询</h3><p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</p><p>可以和通配符（%、_）配合使用，其中”%”表示0或多个任意的字符。”_“表示一个任意的字符。</p><p>语法：SELECT 列 | * FROM 表名 WHERE 列名 LIKE 值</p><p>示例：</p><p>-- 25.查询emp表中姓名中包含”涛”字的员工，显示员工姓名。</p><p>-- 26.查询emp表中姓名中以”刘”字开头的员工，显示员工姓名。</p><p>-- 27.查询emp表中姓名以”刘”开头，并且姓名为两个字的员工，显示员工姓名。</p><h3 id="多行函数查询"><a href="#多行函数查询" class="headerlink" title="多行函数查询"></a>多行函数查询</h3><p>多行函数也叫做聚合(聚集)函数，根据某一列或所有列进行统计。</p><p>常见的多行函数有：</p><table><thead><tr><th>多行函数</th><th>作用</th></tr></thead><tbody><tr><td>COUNT( 列名</td><td>* )</td></tr><tr><td>MAX( 列名 )</td><td>统计结果集中某一列值中的最大值</td></tr><tr><td>MIN( 列名 )</td><td>统计结果集中某一列值中的最小值</td></tr><tr><td>SUM( 列名 )</td><td>统计结果集中某一列所有值的和</td></tr><tr><td>AVG( 列名 )</td><td>统计结果集中某一列值的平均值</td></tr></tbody></table><p>提示：(1)多行函数不能用在where子句中</p><p>(2)多行函数和是否分组有关，分组与否会直接影响多行函数执行的结果。</p><p>-- 28.统计emp表中薪资大于3000的员工个数</p><p>-- 29.求emp表中的最高薪资</p><p>-- 30.统计emp表中所有员工的薪资总和(不包含奖金)</p><p>-- 31.统计emp表员工的平均薪资(不包含奖金)</p><p><strong>多行函数需要注意的问题:</strong></p><ul><li><p>多行函数和是否分组有关，如果查询结果中的数据没有经过分组，默认整个查询结果是一个组，多行函数就会默认统计当前这一个组的数据。产生的结果只有一个。</p></li><li><p>如果查询结果中的数据经过分组（分的组不止一个），多行函数会根据分的组进行统计，有多少个组，就会统计出多少个结果。</p></li></ul><p>例如：统计CGB2002班的人数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> CGB2002;</span><br></pre></td></tr></table></figure><p>结果返回的就是CGB1912班的所有人数</p><p>再例如: 根据性别进行分组，再统计CGB1912每组的人数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(*) <span class="keyword">from</span> CGB1912 <span class="keyword">group</span> <span class="keyword">by</span> gender;</span><br></pre></td></tr></table></figure><h3 id="分组查询"><a href="#分组查询" class="headerlink" title="分组查询"></a>分组查询</h3><p>GROUP BY 语句根据一个或多个列对结果集进行分组。</p><p>在分组的列上我们可以使用 COUNT，SUM，AVG，MAX，MIN等函数。</p><p>语法：SELECT 列 | * FROM 表名 [WHERE子句] GROUP BY 列;</p><p>-- 32.对emp表按照部门对员工进行分组，查看分组后效果。</p><p>-- 33.对emp表按照职位进行分组，并统计每个职位的人数，显示职位和对应人数</p><p>-- 34.对emp表按照部门进行分组，求每个部门的最高薪资(不包含奖金)，显示部门名称和最高薪资</p><h3 id="排序查询"><a href="#排序查询" class="headerlink" title="排序查询"></a>排序查询</h3><p>使用 ORDER BY 子句将结果集中记录根据指定的列排序后再返回</p><p>语法：SELECT 列名 FROM 表名 <code>ORDER BY 列名 [ASC|DESC]</code></p><p>ASC(默认)升序，即从低到高；DESC 降序，即从高到低。</p><p>-- 35.对emp表中所有员工的薪资进行升序(从低到高)排序，显示员工姓名、薪资。</p><p>-- 36.对emp表中所有员工的奖金进行降序(从高到低)排序，显示员工姓名、奖金。</p><h3 id="分页查询"><a href="#分页查询" class="headerlink" title="分页查询"></a>分页查询</h3><p>在mysql中，通过limit进行分页查询：</p><p><code>limit (页码-1)*每页显示记录数, 每页显示记录数</code></p><p>-- 37.查询emp表中的所有记录，分页显示：每页显示3条记录，返回第 1 页。</p><p>-- 38.查询emp表中的所有记录，分页显示：每页显示3条记录，返回第 2 页。</p><p>-- 补充练习：求emp表中薪资最高的前3名员工的信息，显示姓名和薪资</p><h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><table><thead><tr><th>函数名</th><th>解释说明</th></tr></thead><tbody><tr><td>curdate()</td><td>获取当前日期，格式是：年月日</td></tr><tr><td>curtime()</td><td>获取当前时间 ，格式是：时分秒</td></tr><tr><td>sysdate()/now()</td><td>获取当前日期+时间，格式是：年月日 时分秒</td></tr><tr><td>year(date)</td><td>返回date中的年份</td></tr><tr><td>month(date)</td><td>返回date中的月份</td></tr><tr><td>day(date)</td><td>返回date中的天数</td></tr><tr><td>hour(date)</td><td>返回date中的小时</td></tr><tr><td>minute(date)</td><td>返回date中的分钟</td></tr><tr><td>second(date)</td><td>返回date中的秒</td></tr><tr><td>CONCAT(s1,s2..)</td><td>将s1,s2 等多个字符串合并为一个字符串</td></tr><tr><td>CONCAT_WS(x,s1,s2..)</td><td>同CONCAT(s1,s2,..)函数，但是每个字符串之间要加上x，x是分隔符</td></tr></tbody></table><p>-- 39.查询emp表中所有在1993和1995年之间出生的员工，显示姓名、出生日期。</p><p>-- 40.查询emp表中本月过生日的所有员工</p><p>-- 41.查询emp表中员工的姓名和薪资（薪资格式为: xxx(元) ）</p><p>-- 补充练习：查询emp表中员工的姓名和薪资（薪资格式为: xxx/元 ）</p><h2 id="mysql的数据类型"><a href="#mysql的数据类型" class="headerlink" title="mysql的数据类型"></a>mysql的数据类型</h2><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h3><p>MySQL中支持多种整型，其实很大程度上是相同的，只是存储值的大小范围不同而已。</p><p><strong>tinyint</strong>：占用1个字节，相对于java中的byte</p><p><strong>smallint</strong>：占用2个字节，相对于java中的short</p><p><strong>int</strong>：占用4个字节，相对于java中的int</p><p><strong>bigint</strong>：占用8个字节，相对于java中的long</p><p>其次是浮点类型即：float和double类型</p><p><strong>float</strong>：4字节单精度浮点类型，相对于java中的float</p><p><strong>double</strong>：8字节双精度浮点类型，相对于java中的double</p><h3 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h3><p><strong>1、char(n)</strong> 定长字符串，最长255个字符。n表示字符数，例如：</p><p>-- 创建user表，指定用户名为char类型，字符长度不超过10</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">    username <span class="built_in">char</span>(<span class="number">10</span>),</span><br><span class="line">    ...</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>所谓的定长，是当插入的值长度小于指定的长度时，剩余的空间会用空格填充。（这样会浪费空间）</p><p><strong>2、varchar(n)</strong> 变长字符串，最长不超过65535个字节，n表示字符数，一般超过255个字符，会使用text类型，例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iso8859-1码表：一个字符占用1个字节，1*n &lt;&#x3D; 65535， n最多等于 65535</span><br><span class="line">utf8码表：一个中文汉字占用3个字节，3*n&lt;&#x3D;65535，n最多等于 65535&#x2F;3</span><br><span class="line">GBK码表：一个中文汉字占用2个字节，2*n&lt;65535，n最多等于 65535&#x2F;2</span><br></pre></td></tr></table></figure><p>-- 创建user表，指定用户名为varchar类型，长度不超过10</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">username <span class="built_in">varchar</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>所谓的不定长，是当插入的值长度小于指定的长度时，剩余的空间可以留给别的数据使用。（节省空间）</p><p><strong>3、大文本（长文本）类型</strong></p><p>最长65535个字节，一般超过255个字符列的会使用text。</p><p>-- 创建user表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line"><span class="keyword">resume</span> <span class="built_in">text</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>另，text也分多种，其中bigtext存储数据的长度约为4GB。</p><p><strong>扩展内容3</strong>：(面试题)char(n)、varchar(n)、text都可以表示字符串类型，其区别在于：</p><p>(1)char(n)在保存数据时，如果存入的字符串长度小于指定的长度n，后面会用空格补全，因此可能会造成空间浪费，但是char类型的存储速度较varchar和text快。</p><p>因此char类型适合存储长度固定的数据，这样就不会有空间浪费，存储效率比后两者还快！</p><p>(2)varchar(n)保存数据时，按数据的真实长度存储，剩余的空间可以留给别的数据用，因此varchar不会浪费空间。</p><p>因此varchar适合存储长度不固定的数据，这样不会有空间的浪费。</p><p>(3)text是大文本类型，一般文本长度超过255个字符，就会使用text类型存储。</p><h3 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h3><p><strong>date</strong>：年月日</p><p><strong>time</strong>：时分秒</p><p><strong>datetime</strong>：年月日 时分秒</p><p><strong>timestamp</strong>：时间戳(实际存储的是一个时间毫秒值)，与datetime存储日期格式相同。两者的区别是:</p><ul><li><p>timestamp最大表示2038年，而datetime范围是1000~9999</p></li><li><p>timestamp在插入数据、修改数据时，可以自动更新成系统当前时间(后面用到时再做讲解)</p></li></ul><h2 id="mysql的字段约束"><a href="#mysql的字段约束" class="headerlink" title="mysql的字段约束"></a>mysql的字段约束</h2><p>字段约束/列约束 –&gt; 约束: 限制</p><h3 id="主键约束"><a href="#主键约束" class="headerlink" title="主键约束"></a>主键约束</h3><p>主键约束：如果为一个列添加了主键约束，那么这个列就是主键，主键的特点是唯一且不能为空。</p><p>主键的作用: 作为一个唯一标识，唯一的表示一条表记录（作用类似于人的身份证号，可以唯一的表示一个人一样。）</p><p>添加主键约束，例如将id设置为主键：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>,</span><br><span class="line">...</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>如果主键是数值类型，为了方便插入主键（并且保证插入数据时，主键不会因为重复而报错），可以设置一个主键自增策略。</p><p>主键自增策略是指：设置了自增策略的主键，可以在插入记录时，不给id赋值，只需要设置一个null值，数据库会自动为id分配一个值（AUTO_INCREMENT变量，默认从1开始，后面依次+1），这样既可以保证id是唯一的，也省去了设置id的麻烦。</p><p>将id主键设置为自增：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">...</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="非空约束"><a href="#非空约束" class="headerlink" title="非空约束"></a>非空约束</h3><p>非空约束：如果为一个列添加了非空约束，那么这个列的值就不能为空，但可以重复。</p><p>添加非空约束，例如为password添加非空约束：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line"><span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">...</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p>唯一约束：如果为一个列添加了唯一约束，那么这个列的值就必须是唯一的（即不能重复），但可以为空。</p><p>添加唯一约束，例如为username添加唯一约束及非空约束：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(</span><br><span class="line">username <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">unique</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">...</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="外键约束"><a href="#外键约束" class="headerlink" title="外键约束"></a>外键约束</h3><p>外键其实就是用于通知数据库两张表数据之间对应关系的这样一个列。</p><p>这样数据库就会帮我们维护两张表中数据之间的关系。</p><p><strong>(1) 创建表的同时添加外键</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">50</span>),</span><br><span class="line">dept_id <span class="built_in">int</span>,</span><br><span class="line"><span class="keyword">foreign</span> <span class="keyword">key</span>(dept_id) <span class="keyword">references</span> dept(<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/6b56c23ba5cf6a63d9f9e8a8b5fd8467-271e0d5e27f54321b94baf5f7f31dfef.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-20dc23b806e46cc1081e84b40fd06bc1.png" alt="6b56c23ba5cf6a63d9f9e8a8b5fd8467"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/6b56c23ba5cf6a63d9f9e8a8b5fd8467-271e0d5e27f54321b94baf5f7f31dfef.png" target="_blank" rel="noopener">6b56c23ba5cf6a63d9f9e8a8b5fd8467</a></p><p>（1）如果是要表示两张表的数据之间存在对应关系，只需要在其中的一张表中添加一个列，保存另外一张表的主键，就可以保存两张表数据之间的关系。</p><p>但是添加的这个列（dept_id）对于数据库来说就是一个普通列，数据不会知道两张表存在任何关系，因此数据库也不会帮我们维护这层关系。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/27084a70275c2ea84221346785d9821b-a5f1d03e6ae240c6b4bed3e3ae5794a2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-93b51e30f6193b683e84ef86df4cef39.png" alt="27084a70275c2ea84221346785d9821b"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/27084a70275c2ea84221346785d9821b-a5f1d03e6ae240c6b4bed3e3ae5794a2.png" target="_blank" rel="noopener">27084a70275c2ea84221346785d9821b</a></p><p>（2）如果将dept_id列设置为外键，等同于通知数据库，部门表和员工表之间存在对应关系，dept_id列中的数据要参考部门的主键，数据库一旦知道部门和员工表之间存在关系，就会帮我们维护这层关系型。</p><p>思考：如果在创建表时没有指定外键，那么后期该如何指定外键？以及如何删除外键？</p><h2 id="表关系"><a href="#表关系" class="headerlink" title="表关系"></a>表关系</h2><p><strong>常见的表关系分为以下三种：</strong></p><p>一对多(多对一)、一对一、多对多</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1e4a36daf517c88d356cbc3c8dbd3ea8-7c190e0f34b549f99ed587340504d762.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-01ed46d089a5f834af52680958bf50b4.png" alt="1e4a36daf517c88d356cbc3c8dbd3ea8"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1e4a36daf517c88d356cbc3c8dbd3ea8-7c190e0f34b549f99ed587340504d762.png" target="_blank" rel="noopener">1e4a36daf517c88d356cbc3c8dbd3ea8</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/392ee4d4c0f8fdd86adc4b9abc3ad6f5-23598385334e47f3a04f48c02a9da2aa.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-1c67f3e326582d9e301106cacd68ed01.png" alt="392ee4d4c0f8fdd86adc4b9abc3ad6f5"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/392ee4d4c0f8fdd86adc4b9abc3ad6f5-23598385334e47f3a04f48c02a9da2aa.png" target="_blank" rel="noopener">392ee4d4c0f8fdd86adc4b9abc3ad6f5</a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/55f5505ecfd67ae14e8c81da6ad7fd55-046b0f3b71cd44ddb5bd5054fc53f580.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-1a0765095863bded7ac75e20d90c4997.png" alt="55f5505ecfd67ae14e8c81da6ad7fd55"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/55f5505ecfd67ae14e8c81da6ad7fd55-046b0f3b71cd44ddb5bd5054fc53f580.png" target="_blank" rel="noopener">55f5505ecfd67ae14e8c81da6ad7fd55</a></p><h2 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h2><p><strong>-- 准备数据： 以下练习将使用db30库中的表及表记录，请先进入db30数据库!!!</strong></p><h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><p>-- 42.查询部门和部门对应的员工信息</p><p>上面的查询中存在大量错误的数据，一般我们不会直接使用这种查询。</p><p>笛卡尔积查询：所谓笛卡尔积查询就是指，查询两张表，其中一张表有m条记录，另一张表有n条记录，查询的结果是m*n条。</p><p>虽然笛卡尔积查询中包含大量错误数据，但我们可以通过where子句将错误数据剔除，保留下来的就是正确数据。</p><p>通过where子句将笛卡尔积查询中的错误数据剔除,保留正确的数据,这就是连接查询!</p><p>上面的查询可以换成下面的查询：</p><h3 id="左外连接查询"><a href="#左外连接查询" class="headerlink" title="左外连接查询"></a>左外连接查询</h3><p>-- 43.查询_所有部门_和部门下的员工，如果部门下没有员工，员工显示为null</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b99494d167488239015cc857e68975c-0c6f238c39bb483b91c1a933f19d25e4.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-60497ef6238ad0548ac0f7fd67b91d74.png" alt="4b99494d167488239015cc857e68975c"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4b99494d167488239015cc857e68975c-0c6f238c39bb483b91c1a933f19d25e4.png" target="_blank" rel="noopener">4b99494d167488239015cc857e68975c</a></p><p>左外连接查询：可以将左边表中的所有记录都查询出来，右边表只显示和左边相对应的数据，如果左边表中某些记录在右边没有对应的数据，右边显示为null即可。</p><h3 id="右外连接查询"><a href="#右外连接查询" class="headerlink" title="右外连接查询"></a>右外连接查询</h3><p>-- 44.查询部门和_所有员工_，如果员工没有所属部门，部门显示为null</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/790074e2ba156f1083de74b3efd1e2ba-4eb93a73b570411eb2aba35291f5be47.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-dda5751e01f7a87ae5e093a3f36e6c9a.png" alt="790074e2ba156f1083de74b3efd1e2ba"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/790074e2ba156f1083de74b3efd1e2ba-4eb93a73b570411eb2aba35291f5be47.png" target="_blank" rel="noopener">790074e2ba156f1083de74b3efd1e2ba</a></p><p>右外连接查询：可以将右边表中的所有记录都查询出来，左边表只显示和右边相对应的数据，如果右边表中某些记录在左边没有对应的数据，可以显示为null。</p><p>扩展：如果想将两张表中的所有数据都查询出来(左外+右外并去除重复记录)，可以使用全外连接查询，但是mysql又不支持全外连接查询。</p><p>可以使用union将左外连接查询的结果和右外连接查询的结果合并在一起，并去除重复的记录。例如：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d0c3a3d4ad4f48d4779d1d40cac31755-485221e4f0c2456caf9e7e4d287c37fe.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-dce7e946438a0f909e43777a0977c050.png" alt="d0c3a3d4ad4f48d4779d1d40cac31755"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d0c3a3d4ad4f48d4779d1d40cac31755-485221e4f0c2456caf9e7e4d287c37fe.png" target="_blank" rel="noopener">d0c3a3d4ad4f48d4779d1d40cac31755</a></p><p>需要注意的是：union可以将两条SQL语句执行的结果合并有前提:</p><p>(1)两条SQL语句查询的结果列数必须一致</p><p>(2)两条SQL语句查询的结果列名、顺序也必须一致</p><p>并且union默认就会将两个查询中重复的记录去除(如果不希望去除重复记录，可以使用union all)</p><h3 id="子查询练习"><a href="#子查询练习" class="headerlink" title="子查询练习"></a>子查询练习</h3><p><strong>-- 准备数据：以下练习将使用db40库中的表及表记录，请先进入db40数据库!!!</strong></p><p>-- 45.列出薪资比’王海涛’的薪资高的所有员工，显示姓名、薪资</p><p>-- 46.列出与’刘沛霞’从事相同职位的所有员工，显示姓名、职位。</p><p>-- 47.列出薪资比’大数据部’部门(已知部门编号为30)所有员工薪资都高的员工信息，显示员工姓名、薪资和部门名称。</p><p>如果不考虑没有部门的员工</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、连接查询员工和部门</span></span><br><span class="line"><span class="comment">-- 2、求出大数据部门的最高薪资(查询员工表中部门编号为30的最高薪资)</span></span><br><span class="line"><span class="comment">-- 3、求出比大数据部门最高薪资还高的员工信息</span></span><br></pre></td></tr></table></figure><p>如果加上没有部门的员工</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1、用左外连接查询所有员工和对应的部门</span></span><br><span class="line"><span class="comment">-- 2、求出大数据部门的最高薪资</span></span><br><span class="line"><span class="comment">-- 3、求出比大数据部门最高薪资还高的员工信息</span></span><br></pre></td></tr></table></figure><h3 id="多表查询练习"><a href="#多表查询练习" class="headerlink" title="多表查询练习"></a>多表查询练习</h3><p>-- 48.列出在’培优部’任职的员工，假定不知道’培优部’的部门编号，显示部门名称，员工名称。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 关联查询两张表</span></span><br><span class="line"><span class="comment">-- 求出在培优部的员工</span></span><br></pre></td></tr></table></figure><p>-- 49.(自查询)列出所有员工及其直接上级，显示员工姓名、上级编号，上级姓名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* emp e1 员工表, emp e2 上级表 (一张表起两个别名,可以当作两张表来查)</span></span><br><span class="line"><span class="comment"> * 查询的列: e1.name, e2.id, e2.name</span></span><br><span class="line"><span class="comment"> * 查询的表: emp e1, emp e2</span></span><br><span class="line"><span class="comment"> * 连接条件: e1.topid=e2.id</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>-- 50.列出最低薪资大于1500的各种职位，显示职位和该职位最低薪资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 根据职位进行分组，求出每种职位的最低薪资</span></span><br><span class="line"><span class="comment">-- 求出最低薪资大于1500的职位</span></span><br></pre></td></tr></table></figure><p><strong>补充内容：where和having子句的区别:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(1)相同点: where和having都可以对记录进行筛选过滤。</span><br><span class="line">(2)区别：where是在分组之前,对记录进行筛选过滤,并且where子句中不能使用多行函数以及列别名(但是可以使用表别名)</span><br><span class="line">(3)区别：having是在分组之后,对记录进行筛选过滤,并且having子句中可以使用多行函数以及列别名、表别名。</span><br></pre></td></tr></table></figure><p>-- 51.列出在每个部门就职的员工数量、平均工资。显示部门编号、员工数量，平均薪资。</p><p>-- 52.查出至少有一个员工的部门，显示部门编号、部门名称、部门位置、部门人数。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 连接查询部门表和员工表</span></span><br><span class="line"><span class="comment">-- 按照部门进行分组,统计部门人数</span></span><br></pre></td></tr></table></figure><p>-- 53.列出受雇日期早于直接上级的所有员工的编号、姓名、部门名称。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* emp e1 表示员工表  emp e2 表示上级表  dept d 部门表</span></span><br><span class="line"><span class="comment"> * 显示的列: e1.id, e1.name, d.name</span></span><br><span class="line"><span class="comment"> * 查询的表: emp e1, emp e2, dept d</span></span><br><span class="line"><span class="comment"> * 连接条件: e1.topid=e2.id  e1.dept_id=d.id</span></span><br><span class="line"><span class="comment"> * 筛选条件: e1.hdate&lt;e2.hdate</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h2 id="数据库备份与恢复"><a href="#数据库备份与恢复" class="headerlink" title="数据库备份与恢复"></a>数据库备份与恢复</h2><h3 id="备份数据库"><a href="#备份数据库" class="headerlink" title="备份数据库"></a>备份数据库</h3><p>在cmd窗口中(未登录的状态下)，可以通过如下命令对指定的数据库进行备份：</p><p><code>mysqldump -u用户名 -p 数据库的名字 &gt; 备份文件的位置</code></p><p>示例1: 对db40库中的数据(表，表记录)进行备份，备份到 d:/db40.sql文件中</p><p><code>mysqldump -uroot -p db40 &gt; d:/db40.sql</code></p><p>键入密码，如果没有提示，即表示备份成功！</p><p>也可以一次性备份所有库，例如：</p><p>对mysql服务器中所有的数据库进行备份，备份到 d:/all.sql文件中</p><p><code>mysqldump -uroot -p --all-database &gt; d:/all.sql</code></p><p>键入密码，如果没有提示错误(警告信息不是错误，可以忽略)，即表示备份成功！</p><h3 id="恢复数据库"><a href="#恢复数据库" class="headerlink" title="恢复数据库"></a>恢复数据库</h3><p><strong>1、恢复数据库方式一：</strong></p><p>在cmd窗口中(未登录的状态下)，可以通过如下命令对指定的数据库进行恢复：</p><p><code>mysql -u用户名 -p 数据库的名字 &lt; 备份文件的位置</code></p><p>示例：将d:/db40.sql文件中的数据恢复到db60库中</p><p>-- 在cmd窗口中（已登录的状态下），先创建db60库：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> db60 <span class="keyword">charset</span> utf8;</span><br></pre></td></tr></table></figure><p>-- 在cmd窗口中（未登录的状态下）</p><p><code>mysql -uroot -p db60 &lt; d:/db40.sql</code></p><p><strong>2、恢复数据库方式二：</strong></p><p>在cmd窗口中(已登录的状态下)，可以通过source执行指定位置的SQL文件：</p><p><code>source sql文件的位置</code></p><p>示例：将d:/db40.sql文件中的数据恢复到db80库中</p><p>-- 在cmd窗口中（已登录的状态下），先创建db80库，进入db80库：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> db80 <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="keyword">use</span> db80;</span><br></pre></td></tr></table></figure><p>-- 再通过source执行指定位置下的sql文件：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source d:/db40.sql</span><br></pre></td></tr></table></figure><h2 id="Navicat软件的使用"><a href="#Navicat软件的使用" class="headerlink" title="Navicat软件的使用"></a>Navicat软件的使用</h2><p>Navicat Premium是一套带图形用户界面的数据库管理工具，让你从单一应用程序中同时连接MySQL、MariaDB、MongoDB、SQL Server、Oracle、PostgreSQL 和 SQLite数据库。使用Navicat可以快速、轻松地创建、管理和维护数据库。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、使用navicat连接mysql服务器（使用cmd连接mysql服务器）</span><br><span class="line">2、查看所有库、进入数据库、创建数据库、删除数据库、修改数据库</span><br><span class="line">3、创建表、查看表、修改表、删除表</span><br><span class="line">4、新增表记录、查询表记录、修改表记录、删除表记录</span><br><span class="line">5、使用navicat书写SQL语句操作数据库、表和表记录</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="扩展内容"><a href="#扩展内容" class="headerlink" title="扩展内容"></a>扩展内容</h2><p>现创建学生表：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use test; -- 进入test库</span><br><span class="line">drop table if exists stu; -- 删除学生表(如果存在)</span><br><span class="line">create table stu( -- 创建学生表</span><br><span class="line">    id int, -- 学生id</span><br><span class="line">    name varchar(20), -- 学生姓名</span><br><span class="line">    gender char(1), -- 学生性别</span><br><span class="line">    birthday date -- 出生年月</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="修改表—新增列"><a href="#修改表—新增列" class="headerlink" title="修改表—新增列"></a>修改表—新增列</h3><p>语法：ALTER TABLE tabname ADD col_name datatype [DEFAULT expr][,ADD col_name datatype…];</p><p>1、往stu表中添加score列，double类型</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">add</span> score <span class="keyword">double</span>;</span><br></pre></td></tr></table></figure><h3 id="修改表—修改列"><a href="#修改表—修改列" class="headerlink" title="修改表—修改列"></a>修改表—修改列</h3><p>语法：ALTER TABLE tabname MODIFY (col_name datatype [DEFAULT expr][,MODIFY col_name datatype]…);</p><p>1、修改id列，将id设置为主键</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span>;</span><br></pre></td></tr></table></figure><p>2、修改id列，将id主键设置为自动增长</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span> auto_increment;</span><br></pre></td></tr></table></figure><h3 id="修改表—删除列"><a href="#修改表—删除列" class="headerlink" title="修改表—删除列"></a>修改表—删除列</h3><p>语法：ALTER TABLE tabname DROP [COLUMN] col_name;</p><p>1、删除stu表中的score列</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">drop</span> score;</span><br></pre></td></tr></table></figure><h3 id="添加或删除主键及自增"><a href="#添加或删除主键及自增" class="headerlink" title="添加或删除主键及自增"></a>添加或删除主键及自增</h3><p>思考：a) 在建表时，如何为id指定主键约束和自增?</p><p>b) 建好的表，如何通过修改添加主键约束和自增?</p><p>c) 如何删除表中的主键约束和自增?</p><p>1、创建stu学生表，不添加主键自增, 查看表结果</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> mydb1; <span class="comment">-- 切换到mydb1库</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> stu; <span class="comment">-- 删除stu学生表(如果存在)</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu( <span class="comment">-- 重建stu学生表，没有主键自增</span></span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">1</span>),</span><br><span class="line">    birthday <span class="built_in">date</span></span><br><span class="line">);</span><br><span class="line">desc stu; <span class="comment">-- 查看表结构</span></span><br></pre></td></tr></table></figure><p>表结构如下: 没有主键约束和自增。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f7cf015ff7829f26d326b6f443628cc-cf5ea837991844c98383e5808fea67f3.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-a17c6d15bd5144db7c3e2a1b71822f12.png" alt="4f7cf015ff7829f26d326b6f443628cc"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f7cf015ff7829f26d326b6f443628cc-cf5ea837991844c98383e5808fea67f3.png" target="_blank" rel="noopener">4f7cf015ff7829f26d326b6f443628cc</a></p><p>2、如果表没有创建，或者要删除重建，在创建时可以指定主键或主键自增</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> stu; <span class="comment">-- 删除stu表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu( <span class="comment">-- 重新创建stu表时，指定主键自增</span></span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    gender <span class="built_in">char</span>(<span class="number">1</span>),</span><br><span class="line">    birthday <span class="built_in">date</span></span><br><span class="line">);</span><br><span class="line">desc stu; <span class="comment">-- 查看表结构</span></span><br></pre></td></tr></table></figure><p>表结构如下: 已经添加了主键约束和自增。</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1606d49b391f6e0d23b526912dbb22cf-e1e2d1f977b34d51af42b780080d067e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-812bdf21a3e69009286a5364a240b457.png" alt="1606d49b391f6e0d23b526912dbb22cf"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1606d49b391f6e0d23b526912dbb22cf-e1e2d1f977b34d51af42b780080d067e.png" target="_blank" rel="noopener">1606d49b391f6e0d23b526912dbb22cf</a></p><p>3、如果不想删除重建表，也可以通过修改表添加主键或主键自增</p><p>再次执行第1步，创建stu学生表，不添加主键自增，查看表结果</p><p>-- 例如: 将stu学生表中的id设置为主键和自动增长</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment;</span><br><span class="line">desc stu; <span class="comment">-- 查看表结构</span></span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/1606d49b391f6e0d23b526912dbb22cf-e1e2d1f977b34d51af42b780080d067e.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-812bdf21a3e69009286a5364a240b457.png" alt="1606d49b391f6e0d23b526912dbb22cf"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/1606d49b391f6e0d23b526912dbb22cf-e1e2d1f977b34d51af42b780080d067e.png" target="_blank" rel="noopener">1606d49b391f6e0d23b526912dbb22cf</a></p><p>如果只添加主键约束，不设置自增</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span> **primary <span class="keyword">key</span>**;</span><br></pre></td></tr></table></figure><p>如果已经添加主键约束，仅仅设置自增，但需注意:</p><p>(1)如果没有设置主键，不可添加自增</p><p>(2)只有当主键是数值时，才可以添加自增</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span> **auto_increment**;</span><br></pre></td></tr></table></figure><p>4、如果想删除主键自增</p><p>-- 删除主键自增时，要先删除自增</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">modify</span> <span class="keyword">id</span> <span class="built_in">int</span>;</span><br></pre></td></tr></table></figure><p>-- 再删除主键约束</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> stu <span class="keyword">drop</span> primary <span class="keyword">key</span>;</span><br><span class="line">desc stu; <span class="comment">-- 查看表结构</span></span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f7cf015ff7829f26d326b6f443628cc-cf5ea837991844c98383e5808fea67f3.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-a17c6d15bd5144db7c3e2a1b71822f12.png" alt="4f7cf015ff7829f26d326b6f443628cc"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/4f7cf015ff7829f26d326b6f443628cc-cf5ea837991844c98383e5808fea67f3.png" target="_blank" rel="noopener">4f7cf015ff7829f26d326b6f443628cc</a></p><h3 id="添加外键约束"><a href="#添加外键约束" class="headerlink" title="添加外键约束"></a>添加外键约束</h3><p><strong>1、添加外键方式一：建表时添加外键</strong></p><p>现有部门表如下：</p><p>-- 创建部门表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 部门编号</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="comment">-- 部门名称</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>要求创建员工表，并在员工表中添加外键关联部门主键</p><p>-- 创建员工表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 员工编号</span></span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), <span class="comment">-- 员工姓名</span></span><br><span class="line">    dept_id <span class="built_in">int</span>, <span class="comment">-- 部门编号</span></span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(dept_id) <span class="keyword">references</span> dept(<span class="keyword">id</span>) <span class="comment">-- 指定dept_id为外键</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>2、添加外键方式二：建表后添加外键</strong></p><p>现有部门表和员工表：</p><p>-- 创建部门表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 部门编号</span></span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="comment">-- 部门名称</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 创建员工表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 员工编号</span></span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), <span class="comment">-- 员工姓名</span></span><br><span class="line">    dept_id <span class="built_in">int</span> <span class="comment">-- 部门编号</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 如果表已存在，可以使用下面这种方式：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_dept_id <span class="keyword">foreign</span> <span class="keyword">key</span>(dept_id) <span class="keyword">references</span> dept(<span class="keyword">id</span>);</span><br></pre></td></tr></table></figure><p>其中 <strong>fk_dept_id</strong> (名字由自己定义)，是指外键约束名称，也可以将【constraint fk_dept_id】省略，MySQL会自动分配一个外键名称，将来可以通过该名称删除外键。</p><p>foreign key(dept_id)中的dept_id为外键</p><h3 id="删除外键约束"><a href="#删除外键约束" class="headerlink" title="删除外键约束"></a>删除外键约束</h3><p>1、首先通过 “show create table 表名”语法，查询含有外键表的建表语句，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> emp;</span><br></pre></td></tr></table></figure><p>显示结果如下：</p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e5ad1306d0985dadf8ffbbd3eff61174-75a4e55ff4c347b79519b147887e483b.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-49806cc3a2a71d073ffdd54dfdcb9080.png" alt="e5ad1306d0985dadf8ffbbd3eff61174"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/e5ad1306d0985dadf8ffbbd3eff61174-75a4e55ff4c347b79519b147887e483b.png" target="_blank" rel="noopener">e5ad1306d0985dadf8ffbbd3eff61174</a></p><p>其中，emp_ibfk_1是在创建表时，数据库为外键约束指定的一个名字，删除这个名字即可删除外键关系，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> emp <span class="keyword">drop</span> <span class="keyword">foreign</span> <span class="keyword">key</span> emp_ibfk_1;</span><br></pre></td></tr></table></figure><p><a href="https://www.zhangpeng.fun/upload/2020/06/d909d9ba24215a4632db6c43cb156ce4-669b463b28db4701ab65386021cb90c2.png" target="_blank" rel="noopener"><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591870476-40117eab7185cb0e6aeaab5ba31cc4e9.png" alt="d909d9ba24215a4632db6c43cb156ce4"></a></p><p><a href="https://www.zhangpeng.fun/upload/2020/06/d909d9ba24215a4632db6c43cb156ce4-669b463b28db4701ab65386021cb90c2.png" target="_blank" rel="noopener">d909d9ba24215a4632db6c43cb156ce4</a></p><p>外键删除成功！</p><h3 id="添加外键约束-多对多"><a href="#添加外键约束-多对多" class="headerlink" title="添加外键约束(多对多)"></a>添加外键约束(多对多)</h3><p>-- 现有学生(stu)表和教师(tea)表：</p><p>-- 创建学生表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu(</span><br><span class="line">    stu_id <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 学生编号</span></span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="comment">-- 学生姓名</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 创建教师表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tea(</span><br><span class="line">tea_id <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 教师编号</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="comment">-- 教师姓名</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 添加第三方表(stu_tea)表示学生表和教师表关系</p><p>-- 创建学生和教师关系表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> stu_tea(</span><br><span class="line">    stu_id <span class="built_in">int</span>, <span class="comment">-- 学生编号</span></span><br><span class="line">    tea_id <span class="built_in">int</span>, <span class="comment">-- 教师编号</span></span><br><span class="line">    primary <span class="keyword">key</span>(stu_id,tea_id), <span class="comment">-- 设置联合主键</span></span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(stu_id) <span class="keyword">references</span> stu(stu_id), <span class="comment">-- 添加外键</span></span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(tea_id) <span class="keyword">references</span> tea(tea_id) <span class="comment">-- 添加外键</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>其中为了防止重复数据，将stu_id和tea_id设置为联合主键。</p><p>将stu_id设置为外键，参考stu表中的stu_id列</p><p>并将tea_id设置为外键，参考tea表中的tea_id列</p><h3 id="级联更新、级联删除"><a href="#级联更新、级联删除" class="headerlink" title="级联更新、级联删除"></a>级联更新、级联删除</h3><p>-- 创建db20库、dept表、emp表并插入记录</p><p>-- 删除db20库(如果存在)，并重新创建db20库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> db20;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> db20 <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="keyword">use</span> db20;</span><br></pre></td></tr></table></figure><p>-- 创建部门表, 要求id, name字段</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> dept(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 部门编号</span></span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="comment">-- 部门名称</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>-- 往部门表中插入记录</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'财务部'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'人事部'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'科技部'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> dept <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'销售部'</span>);</span><br></pre></td></tr></table></figure><p>-- 创建员工表, 要求id, name, dept_id</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> emp(</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span> primary <span class="keyword">key</span> auto_increment, <span class="comment">-- 员工编号</span></span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), <span class="comment">-- 员工姓名</span></span><br><span class="line">    dept_id <span class="built_in">int</span>, <span class="comment">-- 部门编号</span></span><br><span class="line">    <span class="keyword">foreign</span> <span class="keyword">key</span>(dept_id) <span class="keyword">references</span> dept(<span class="keyword">id</span>) <span class="comment">-- 指定外键</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">update</span> <span class="keyword">cascade</span> <span class="comment">-- 级联更新</span></span><br><span class="line">    <span class="keyword">on</span> <span class="keyword">delete</span> <span class="keyword">cascade</span> <span class="comment">-- 级联删除</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'张三'</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'李四'</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'老王'</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'赵六'</span>, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> emp <span class="keyword">values</span>(<span class="literal">null</span>, <span class="string">'刘能'</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>级联更新：主表(dept表)中的主键发生更新时（例如将销售部的id改为40），从表（emp表）中的记录的外键数据也会跟着该表(即赵六和刘能的部门编号也会更新为40)</p><p>级联删除：如果不添加级联删除，当删除部门表中的某一个部门时（例如删除4号部门），若该部门在员工表中有对应的员工（赵六和刘能），删除会失败！</p><p>若果添加了级联删除，当删除部门表中的某一个部门时，若该部门在员工表中有对应的员工，会在删除部门的同时，将员工表中对应的员工也删除！</p><h3 id="where中不能使用列别名"><a href="#where中不能使用列别名" class="headerlink" title="where中不能使用列别名"></a>where中不能使用列别名</h3><p>SQL语句的书写顺序:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * | 列名 <span class="comment">-- 确定要查询的列有哪些</span></span><br><span class="line"><span class="keyword">from</span> 表名 <span class="comment">-- 确定查询哪张表</span></span><br><span class="line"><span class="keyword">where</span> 条件 <span class="comment">-- 通过筛选过滤，剔除不符合条件的记录</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 分组的列 <span class="comment">-- 指定根据哪一列进行分组</span></span><br><span class="line"><span class="keyword">having</span> 条件 <span class="comment">-- 通过条件对分组后的数据进行筛选过滤</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 排序的列 <span class="comment">-- 指定根据哪一列进行排序</span></span><br><span class="line"><span class="keyword">limit</span> (countPage<span class="number">-1</span>)*rowCount, rowCount <span class="comment">-- 指定返回第几页记录以及每页显示多少条</span></span><br></pre></td></tr></table></figure><p>SQL语句的执行顺序:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from 表名 <span class="comment">-- 确定查询哪张表</span></span><br><span class="line">where 条件 <span class="comment">-- 通过筛选过滤，剔除不符合条件的记录</span></span><br><span class="line"><span class="keyword">select</span> * | 列名 列别名 <span class="comment">-- 确定要查询的列有哪些，</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 分组的列 <span class="comment">-- 指定根据哪一列进行分组</span></span><br><span class="line"><span class="keyword">having</span> 条件 <span class="comment">-- 通过条件对分组后的数据进行筛选过滤</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 排序的列 <span class="comment">-- 指定根据哪一列进行排序</span></span><br><span class="line"><span class="keyword">limit</span> (countPage<span class="number">-1</span>)*rowCount, rowCount</span><br></pre></td></tr></table></figure><p>**** 关于where中不能使用列别名但是可以使用表别名?**</p><p>是因为，表别名是声明在from中，from先于where执行，先声明再使用没有问题，但是列别名是声明在select中，where先于select执行，如果先使用列别名，再声明，这样执行会报错!!</p><h1 id="mysql-javaweb"><a href="#mysql-javaweb" class="headerlink" title="mysql   javaweb"></a><a href="https://www.zhangpeng.fun/tags/mysql" target="_blank" rel="noopener">mysql</a>   <a href="https://www.zhangpeng.fun/tags/javaweb" target="_blank" rel="noopener">javaweb</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="JavaWeb" scheme="https://zpengit.github.io/categories/JavaWeb/"/>
    
    
      <category term="javaweb" scheme="https://zpengit.github.io/tags/javaweb/"/>
    
      <category term="mysql" scheme="https://zpengit.github.io/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 集成MongoDB</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E9%9B%86%E6%88%90MongoDB/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E9%9B%86%E6%88%90MongoDB/</id>
    <published>2020-06-08T02:47:37.941Z</published>
    <updated>2020-06-07T17:03:02.583Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-集成MongoDB"><a href="#SpringBoot系列-集成MongoDB" class="headerlink" title="SpringBoot系列 - 集成MongoDB"></a>SpringBoot系列 - 集成MongoDB</h1><p>MongoDB是一个高性能、开源、无模式的文档型数据库，是当前NoSql数据库中比较热门的一种。 适合对大量或者无固定格式的数据进行存储，比如：日志、缓存等。对事物支持较弱，不适用复杂的多文档（多表）的级联查询。</p><p>MongoDB的适用场景：</p><ol><li>在应用服务器的日志记录</li><li>存储一些监控数据</li><li>应用不需要事务及复杂 join 支持</li><li>应用需要2000-3000以上的读写QPS</li><li>应用需要TB甚至 PB 级别数据存储</li><li>应用发展迅速，需要能快速水平扩展</li><li>应用要求存储的数据不丢失</li><li>应用需要99.999%高可用</li><li>应用需要大量的地理位置查询、文本查询</li></ol><p>本篇将介绍如何在SpringBoot中使用MongoDB数据库。</p><h2 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖"></a>maven依赖</h2><p>只需要添加：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="安装MongoDB"><a href="#安装MongoDB" class="headerlink" title="安装MongoDB"></a>安装MongoDB</h2><p>MongoDB的安装教程请参考 <a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" target="_blank" rel="noopener">官网安装</a></p><p>我是在centos7上面安装的MongoDB 4.0，并且修改配置文件<code>/etc/mongod.conf</code>，将绑定端口设置成<code>0.0.0.0</code>，让其他主机也能访问。</p><p>启动mongodb后，添加一个用户，步骤如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mongo --port 27017</span><br><span class="line">use test</span><br><span class="line">db.createUser(</span><br><span class="line">   &#123;</span><br><span class="line">     user: &quot;xiongneng&quot;,</span><br><span class="line">     pwd: &quot;123456&quot;,</span><br><span class="line">     roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;test&quot; &#125; ]</span><br><span class="line">   &#125;</span><br><span class="line"> )</span><br></pre></td></tr></table></figure><h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>修改<code>application.yml</code>配置，增加mongodb的配置项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">data:</span></span><br><span class="line">    <span class="attr">mongodb:</span></span><br><span class="line">      <span class="attr">uri:</span> <span class="string">mongodb://xiongneng:123456@localhost:27017/test</span></span><br></pre></td></tr></table></figure><h2 id="定义实体类"><a href="#定义实体类" class="headerlink" title="定义实体类"></a>定义实体类</h2><p>这里只是为了测试，我就定义一个简单的客户类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Document</span>(collection = <span class="string">"customer"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Customer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Customer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Customer</span><span class="params">(String firstName, String lastName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstName = firstName;</span><br><span class="line">        <span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 省略get、set方法</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.format(</span><br><span class="line">                <span class="string">"Customer[id=%s, firstName='%s', lastName='%s']"</span>,</span><br><span class="line">                id, firstName, lastName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中的id属性是MongoDB用来唯一识别客户的主键，其实这里可以不用注解，因为默认就叫id。</p><p>另外MongoDB里面的数据会存储到集合中，Spring Data MongoDB会将Customer类的数据映射到名字叫<code>customer</code>的集合中。</p><h2 id="定义DAO类"><a href="#定义DAO类" class="headerlink" title="定义DAO类"></a>定义DAO类</h2><p>这里可继承<code>MongoRepository</code>，这样一些通用操作的方法，比如增删改查你就不用写了，只需要添加你自己自定义的其他方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CustomerRepository</span> <span class="keyword">extends</span> <span class="title">MongoRepository</span>&lt;<span class="title">Customer</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">Customer <span class="title">findByFirstName</span><span class="params">(String firstName)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;Customer&gt; <span class="title">findByLastName</span><span class="params">(String lastName)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我定义了两个简单查询方法，一个是根据名称查找单个客户，一个是根据姓来查找客户列表。 你无需去写实现类，运行时SpringBoot会自动帮你生成实现，这也是它的强大之处，将你从代码樊笼中解脱出来。</p><h2 id="编写服务类"><a href="#编写服务类" class="headerlink" title="编写服务类"></a>编写服务类</h2><p>接下来编写核心的业务服务类 <code>CustomerService</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CustomerRepository repository;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除所有的客户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        repository.deleteAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存客户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> customer 客户</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save</span><span class="params">(Customer customer)</span> </span>&#123;</span><br><span class="line">        repository.save(customer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有客户列表</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 客户列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Iterable&lt;Customer&gt; <span class="title">findAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> repository.findAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过名查找某个客户</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Customer <span class="title">findByFirstName</span><span class="params">(String firstName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> repository.findByFirstName(firstName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过姓查找客户列表</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title">findByLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> repository.findByLastName(lastName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="编写测试用例"><a href="#编写测试用例" class="headerlink" title="编写测试用例"></a>编写测试用例</h2><p>OK，一切准备妥当之后，我们来编写测试用例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(ApplicationTests<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CustomerService service;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试增删改查</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        service.deleteAll();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// save a couple of customers</span></span><br><span class="line">        service.save(<span class="keyword">new</span> Customer(<span class="string">"Alice"</span>, <span class="string">"Smith"</span>));</span><br><span class="line">        service.save(<span class="keyword">new</span> Customer(<span class="string">"Bob"</span>, <span class="string">"Smith"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// fetch all customers</span></span><br><span class="line">        System.out.println(<span class="string">"Customers found with findAll():"</span>);</span><br><span class="line">        System.out.println(<span class="string">"-------------------------------"</span>);</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Customer customer : service.findAll()) &#123;</span><br><span class="line">            System.out.println(customer);</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        assertThat(count, is(<span class="number">2</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// fetch an individual customer</span></span><br><span class="line">        System.out.println(<span class="string">"Customer found with findByFirstName('Alice'):"</span>);</span><br><span class="line">        System.out.println(<span class="string">"--------------------------------"</span>);</span><br><span class="line">        Customer c = service.findByFirstName(<span class="string">"Alice"</span>);</span><br><span class="line">        assertThat(c, notNullValue());</span><br><span class="line">        assertThat(c.getFirstName(), is(<span class="string">"Alice"</span>));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">"Customers found with findByLastName('Smith'):"</span>);</span><br><span class="line">        System.out.println(<span class="string">"--------------------------------"</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;Customer&gt; list = service.findByLastName(<span class="string">"Smith"</span>);</span><br><span class="line">        assertThat(list, notNullValue());</span><br><span class="line">        assertThat(list.size(), greaterThan(<span class="number">1</span>));</span><br><span class="line">        assertThat(list.size(), is(<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的测试中，我先删掉数据库中所有客户数据，然后新增两条数据，查询所有的数据，根据姓或名查询。</p><p>运行测试结果为green bar，同时输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Customers found with findAll():</span><br><span class="line">-------------------------------</span><br><span class="line">Customer[id&#x3D;5a9a30e616afd63f48afeea6, firstName&#x3D;&#39;Alice&#39;, lastName&#x3D;&#39;Smith&#39;]</span><br><span class="line">Customer[id&#x3D;5a9a30e616afd63f48afeea7, firstName&#x3D;&#39;Bob&#39;, lastName&#x3D;&#39;Smith&#39;]</span><br><span class="line">Customer found with findByFirstName(&#39;Alice&#39;):</span><br><span class="line">--------------------------------</span><br><span class="line">Customers found with findByLastName(&#39;Smith&#39;):</span><br></pre></td></tr></table></figure><p>更多关于MongoDB的使用，请移步 <a href="https://www.mongodb.com/" target="_blank" rel="noopener">官网</a></p><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-mongodb" target="_blank" rel="noopener">springboot-mongodb</a></p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="mongodb" scheme="https://zpengit.github.io/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 自己写starter</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E8%87%AA%E5%B7%B1%E5%86%99starter/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E8%87%AA%E5%B7%B1%E5%86%99starter/</id>
    <published>2020-06-08T02:43:46.470Z</published>
    <updated>2020-06-08T02:06:13.986Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-自己写starter"><a href="#SpringBoot系列-自己写starter" class="headerlink" title="SpringBoot系列 - 自己写starter"></a>SpringBoot系列 - 自己写starter</h1><p>Spring Boot由众多Starter组成，随着版本的推移Starter家族成员也与日俱增。在传统Maven项目中通常将一些层、组件拆分为模块来管理， 以便相互依赖复用，在Spring Boot项目中我们则可以创建自定义Spring Boot Starter来达成该目的。</p><p>可以认为starter是一种服务——使得使用某个功能的开发者不需要关注各种依赖库的处理，不需要具体的配置信息， 由Spring Boot自动通过classpath路径下的类发现需要的Bean，并织入相应的Bean。举个栗子，spring-boot-starter-jdbc这个starter的存在， 使得我们只需要在BookPubApplication下用@Autowired引入DataSource的bean就可以，Spring Boot会自动创建DataSource的实例。</p><p>本篇将通过一个简单的例子来演示如何编写自己的starter。</p><p>这里讲一下我们的Starter要实现的功能，很简单，提供一个Service，包含一个能够将字符串加上前后缀的方法String wrap(String word)。 而具体的前缀和后缀是通过读取SpringBoot配置文件<code>application.yml</code>而获取的。</p><h2 id="添加maven依赖"><a href="#添加maven依赖" class="headerlink" title="添加maven依赖"></a>添加maven依赖</h2><p>第一步当然是创建一个maven工程，添加SpringBoot的自动配置的依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xncoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>simple-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>simple-spring-boot-starter<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>一个简单的自定义starter<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- @ConfigurationProperties annotation processing (metadata for IDEs)</span></span><br><span class="line"><span class="comment">                 生成spring-configuration-metadata.json类，需要引入此类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-autoconfigure<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p>注意其中 <code>spring-boot-configuration-processor</code> 的作用是编译时生成<code>spring-configuration-metadata.json</code>， 此文件主要给IDE使用，用于提示使用。如在intellij idea中，当配置此jar相关配置属性在<code>application.yml</code>， 你可以用ctlr+鼠标左键，IDE会跳转到你配置此属性的类中。</p><p>这里说下artifactId的命名问题，Spring 官方 Starter通常命名为<code>spring-boot-starter-{name}</code> 如 <code>spring-boot-starter-web</code>。</p><p>Spring官方建议非官方Starter命名应遵循<code>{name}-spring-boot-starter</code>的格式。</p><h2 id="编写Service"><a href="#编写Service" class="headerlink" title="编写Service"></a>编写Service</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String prefix;</span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExampleService</span><span class="params">(String prefix, String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">wrap</span><span class="params">(String word)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> prefix + word + suffix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="编写属性类"><a href="#编写属性类" class="headerlink" title="编写属性类"></a>编写属性类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties</span>(<span class="string">"example.service"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleServiceProperties</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String prefix;</span><br><span class="line">    <span class="keyword">private</span> String suffix;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPrefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrefix</span><span class="params">(String prefix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.prefix = prefix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSuffix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> suffix;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSuffix</span><span class="params">(String suffix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.suffix = suffix;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="编写自动配置类"><a href="#编写自动配置类" class="headerlink" title="编写自动配置类"></a>编写自动配置类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ConditionalOnClass</span>(ExampleService<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableConfigurationProperties</span>(<span class="title">ExampleServiceProperties</span>.<span class="title">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ExampleAutoConfigure</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ExampleServiceProperties properties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExampleAutoConfigure</span><span class="params">(ExampleServiceProperties properties)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.properties = properties;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="meta">@ConditionalOnProperty</span>(prefix = <span class="string">"example.service"</span>, value = <span class="string">"enabled"</span>,havingValue = <span class="string">"true"</span>)</span><br><span class="line">    <span class="function">ExampleService <span class="title">exampleService</span> <span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">new</span> ExampleService(properties.getPrefix(),properties.getSuffix());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解释下用到的几个和Starter相关的注解：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. @ConditionalOnClass，当classpath下发现该类的情况下进行自动配置。</span><br><span class="line">2. @ConditionalOnMissingBean，当Spring Context中不存在该Bean时。</span><br><span class="line">3. @ConditionalOnProperty(prefix &#x3D; &quot;example.service&quot;,value &#x3D; &quot;enabled&quot;,havingValue &#x3D; &quot;true&quot;)，当配置文件中example.service.enabled&#x3D;true时。</span><br></pre></td></tr></table></figure><h2 id="添加spring-factories"><a href="#添加spring-factories" class="headerlink" title="添加spring.factories"></a>添加spring.factories</h2><p>最后一步，在<code>resources/META-INF/</code>下创建<code>spring.factories</code>文件，内容供参考下面：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration&#x3D;\</span><br><span class="line">com.xncoding.starter.config.ExampleAutoConfigure</span><br></pre></td></tr></table></figure><p>如果有多个自动配置类，用逗号分隔换行即可。</p><p>OK，完事，运行 <code>mvn:install</code> 打包安装，一个Spring Boot Starter便开发完成了。</p><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>打包好了当然要测试一下看看了。另外创建一个SpringBoot工程，在maven中引入这个starter依赖， 然后在单元测试中引入这个Service看看效果。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xncoding<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>simple-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>修改<code>application.yml</code>配置文件，添加如下内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">example.service:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">prefix:</span> <span class="string">ppp</span></span><br><span class="line">  <span class="attr">suffix:</span> <span class="string">sss</span></span><br></pre></td></tr></table></figure><p>测试类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ExampleService exampleService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testStarter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(exampleService.wrap(<span class="string">"hello"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ppphellosss</span><br></pre></td></tr></table></figure><p>完美！</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>总结下Starter的工作原理:</p><ol><li>Spring Boot在启动时扫描项目所依赖的JAR包，寻找包含<code>spring.factories</code>文件的JAR包</li><li>根据<code>spring.factories</code>配置加载AutoConfigure类</li><li>根据 <code>@Conditional</code> 注解的条件，进行自动配置并将Bean注入Spring Context</li></ol><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-starter" target="_blank" rel="noopener">springboot-starter</a>    —已测试</p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="starter" scheme="https://zpengit.github.io/tags/starter/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 异步线程池</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E5%BC%82%E6%AD%A5%E7%BA%BF%E7%A8%8B%E6%B1%A0/</id>
    <published>2020-06-08T02:43:40.520Z</published>
    <updated>2020-06-08T02:04:09.392Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-异步线程池"><a href="#SpringBoot系列-异步线程池" class="headerlink" title="SpringBoot系列 - 异步线程池"></a>SpringBoot系列 - 异步线程池</h1><p>在项目中，当访问其他人的接口较慢或者做耗时任务时，不想程序一直卡在耗时任务上，想程序能够并行执行， 我们可以使用多线程来并行的处理任务，也可以使用spring提供的异步处理方式@Async。</p><p>Spring异步线程池的接口类，其实质是<code>java.util.concurrent.Executor</code>。</p><p>Spring 已经实现的异常线程池：</p><ol><li><code>SimpleAsyncTaskExecutor</code>：不是真的线程池，这个类不重用线程，每次调用都会创建一个新的线程。</li><li><code>SyncTaskExecutor</code>：这个类没有实现异步调用，只是一个同步操作，只适用于不需要多线程的地方</li><li><code>ConcurrentTaskExecutor</code>：Executor的适配类，不推荐使用。如果<code>ThreadPoolTaskExecutor</code>不满足要求时，才用考虑使用这个类</li><li><code>SimpleThreadPoolTaskExecutor</code>：是Quartz的<code>SimpleThreadPool</code>的类。线程池同时被quartz和非quartz使用，才需要使用此类</li><li><code>ThreadPoolTaskExecutor</code>：最常使用，推荐。其实质是对<code>java.util.concurrent.ThreadPoolExecutor</code>的包装</li></ol><p>在异步处理的方法上添加注解<code>@Async</code>，就会启动一个新的线程去执行。</p><h2 id="开启异步配置"><a href="#开启异步配置" class="headerlink" title="开启异步配置"></a>开启异步配置</h2><p>SpringBoot中开启异步支持非常简单，只需要在配置类上面加上注解<code>@EnableAsync</code>，同时定义自己的线程池即可。 也可以不定义自己的线程池，则使用系统默认的线程池。这个注解可以放在Application启动类上，但是更推荐放在配置类上面。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncConfig</span> <span class="keyword">implements</span> <span class="title">AsyncConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异步处理方法分为不返回结果和返回结果，这两者的处理是有区别的。</p><h2 id="返回void"><a href="#返回void" class="headerlink" title="返回void"></a>返回void</h2><p>没有结果返回的示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncTask</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Async</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealNoReturnTask</span><span class="params">()</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">"返回值为void的异步调用开始"</span> + Thread.currentThread().getName());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"返回值为void的异步调用结束"</span> + Thread.currentThread().getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="返回Future"><a href="#返回Future" class="headerlink" title="返回Future"></a>返回Future</h2><p>异步调用返回数据，Future表示在未来某个点获取执行结果，返回数据类型可以自定义</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Async</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Future&lt;String&gt; <span class="title">dealHaveReturnTask</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"asyncInvokeReturnFuture, parementer="</span> + i);</span><br><span class="line">    Future&lt;String&gt; future;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span> * i);</span><br><span class="line">        future = <span class="keyword">new</span> AsyncResult&lt;String&gt;(<span class="string">"success:"</span> + i);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        future = <span class="keyword">new</span> AsyncResult&lt;String&gt;(<span class="string">"error"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> future;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上的异步方法和普通的方法调用相同：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;String&gt; future = asyncDemo.asyncInvokeReturnFuture(<span class="number">100</span>);</span><br><span class="line">System.out.println(future.get());</span><br></pre></td></tr></table></figure><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>我们可以实现<code>AsyncConfigurer</code>接口，也可以继承<code>AsyncConfigurerSupport</code>类来实现。</p><p>在方法getAsyncExecutor()中创建线程池的时候，必须使用 <code>executor.initialize()</code>，不然在调用时会报线程池未初始化的异常。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAsync</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncConfig</span> <span class="keyword">implements</span> <span class="title">AsyncConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">getAsyncExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskExecutor executor = <span class="keyword">new</span> ThreadPoolTaskExecutor();</span><br><span class="line">        executor.setCorePoolSize(<span class="number">10</span>);</span><br><span class="line">        executor.setMaxPoolSize(<span class="number">100</span>);</span><br><span class="line">        executor.setQueueCapacity(<span class="number">100</span>);</span><br><span class="line">        executor.setWaitForTasksToCompleteOnShutdown(<span class="keyword">true</span>);</span><br><span class="line">        executor.setAwaitTerminationSeconds(<span class="number">60</span> * <span class="number">10</span>);</span><br><span class="line">        executor.setThreadNamePrefix(<span class="string">"AsyncThread-"</span>);</span><br><span class="line">        executor.initialize(); <span class="comment">//如果不初始化，导致找到不到执行器</span></span><br><span class="line">        <span class="keyword">return</span> executor;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AsyncUncaughtExceptionHandler <span class="title">getAsyncUncaughtExceptionHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AsyncExceptionHandler();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异步异常处理类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncExceptionHandler</span> <span class="keyword">implements</span> <span class="title">AsyncUncaughtExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(AsyncExceptionHandler<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleUncaughtException</span><span class="params">(Throwable ex, Method method, Object... params)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"Async method has uncaught exception, params: "</span> + params);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ex <span class="keyword">instanceof</span> AsyncException) &#123;</span><br><span class="line">            AsyncException asyncException = (AsyncException) ex;</span><br><span class="line">            log.info(<span class="string">"asyncException:"</span>  + asyncException.getMsg());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        log.error(<span class="string">"Exception :"</span>, ex);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>异步处理异常类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCode</span><span class="params">(<span class="keyword">int</span> code)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> msg;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.msg = msg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在调用方法时，可能出现方法中抛出异常的情况。Spring对于2种异步方法的异常处理机制如下：</p><ol><li>对于方法返回值是Futrue的异步方法: a) 在调用future的get时捕获异常; b) 在异常方法中直接捕获异常</li><li>对于返回值是void的异步方法：通过<code>AsyncUncaughtExceptionHandler</code>处理异常</li></ol><h2 id="测试代码"><a href="#测试代码" class="headerlink" title="测试代码"></a>测试代码</h2><p>最后写个测试代码看看是否跟预期一致：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试异步任务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">ApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(ApplicationTests<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AsyncTask asyncTask;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testAsync</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException </span>&#123;</span><br><span class="line">        asyncTask.dealNoReturnTask();</span><br><span class="line">        Future&lt;String&gt; f = asyncTask.dealHaveReturnTask(<span class="number">5</span>);</span><br><span class="line">        log.info(<span class="string">"主线程执行finished"</span>);</span><br><span class="line">        log.info(f.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行日志如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INFO 4180 --- [           main] com.xncoding.pos.ApplicationTests         : 主线程执行finished</span><br><span class="line">INFO 4180 --- [  AsyncThread-2] com.xncoding.pos.async.AsyncTask          : asyncInvokeReturnFuture, parementer&#x3D;5</span><br><span class="line">INFO 4180 --- [  AsyncThread-1] com.xncoding.pos.async.AsyncTask          : 返回值为void的异步调用开始AsyncThread-1</span><br><span class="line">INFO 4180 --- [  AsyncThread-1] com.xncoding.pos.async.AsyncTask          : 返回值为void的异步调用结束AsyncThread-1</span><br><span class="line">INFO 4180 --- [           main] com.xncoding.pos.ApplicationTests         : success:5</span><br><span class="line">INFO 4180 --- [       Thread-4] o.s.w.c.s.GenericWebApplicationContext   : Closing ....</span><br><span class="line">INFO 4180 --- [       Thread-4] com.alibaba.druid.pool.DruidDataSource   : &#123;dataSource-1&#125; closed</span><br></pre></td></tr></table></figure><p>根据日志的线程名称很清楚的看出，每个异步方法在线程池的不同线程中执行。</p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p>实际运行中，还出现过一个问题，一个Service中的方法调用自己的另一个方法，然后我将这个方法加上@Async注解，然而并不起作用。 异步方法都应该放到单独的异步任务Bean里面去，然后将这个Bean注入到Service中即可。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AsyncTask asyncTask;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">unbind</span><span class="params">(Integer id, ManagerInfo managerInfo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 前面省略...</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开始异步推送消息</span></span><br><span class="line">        asyncTask.pushUnbindMsg(managerInfo, pos, location);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-async" target="_blank" rel="noopener">springboot-async</a>   —已测试</p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="async" scheme="https://zpengit.github.io/tags/async/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 使用消息队列RabbitMQ</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ/</id>
    <published>2020-06-08T02:43:28.825Z</published>
    <updated>2020-06-08T02:23:30.045Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-使用消息队列RabbitMQ"><a href="#SpringBoot系列-使用消息队列RabbitMQ" class="headerlink" title="SpringBoot系列 - 使用消息队列RabbitMQ"></a>SpringBoot系列 - 使用消息队列RabbitMQ</h1><p>RabbitMQ 即一个消息队列，主要是用来实现应用程序的异步和解耦，同时也能起到消息缓冲，消息分发的作用。</p><p>RabbitMQ是实现AMQP（高级消息队列协议）的消息中间件的一种，AMQP，即Advanced Message Queuing Protocol， 高级消息队列协议，是应用层协议的一个开放标准，为面向消息的中间件设计。</p><p>在项目中，将一些无需即时返回且耗时的操作提取出来，进行了异步处理，而这种异步处理的方式大大的节省了服务器的请求响应时间， 提高了系统的吞吐量。</p><p>本篇将详细介绍RabbitMQ以及如何在SpringBoot中使用。</p><h2 id="简单概念"><a href="#简单概念" class="headerlink" title="简单概念"></a>简单概念</h2><p>关于消息中间件RabbitMQ的详细介绍可以参考我的博客系列教程：<a href="https://www.xncoding.com/tags/rabbitmq/" target="_blank" rel="noopener">RabbitMQ简易教程</a></p><p>这里我只对一些最核心的概念拿出来讲一下，不理解这些就根本无法理解下面的代码。</p><p>几个名词术语：</p><ul><li>Broker - 简单来说就是消息队列服务器的实体。</li><li>Exchange - 消息路由器，转发消息到绑定的队列上，指定消息按什么规则，路由到哪个队列。</li><li>Queue - 消息队列，用来存储消息，每个消息都会被投入到一个或多个队列。</li><li>Binding - 绑定，它的作用就是把 Exchange 和 Queue 按照路由规则绑定起来。</li><li>RoutingKey - 路由关键字，Exchange 根据这个关键字进行消息投递。</li><li>Producter - 消息生产者，产生消息的程序。</li><li>Consumer - 消息消费者，接收消息的程序。</li><li>Channel - 消息通道，在客户端的每个连接里可建立多个Channel，每个channel代表一个会话。</li></ul><p>一般消息队列都是生产者将消息发送到队列，消费者监听队列进行消费。rabbitmq中一个虚拟主机（默认 /）持有一个或者多个交换机（Exchange）。 用户只能在虚拟主机的粒度进行权限控制，交换机根据一定的策略（RoutingKey）绑定(Binding)到队列(Queue)上， 这样生产者和队列就没有直接联系，而是将消息发送的交换机，交换机再把消息转发到对应绑定的队列上。</p><p>上面说了交换机（Exchange）作为rabbitmq的一个独特的重要的概念，单独拿出来讲一下。我们用到的最常见的是4中类型：</p><ol><li>Direct: 先匹配, 再投送。即在绑定时设定一个routing_key, 消息的routing_key匹配时, 才会被交换器投送到绑定的队列中去. 交换机跟队列必须是精确的对应关系，这种最为简单。</li><li>Topic: 转发消息主要是根据通配符。在这种交换机下，队列和交换机的绑定会定义一种路由模式，那么，通配符就要在这种路由模式和路由键之间匹配后交换机才能转发消息 这种可以认为是Direct 的灵活版</li><li>Headers: 也是根据规则匹配, 相较于 direct 和 topic 固定地使用 routingkey , headers则是一个自定义匹配规则的类型， 在队列与交换器绑定时会设定一组键值对规则，消息中也包括一组键值对( headers属性)，当这些键值对有一对或全部匹配时，消息被投送到对应队列</li><li>Fanout : 消息广播模式，不管路由键或者是路由模式，会把消息发给绑定给它的全部队列，如果配置了routingkey会被忽略</li></ol><p>理解交换机如何投送消息的原理后，后面的就比较简单了。</p><h2 id="Ack机制"><a href="#Ack机制" class="headerlink" title="Ack机制"></a>Ack机制</h2><p>在RabbitMQ的消息队列编程中，有个非常重要的概率叫消息确认机制，也就是Ack机制，这里我需要单独讲一下。</p><p>每个Consumer可能需要一段时间才能处理完收到的数据。如果在这个过程中，Consumer出错了或者异常退出了，而数据还没有处理完成，那么非常不幸，这段数据就丢失了。</p><p>因为我们采用no-ack的方式进行确认，也就是说，每次Consumer接到数据后，而不管是否处理完成，RabbitMQ Server会立即把这个Message标记为完成，然后从queue中删除了。 如果一个Consumer异常退出了，它处理的数据能够被另外的Consumer处理，这样数据在这种情况下就不会丢失了（注意是这种情况下）。</p><p>为了保证数据不被丢失，RabbitMQ支持消息确认机制，即acknowledgments。为了保证数据能被正确处理而不仅仅是被Consumer收到，那么我们不能采用no-ack。而应该是在处理完数据后发送ack。 在处理数据后发送的ack，就是告诉RabbitMQ数据已经被接收，处理完成，RabbitMQ可以去安全的删除它了。</p><p>如果Consumer退出了但是没有发送ack，那么RabbitMQ就会把这个Message发送到下一个Consumer。这样就保证了在Consumer异常退出的情况下数据也不会丢失。</p><p>这里并没有用到超时机制。RabbitMQ仅仅通过Consumer的连接中断来确认该Message并没有被正确处理。也就是说，RabbitMQ给了Consumer足够长的时间来做数据处理。 这样即使你通过Ctr-C中断了Recieve.cs，那么Message也不会丢失了，它会被分发到下一个Consumer。</p><p>如果忘记了ack，那么后果很严重。当Consumer退出时，Message会重新分发。然后RabbitMQ会占用越来越多的内存，由于RabbitMQ会长时间运行，因此这个“内存泄漏”是致命的。</p><p>下面的例子中我会使用手动Ack模式。</p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>RabbitMQ需要安装erlang和RabbitMQ Server， 安装教程请参考：<a href="https://www.xncoding.com/2017/05/06/mq/rabbitmq-tutorial01.html" target="_blank" rel="noopener">RabbitMQ简易教程 - 安装</a></p><p>请先按照教程安装好RabbitMQ后，添加一个用户spring/123456，后面配置要用到。</p><h2 id="SpringBoot中集成"><a href="#SpringBoot中集成" class="headerlink" title="SpringBoot中集成"></a>SpringBoot中集成</h2><p>接下来正式开始讲解如何在SpringBoot中集成了。</p><h3 id="maven依赖"><a href="#maven依赖" class="headerlink" title="maven依赖"></a>maven依赖</h3><p>第一版当然是先添加maven依赖了，有官方现成的starter依赖，如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.vaadin.external.google<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>android-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>在application.yml中添加rabbitmq相关配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">spring</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">publisher-confirms:</span> <span class="literal">true</span> <span class="comment">#支持发布确认</span></span><br><span class="line">    <span class="attr">publisher-returns:</span> <span class="literal">true</span>  <span class="comment">#支持发布返回</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">acknowledge-mode:</span> <span class="string">manual</span> <span class="comment">#采用手动应答</span></span><br><span class="line">        <span class="attr">concurrency:</span> <span class="number">1</span> <span class="comment">#指定最小的消费者数量</span></span><br><span class="line">        <span class="attr">max-concurrency:</span> <span class="number">1</span> <span class="comment">#指定最大的消费者数量</span></span><br><span class="line">        <span class="attr">retry:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#是否支持重试</span></span><br></pre></td></tr></table></figure><h3 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h3><p>最核心的类就是RabbitMQ的配置类，在里面定制模版类、声明交换机、队列、绑定交换机到队列。</p><p>这里我声明了一个Direct类型的交换机，并通过路由键绑定到一个队列中来测试Direct模式， 另外还声明了Fanout类型的交换机，并绑定到2个队列来测试广播模式。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 定制化amqp模版      可根据需要定制多个</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 此处为模版类定义 Jackson消息转换器</span></span><br><span class="line"><span class="comment">     * ConfirmCallback接口用于实现消息发送到RabbitMQ交换器后接收ack回调   即消息发送到exchange  ack</span></span><br><span class="line"><span class="comment">     * ReturnCallback接口用于实现消息发送到RabbitMQ 交换器，但无相应队列与交换器绑定时的回调  即消息发送不到任何一个队列中  ack</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the amqp template</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">// @Primary</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> AmqpTemplate <span class="title">amqpTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Logger log = LoggerFactory.getLogger(RabbitTemplate<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        <span class="comment">// 使用jackson 消息转换器</span></span><br><span class="line">        rabbitTemplate.setMessageConverter(<span class="keyword">new</span> Jackson2JsonMessageConverter());</span><br><span class="line">        rabbitTemplate.setEncoding(<span class="string">"UTF-8"</span>);</span><br><span class="line">        <span class="comment">// 消息发送失败返回到队列中，yml需要配置 publisher-returns: true</span></span><br><span class="line">        rabbitTemplate.setMandatory(<span class="keyword">true</span>);</span><br><span class="line">        rabbitTemplate.setReturnCallback((message, replyCode, replyText, exchange, routingKey) -&gt; &#123;</span><br><span class="line">            String correlationId = message.getMessageProperties().getCorrelationIdString();</span><br><span class="line">            log.debug(<span class="string">"消息：&#123;&#125; 发送失败, 应答码：&#123;&#125; 原因：&#123;&#125; 交换机: &#123;&#125;  路由键: &#123;&#125;"</span>, correlationId, replyCode, replyText, exchange, routingKey);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 消息确认，yml需要配置 publisher-confirms: true</span></span><br><span class="line">        rabbitTemplate.setConfirmCallback((correlationData, ack, cause) -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (ack) &#123;</span><br><span class="line">                log.debug(<span class="string">"消息发送到exchange成功,id: &#123;&#125;"</span>, correlationData.getId());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                log.debug(<span class="string">"消息发送到exchange失败,原因: &#123;&#125;"</span>, cause);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> rabbitTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ----------------------------------------------------------------------------Direct exchange test--------------------------------------------------------------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 声明Direct交换机 支持持久化.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the exchange</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"directExchange"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Exchange <span class="title">directExchange</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.directExchange(<span class="string">"DIRECT_EXCHANGE"</span>).durable(<span class="keyword">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 声明一个队列 支持持久化.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the queue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"directQueue"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">directQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(<span class="string">"DIRECT_QUEUE"</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过绑定键 将指定队列绑定到一个指定的交换机 .</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> queue    the queue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exchange the exchange</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the binding</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">directBinding</span><span class="params">(@Qualifier(<span class="string">"directQueue"</span>)</span> Queue queue,</span></span><br><span class="line"><span class="function">                                 @<span class="title">Qualifier</span><span class="params">(<span class="string">"directExchange"</span>)</span> Exchange exchange) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">"DIRECT_ROUTING_KEY"</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* ----------------------------------------------------------------------------Fanout exchange test--------------------------------------------------------------------------- */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 声明 fanout 交换机.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the exchange</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"fanoutExchange"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> FanoutExchange <span class="title">fanoutExchange</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (FanoutExchange) ExchangeBuilder.fanoutExchange(<span class="string">"FANOUT_EXCHANGE"</span>).durable(<span class="keyword">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Fanout queue A.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the queue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"fanoutQueueA"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">fanoutQueueA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(<span class="string">"FANOUT_QUEUE_A"</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Fanout queue B .</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the queue</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span>(<span class="string">"fanoutQueueB"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">fanoutQueueB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(<span class="string">"FANOUT_QUEUE_B"</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绑定队列A 到Fanout 交换机.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> queue          the queue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fanoutExchange the fanout exchange</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the binding</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">bindingA</span><span class="params">(@Qualifier(<span class="string">"fanoutQueueA"</span>)</span> Queue queue,</span></span><br><span class="line"><span class="function">                            @<span class="title">Qualifier</span><span class="params">(<span class="string">"fanoutExchange"</span>)</span> FanoutExchange fanoutExchange) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 绑定队列B 到Fanout 交换机.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> queue          the queue</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fanoutExchange the fanout exchange</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the binding</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">bindingB</span><span class="params">(@Qualifier(<span class="string">"fanoutQueueB"</span>)</span> Queue queue,</span></span><br><span class="line"><span class="function">                            @<span class="title">Qualifier</span><span class="params">(<span class="string">"fanoutExchange"</span>)</span> FanoutExchange fanoutExchange) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h3><p>接下来编写消息队列的监听器类，监听队列消息并做相应的处理，并通过Ack机制确认处理完成：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 消息监听器</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiongNeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Receiver</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger log = LoggerFactory.getLogger(Receiver<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * FANOUT广播队列监听一.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message the message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel the channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException the io exception  这里异常需要处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RabbitListener</span>(queues = &#123;<span class="string">"FANOUT_QUEUE_A"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">on</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="keyword">true</span>);</span><br><span class="line">        log.debug(<span class="string">"FANOUT_QUEUE_A "</span> + <span class="keyword">new</span> String(message.getBody()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * FANOUT广播队列监听二.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message the message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel the channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException the io exception   这里异常需要处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RabbitListener</span>(queues = &#123;<span class="string">"FANOUT_QUEUE_B"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="keyword">true</span>);</span><br><span class="line">        log.debug(<span class="string">"FANOUT_QUEUE_B "</span> + <span class="keyword">new</span> String(message.getBody()));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * DIRECT模式.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message the message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel the channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException the io exception  这里异常需要处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RabbitListener</span>(queues = &#123;<span class="string">"DIRECT_QUEUE"</span>&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">message</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="keyword">true</span>);</span><br><span class="line">        log.debug(<span class="string">"DIRECT "</span> + <span class="keyword">new</span> String(message.getBody()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="消息发送者"><a href="#消息发送者" class="headerlink" title="消息发送者"></a>消息发送者</h3><p>再写一个消息发送服务，用来向交换机发送消息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 消息发送服务</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SenderService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Logger logger = LoggerFactory.getLogger(<span class="keyword">this</span>.getClass());</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试广播模式.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> p the p</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the response entity</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">broadcast</span><span class="params">(String p)</span> </span>&#123;</span><br><span class="line">        CorrelationData correlationData = <span class="keyword">new</span> CorrelationData(UUID.randomUUID().toString());</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">"FANOUT_EXCHANGE"</span>, <span class="string">""</span>, p, correlationData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 测试Direct模式.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> p the p</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the response entity</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">direct</span><span class="params">(String p)</span> </span>&#123;</span><br><span class="line">        CorrelationData correlationData = <span class="keyword">new</span> CorrelationData(UUID.randomUUID().toString());</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">"DIRECT_EXCHANGE"</span>, <span class="string">"DIRECT_ROUTING_KEY"</span>, p, correlationData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="运行测试"><a href="#运行测试" class="headerlink" title="运行测试"></a>运行测试</h2><p>代码写完后当然要写个测试用例测一下嘛。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * SenderServiceTest</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiongNeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span>(<span class="title">classes</span> </span>= Application<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SenderServiceTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SenderService senderService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCache</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 测试广播模式</span></span><br><span class="line">        senderService.broadcast(<span class="string">"同学们集合啦！"</span>);</span><br><span class="line">        <span class="comment">// 测试Direct模式</span></span><br><span class="line">        senderService.direct(<span class="string">"定点消息"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行结果：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[cTaskExecutor-1]</span> <span class="selector-tag">com</span><span class="selector-class">.xncoding</span><span class="selector-class">.pos</span><span class="selector-class">.mq</span><span class="selector-class">.Receiver</span>             : <span class="selector-tag">FANOUT_QUEUE_A</span> "同学们集合啦！"</span><br><span class="line"><span class="selector-attr">[cTaskExecutor-1]</span> <span class="selector-tag">com</span><span class="selector-class">.xncoding</span><span class="selector-class">.pos</span><span class="selector-class">.mq</span><span class="selector-class">.Receiver</span>             : <span class="selector-tag">DIRECT</span> "定点消息"</span><br><span class="line"><span class="selector-attr">[cTaskExecutor-1]</span> <span class="selector-tag">com</span><span class="selector-class">.xncoding</span><span class="selector-class">.pos</span><span class="selector-class">.mq</span><span class="selector-class">.Receiver</span>             : <span class="selector-tag">FANOUT_QUEUE_B</span> "同学们集合啦！"</span><br></pre></td></tr></table></figure><p>可以看到，广播消息被两个队列收到了，Direct消息只有一个收到。完美！</p><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-rabbitmq" target="_blank" rel="noopener">springboot-rabbitmq</a>   —已测试</p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="rabbitmq" scheme="https://zpengit.github.io/tags/rabbitmq/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 使用RestTemplate</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8RestTemplate/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8RestTemplate/</id>
    <published>2020-06-08T02:43:22.489Z</published>
    <updated>2020-06-07T17:07:55.129Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-使用RestTemplate"><a href="#SpringBoot系列-使用RestTemplate" class="headerlink" title="SpringBoot系列 - 使用RestTemplate"></a>SpringBoot系列 - 使用RestTemplate</h1><p>spring框架提供的RestTemplate类可用于在应用中调用rest服务，它简化了与http服务的通信方式，统一了RESTful的标准，封装了http链接， 我们只需要传入url及返回值类型即可。相较于之前常用的HttpClient，RestTemplate是一种更优雅的调用RESTful服务的方式。</p><p>RestTemplate默认依赖JDK提供http连接的能力（HttpURLConnection），如果有需要的话也可以通过setRequestFactory方法替换为例如 Apache HttpComponents、Netty或OkHttp等其它HTTP library。</p><p>本篇介绍如何使用RestTemplate，以及在SpringBoot里面的配置和注入。</p><h2 id="实现逻辑"><a href="#实现逻辑" class="headerlink" title="实现逻辑"></a>实现逻辑</h2><p>RestTemplate包含以下几个部分：</p><ul><li>HttpMessageConverter 对象转换器</li><li>ClientHttpRequestFactory 默认是JDK的HttpURLConnection</li><li>ResponseErrorHandler 异常处理</li><li>ClientHttpRequestInterceptor 请求拦截器</li></ul><p>用一张图可以很直观的理解：</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591541739-db62a5cdf220fad877b16009e6f23c61.png" alt=""></p><p>直接使用方式很简单：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestTemplateTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RestTemplate restT = <span class="keyword">new</span> RestTemplate();</span><br><span class="line">        <span class="comment">//通过Jackson JSON processing library直接将返回值绑定到对象</span></span><br><span class="line">        Quote quote = restT.getForObject(<span class="string">"http://gturnquist-quoters.cfapps.io/api/random"</span>, Quote<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        String quoteString = restT.getForObject(<span class="string">"http://gturnquist-quoters.cfapps.io/api/random"</span>, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        System.out.println(quoteString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="发送GET请求"><a href="#发送GET请求" class="headerlink" title="发送GET请求"></a>发送GET请求</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1-getForObject()</span></span><br><span class="line">User user1 = <span class="keyword">this</span>.restTemplate.getForObject(uri, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2-getForEntity()</span></span><br><span class="line">ResponseEntity&lt;User&gt; responseEntity1 = <span class="keyword">this</span>.restTemplate.getForEntity(uri, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">HttpStatus statusCode = responseEntity1.getStatusCode();</span><br><span class="line">HttpHeaders header = responseEntity1.getHeaders();</span><br><span class="line">User user2 = responseEntity1.getBody();</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 3-exchange()</span></span><br><span class="line">RequestEntity requestEntity = RequestEntity.get(<span class="keyword">new</span> URI(uri)).build();</span><br><span class="line">ResponseEntity&lt;User&gt; responseEntity2 = <span class="keyword">this</span>.restTemplate.exchange(requestEntity, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">User user3 = responseEntity2.getBody();</span><br></pre></td></tr></table></figure><h2 id="发送POST请求"><a href="#发送POST请求" class="headerlink" title="发送POST请求"></a>发送POST请求</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1-postForObject()</span></span><br><span class="line">User user1 = <span class="keyword">this</span>.restTemplate.postForObject(uri, user, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2-postForEntity()</span></span><br><span class="line">ResponseEntity&lt;User&gt; responseEntity1 = <span class="keyword">this</span>.restTemplate.postForEntity(uri, user, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3-exchange()</span></span><br><span class="line">RequestEntity&lt;User&gt; requestEntity = RequestEntity.post(<span class="keyword">new</span> URI(uri)).body(user);</span><br><span class="line">ResponseEntity&lt;User&gt; responseEntity2 = <span class="keyword">this</span>.restTemplate.exchange(requestEntity, User<span class="class">.<span class="keyword">class</span>)</span>;</span><br></pre></td></tr></table></figure><h2 id="设置HTTP-Header"><a href="#设置HTTP-Header" class="headerlink" title="设置HTTP Header"></a>设置HTTP Header</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1-Content-Type</span></span><br><span class="line">RequestEntity&lt;User&gt; requestEntity = RequestEntity</span><br><span class="line">        .post(<span class="keyword">new</span> URI(uri))</span><br><span class="line">        .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">        .body(user);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2-Accept</span></span><br><span class="line">RequestEntity&lt;User&gt; requestEntity = RequestEntity</span><br><span class="line">        .post(<span class="keyword">new</span> URI(uri))</span><br><span class="line">        .accept(MediaType.APPLICATION_JSON)</span><br><span class="line">        .body(user);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3-Other</span></span><br><span class="line">RequestEntity&lt;User&gt; requestEntity = RequestEntity</span><br><span class="line">        .post(<span class="keyword">new</span> URI(uri))</span><br><span class="line">        .header(<span class="string">"Authorization"</span>, <span class="string">"Basic "</span> + base64Credentials)</span><br><span class="line">        .body(user);</span><br></pre></td></tr></table></figure><h2 id="捕获异常"><a href="#捕获异常" class="headerlink" title="捕获异常"></a>捕获异常</h2><p>捕获<code>HttpServerErrorException</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    responseEntity = restTemplate.exchange(requestEntity, String<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (HttpServerErrorException e) &#123;</span><br><span class="line">    <span class="comment">// log error</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="自定义异常处理器"><a href="#自定义异常处理器" class="headerlink" title="自定义异常处理器"></a>自定义异常处理器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomErrorHandler</span> <span class="keyword">extends</span> <span class="title">DefaultResponseErrorHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleError</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// todo</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后设置下异常处理器：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestClientConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        RestTemplate restTemplate = <span class="keyword">new</span> RestTemplate();</span><br><span class="line">        restTemplate.setErrorHandler(<span class="keyword">new</span> CustomErrorHandler());</span><br><span class="line">        <span class="keyword">return</span> restTemplate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="配置类"><a href="#配置类" class="headerlink" title="配置类"></a>配置类</h2><p>创建<code>HttpClientConfig</code>类，设置连接池大小、超时时间、重试机制等。配置如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * - Supports both HTTP and HTTPS</span></span><br><span class="line"><span class="comment"> * - Uses a connection pool to re-use connections and save overhead of creating connections.</span></span><br><span class="line"><span class="comment"> * - Has a custom connection keep-alive strategy (to apply a default keep-alive if one isn't specified)</span></span><br><span class="line"><span class="comment"> * - Starts an idle connection monitor to continuously clean up stale connections.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiongNeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2018/7/5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClientConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(HttpClientConfig<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> HttpClientProperties p;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PoolingHttpClientConnectionManager <span class="title">poolingConnectionManager</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        SSLContextBuilder builder = <span class="keyword">new</span> SSLContextBuilder();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            builder.loadTrustMaterial(<span class="keyword">null</span>, <span class="keyword">new</span> TrustStrategy() &#123;</span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isTrusted</span><span class="params">(X509Certificate[] arg0, String arg1)</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException | KeyStoreException e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">"Pooling Connection Manager Initialisation failure because of "</span> + e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        SSLConnectionSocketFactory sslsf = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sslsf = <span class="keyword">new</span> SSLConnectionSocketFactory(builder.build());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (KeyManagementException | NoSuchAlgorithmException e) &#123;</span><br><span class="line">            LOGGER.error(<span class="string">"Pooling Connection Manager Initialisation failure because of "</span> + e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Registry&lt;ConnectionSocketFactory&gt; socketFactoryRegistry = RegistryBuilder</span><br><span class="line">                .&lt;ConnectionSocketFactory&gt;create()</span><br><span class="line">                .register(<span class="string">"https"</span>, sslsf)</span><br><span class="line">                .register(<span class="string">"http"</span>, <span class="keyword">new</span> PlainConnectionSocketFactory())</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        PoolingHttpClientConnectionManager poolingConnectionManager = <span class="keyword">new</span> PoolingHttpClientConnectionManager(socketFactoryRegistry);</span><br><span class="line">        poolingConnectionManager.setMaxTotal(p.getMaxTotalConnections());  <span class="comment">//最大连接数</span></span><br><span class="line">        poolingConnectionManager.setDefaultMaxPerRoute(p.getDefaultMaxPerRoute());  <span class="comment">//同路由并发数</span></span><br><span class="line">        <span class="keyword">return</span> poolingConnectionManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ConnectionKeepAliveStrategy <span class="title">connectionKeepAliveStrategy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConnectionKeepAliveStrategy() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getKeepAliveDuration</span><span class="params">(HttpResponse response, HttpContext httpContext)</span> </span>&#123;</span><br><span class="line">                HeaderElementIterator it = <span class="keyword">new</span> BasicHeaderElementIterator</span><br><span class="line">                        (response.headerIterator(HTTP.CONN_KEEP_ALIVE));</span><br><span class="line">                <span class="keyword">while</span> (it.hasNext()) &#123;</span><br><span class="line">                    HeaderElement he = it.nextElement();</span><br><span class="line">                    String param = he.getName();</span><br><span class="line">                    String value = he.getValue();</span><br><span class="line">                    <span class="keyword">if</span> (value != <span class="keyword">null</span> &amp;&amp; param.equalsIgnoreCase(<span class="string">"timeout"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> Long.parseLong(value) * <span class="number">1000</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> p.getDefaultKeepAliveTimeMillis();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CloseableHttpClient <span class="title">httpClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        RequestConfig requestConfig = RequestConfig.custom()</span><br><span class="line">                .setConnectionRequestTimeout(p.getRequestTimeout())</span><br><span class="line">                .setConnectTimeout(p.getConnectTimeout())</span><br><span class="line">                .setSocketTimeout(p.getSocketTimeout()).build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> HttpClients.custom()</span><br><span class="line">                .setDefaultRequestConfig(requestConfig)</span><br><span class="line">                .setConnectionManager(poolingConnectionManager())</span><br><span class="line">                .setKeepAliveStrategy(connectionKeepAliveStrategy())</span><br><span class="line">                .setRetryHandler(<span class="keyword">new</span> DefaultHttpRequestRetryHandler(<span class="number">3</span>, <span class="keyword">true</span>))  <span class="comment">// 重试次数</span></span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Runnable <span class="title">idleConnectionMonitor</span><span class="params">(<span class="keyword">final</span> PoolingHttpClientConnectionManager connectionManager)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="meta">@Scheduled</span>(fixedDelay = <span class="number">10000</span>)</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (connectionManager != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        LOGGER.trace(<span class="string">"run IdleConnectionMonitor - Closing expired and idle connections..."</span>);</span><br><span class="line">                        connectionManager.closeExpiredConnections();</span><br><span class="line">                        connectionManager.closeIdleConnections(p.getCloseIdleConnectionWaitTimeSecs(), TimeUnit.SECONDS);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        LOGGER.trace(<span class="string">"run IdleConnectionMonitor - Http Client Connection manager is not initialised"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    LOGGER.error(<span class="string">"run IdleConnectionMonitor - Exception occurred. msg=&#123;&#125;, e=&#123;&#125;"</span>, e.getMessage(), e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> TaskScheduler <span class="title">taskScheduler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ThreadPoolTaskScheduler scheduler = <span class="keyword">new</span> ThreadPoolTaskScheduler();</span><br><span class="line">        scheduler.setThreadNamePrefix(<span class="string">"poolScheduler"</span>);</span><br><span class="line">        scheduler.setPoolSize(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">return</span> scheduler;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后再配置RestTemplateConfig类，使用之前配置好的CloseableHttpClient类注入，同时配置一些默认的消息转换器：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * RestTemplate客户端连接池配置</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> XiongNeng</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2018/1/24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableAspectJAutoProxy</span>(proxyTargetClass = <span class="keyword">true</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestTemplateConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> CloseableHttpClient httpClient;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">restTemplate</span><span class="params">(MappingJackson2HttpMessageConverter jackson2HttpMessageConverter)</span> </span>&#123;</span><br><span class="line">        RestTemplate restTemplate = <span class="keyword">new</span> RestTemplate(clientHttpRequestFactory());</span><br><span class="line"></span><br><span class="line">        List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        StringHttpMessageConverter stringHttpMessageConverter = <span class="keyword">new</span> StringHttpMessageConverter(Charset.forName(<span class="string">"utf-8"</span>));</span><br><span class="line">        messageConverters.add(stringHttpMessageConverter);</span><br><span class="line">        messageConverters.add(jackson2HttpMessageConverter);</span><br><span class="line">        restTemplate.setMessageConverters(messageConverters);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> restTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> HttpComponentsClientHttpRequestFactory <span class="title">clientHttpRequestFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        HttpComponentsClientHttpRequestFactory rf = <span class="keyword">new</span> HttpComponentsClientHttpRequestFactory();</span><br><span class="line">        rf.setHttpClient(httpClient);</span><br><span class="line">        <span class="keyword">return</span> rf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意，如果没有apache的HttpClient类，需要在pom文件中添加：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>httpclient<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.5.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="发送文件"><a href="#发送文件" class="headerlink" title="发送文件"></a>发送文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MultiValueMap&lt;String, Object&gt; multiPartBody = <span class="keyword">new</span> LinkedMultiValueMap&lt;&gt;();</span><br><span class="line">multiPartBody.add(<span class="string">"file"</span>, <span class="keyword">new</span> ClassPathResource(<span class="string">"/tmp/user.txt"</span>));</span><br><span class="line">RequestEntity&lt;MultiValueMap&lt;String, Object&gt;&gt; requestEntity = RequestEntity</span><br><span class="line">        .post(uri)</span><br><span class="line">        .contentType(MediaType.MULTIPART_FORM_DATA)</span><br><span class="line">        .body(multiPartBody);</span><br></pre></td></tr></table></figure><h2 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 小文件</span></span><br><span class="line">RequestEntity requestEntity = RequestEntity.get(uri).build();</span><br><span class="line">ResponseEntity&lt;<span class="keyword">byte</span>[]&gt; responseEntity = restTemplate.exchange(requestEntity, <span class="keyword">byte</span>[]<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="keyword">byte</span>[] downloadContent = responseEntity.getBody();</span><br><span class="line">  </span><br><span class="line"><span class="comment">// 大文件  </span></span><br><span class="line">ResponseExtractor&lt;ResponseEntity&lt;File&gt;&gt; responseExtractor = <span class="keyword">new</span> ResponseExtractor&lt;ResponseEntity&lt;File&gt;&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseEntity&lt;File&gt; <span class="title">extractData</span><span class="params">(ClientHttpResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        File rcvFile = File.createTempFile(<span class="string">"rcvFile"</span>, <span class="string">"zip"</span>);</span><br><span class="line">        FileCopyUtils.copy(response.getBody(), <span class="keyword">new</span> FileOutputStream(rcvFile));</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(response.getStatusCode()).headers(response.getHeaders()).body(rcvFile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">File getFile = <span class="keyword">this</span>.restTemplate.execute(targetUri, HttpMethod.GET, <span class="keyword">null</span>, responseExtractor);</span><br></pre></td></tr></table></figure><h2 id="Service注入"><a href="#Service注入" class="headerlink" title="Service注入"></a>Service注入</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DeviceService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(DeviceService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="实际使用例子"><a href="#实际使用例子" class="headerlink" title="实际使用例子"></a>实际使用例子</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开始推送消息</span></span><br><span class="line">logger.info(<span class="string">"解绑成功后推送消息给对应的POS机"</span>);</span><br><span class="line">LoginParam loginParam = <span class="keyword">new</span> LoginParam();</span><br><span class="line">loginParam.setUsername(managerInfo.getUsername());</span><br><span class="line">loginParam.setPassword(managerInfo.getPassword());</span><br><span class="line">HttpBaseResponse r = restTemplate.postForObject(</span><br><span class="line">        p.getPosapiUrlPrefix() + <span class="string">"/notifyLogin"</span>, loginParam, HttpBaseResponse<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="keyword">if</span> (r.isSuccess()) &#123;</span><br><span class="line">    logger.info(<span class="string">"推送消息登录认证成功"</span>);</span><br><span class="line">    String token = (String) r.getData();</span><br><span class="line">    UnbindParam unbindParam = <span class="keyword">new</span> UnbindParam();</span><br><span class="line">    unbindParam.setImei(pos.getImei());</span><br><span class="line">    unbindParam.setLocation(location);</span><br><span class="line">    <span class="comment">// 设置HTTP Header信息</span></span><br><span class="line">    URI uri;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        uri = <span class="keyword">new</span> URI(p.getPosapiUrlPrefix() + <span class="string">"/notify/unbind"</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (URISyntaxException e) &#123;</span><br><span class="line">        logger.error(<span class="string">"URI构建失败"</span>, e);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    RequestEntity&lt;UnbindParam&gt; requestEntity = RequestEntity</span><br><span class="line">            .post(uri)</span><br><span class="line">            .contentType(MediaType.APPLICATION_JSON)</span><br><span class="line">            .accept(MediaType.APPLICATION_JSON)</span><br><span class="line">            .header(<span class="string">"Authorization"</span>, token)</span><br><span class="line">            .body(unbindParam);</span><br><span class="line">    ResponseEntity&lt;HttpBaseResponse&gt; responseEntity = restTemplate.exchange(requestEntity, HttpBaseResponse<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    HttpBaseResponse r2 = responseEntity.getBody();</span><br><span class="line">    <span class="keyword">if</span> (r2.isSuccess()) &#123;</span><br><span class="line">        logger.info(<span class="string">"推送消息解绑网点成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        logger.error(<span class="string">"推送消息解绑网点失败，errmsg = "</span> + r2.getMsg());</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    logger.error(<span class="string">"推送消息登录认证失败"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-resttemplate" target="_blank" rel="noopener">springboot-resttemplate</a>    —已测试</p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="resttemplate" scheme="https://zpengit.github.io/tags/resttemplate/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot系列 - 使用AOP</title>
    <link href="https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8AOP/"/>
    <id>https://zpengit.github.io/2020/06/08/SpringBoot%E7%B3%BB%E5%88%97-%E4%BD%BF%E7%94%A8AOP/</id>
    <published>2020-06-08T02:43:16.468Z</published>
    <updated>2020-06-08T02:08:06.107Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="SpringBoot系列-使用AOP"><a href="#SpringBoot系列-使用AOP" class="headerlink" title="SpringBoot系列 - 使用AOP"></a>SpringBoot系列 - 使用AOP</h1><p>AOP（面向切面编程）是Spring的两大核心功能之一，功能非常强大，为解耦提供了非常优秀的解决方案。 现在就以springboot中aop的使用来了解一下如何使用aop。 写几个简单的Spring RESTful服务接口方法，实现方法前面或后面打印日志。</p><h2 id="AOP术语定义"><a href="#AOP术语定义" class="headerlink" title="AOP术语定义"></a>AOP术语定义</h2><p>Spring的AOP中有几个重要概念搞清楚就行</p><ul><li>执行点（Executepoint） - 类初始化，方法调用。</li><li>连接点（Joinpoint） - 执行点+方位的组合，可确定Joinpoint，比如类开始初始化前，类初始化后，方法调用前，方法调用后。</li><li>切点（Pointcut） - 在众多执行点中，定位感兴趣的执行点。Executepoint相当于数据库表中的记录，而Pointcut相当于查询条件。</li><li>增强（Advice） - 织入到目标类连接点上的一段程序代码。除了一段程序代码外，还拥有执行点的方位信息。</li><li>目标对象（Target） - 增强逻辑的织入目标类</li><li>引介（Introduction） - 一种特殊的增强（advice），它为类添加一些额外的属性和方法，动态为业务类添加其他接口的实现逻辑，让业务类成为这个接口的实现类。</li><li>代理（Proxy） - 一个类被AOP织入后，产生一个结果类，它便是融合了原类和增强逻辑的代理类。</li><li>切面（Aspect） - 切面由切点（Pointcut）和增强（Advice/Introduction）组成，既包括横切逻辑定义，也包括连接点定义。</li></ul><p>AOP工作重点：</p><ol><li>如何通过切点（Pointcut）和增强（Advice）定位到连接点（Jointpoint）上；</li><li>如何在增强（Advice）中编写切面的代码。</li></ol><h2 id="添加maven依赖"><a href="#添加maven依赖" class="headerlink" title="添加maven依赖"></a>添加maven依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jetty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="配置application-yml"><a href="#配置application-yml" class="headerlink" title="配置application.yml"></a>配置application.yml</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.port:</span> <span class="number">8092</span></span><br></pre></td></tr></table></figure><h2 id="创建Controller"><a href="#创建Controller" class="headerlink" title="创建Controller"></a>创建Controller</h2><p>没有结果返回的示例：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Description:</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/first"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">first</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"first controller"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/doError"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">error</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建切面类"><a href="#创建切面类" class="headerlink" title="创建切面类"></a>创建切面类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 日志切面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(public * com.xncoding.aop.controller.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">webLog</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deBefore</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">// 接收到请求，记录请求内容</span></span><br><span class="line">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        HttpServletRequest request = attributes.getRequest();</span><br><span class="line">        <span class="comment">// 记录下请求内容</span></span><br><span class="line">        System.out.println(<span class="string">"URL : "</span> + request.getRequestURL().toString());</span><br><span class="line">        System.out.println(<span class="string">"HTTP_METHOD : "</span> + request.getMethod());</span><br><span class="line">        System.out.println(<span class="string">"IP : "</span> + request.getRemoteAddr());</span><br><span class="line">        System.out.println(<span class="string">"CLASS_METHOD : "</span> + joinPoint.getSignature().getDeclaringTypeName() + <span class="string">"."</span> + joinPoint.getSignature().getName());</span><br><span class="line">        System.out.println(<span class="string">"ARGS : "</span> + Arrays.toString(joinPoint.getArgs()));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning</span>(returning = <span class="string">"ret"</span>, pointcut = <span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterReturning</span><span class="params">(Object ret)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        <span class="comment">// 处理完请求，返回内容</span></span><br><span class="line">        System.out.println(<span class="string">"方法的返回值 : "</span> + ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后置异常通知</span></span><br><span class="line">    <span class="meta">@AfterThrowing</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">throwss</span><span class="params">(JoinPoint jp)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法异常时执行....."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//后置最终通知,final增强，不管是抛出异常或者正常退出都会执行</span></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">(JoinPoint jp)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法最后执行....."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//环绕通知,环绕增强，相当于MethodInterceptor</span></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"webLog()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">arround</span><span class="params">(ProceedingJoinPoint pjp)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"方法环绕start....."</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Object o =  pjp.proceed();</span><br><span class="line">            System.out.println(<span class="string">"方法环绕proceed，结果是 :"</span> + o);</span><br><span class="line">            <span class="keyword">return</span> o;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="测试效果"><a href="#测试效果" class="headerlink" title="测试效果"></a>测试效果</h2><p>启动项目，执行如下mvn命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn spring-boot:run</span><br></pre></td></tr></table></figure><p>模拟正常执行的情况，访问<code>http://localhost:8092/first</code>，看控制台结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">方法环绕start.....</span><br><span class="line">URL : http:&#x2F;&#x2F;localhost:8092&#x2F;first</span><br><span class="line">HTTP_METHOD : GET</span><br><span class="line">IP : 0:0:0:0:0:0:0:1</span><br><span class="line">CLASS_METHOD : com.xncoding.aop.controller.UserController.first</span><br><span class="line">ARGS : []</span><br><span class="line">方法环绕proceed，结果是 :first controller</span><br><span class="line">方法最后执行.....</span><br><span class="line">方法的返回值 : first controller</span><br></pre></td></tr></table></figure><p>模拟出现异常时的情况，访问<code>http://localhost:8092/doError</code>，看控制台结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">方法环绕start.....</span><br><span class="line">URL : http:&#x2F;&#x2F;localhost:8092&#x2F;doError</span><br><span class="line">HTTP_METHOD : GET</span><br><span class="line">IP : 0:0:0:0:0:0:0:1</span><br><span class="line">CLASS_METHOD : com.xncoding.aop.controller.UserController.error</span><br><span class="line">ARGS : []</span><br><span class="line">java.lang.ArithmeticException: &#x2F; by zero</span><br><span class="line"></span><br><span class="line">...中间省略...</span><br><span class="line"></span><br><span class="line">方法最后执行.....</span><br><span class="line">方法的返回值 : null</span><br></pre></td></tr></table></figure><p>通过上面的简单的例子，可以看到aop的执行顺序。知道了顺序后，就可以在相应的位置做切面处理了。</p><h2 id="切面注解说明"><a href="#切面注解说明" class="headerlink" title="切面注解说明"></a>切面注解说明</h2><ul><li>@Aspect 作用是把当前类标识为一个切面供容器读取</li><li>@Pointcut 定义切点，切点方法不用任何代码，返回值是void，重要的是条件表达式</li><li>@Before 标识一个前置增强方法，相当于BeforeAdvice的功能</li><li>@AfterReturning 后置增强，相当于AfterReturningAdvice，方法退出时执行</li><li>@AfterThrowing 异常抛出增强，相当于ThrowsAdvice</li><li>@After final增强，不管是抛出异常或者正常退出都会执行</li><li>@Around 环绕增强，相当于MethodInterceptor</li></ul><p>方法参数说明：</p><p>除了@Around外，每个方法里都可以加或者不加参数JoinPoint。</p><p>JoinPoint里包含了类名、被切面的方法名，参数等属性，可供读取使用。</p><p>@Around参数必须为ProceedingJoinPoint，pjp.proceed相应于执行被切面的方法。</p><p>@AfterReturning方法里，可以加returning = “xxx”，xxx即为在controller里方法的返回值，本例中的返回值是“first controller”。</p><p>@AfterThrowing方法里，可以加throwing = “XXX”，读取异常信息，如本例中可以改为：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//后置异常通知</span></span><br><span class="line"><span class="meta">@AfterThrowing</span>(throwing = <span class="string">"ex"</span>, pointcut = <span class="string">"webLog()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">throwss</span><span class="params">(JoinPoint jp, Exception ex)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"方法异常时执行....."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一般常用的有before和afterReturn组合，或者单独使用Around，即可获取方法开始前和结束后的切面。</p><h2 id="关于切点PointCut"><a href="#关于切点PointCut" class="headerlink" title="关于切点PointCut"></a>关于切点PointCut</h2><p>execution函数用于匹配方法执行的连接点，语法为：</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(方法修饰符(可选)  返回类型  方法名  参数  异常模式(可选))</span><br></pre></td></tr></table></figure><p>参数部分允许使用通配符：</p><ol><li><ul><li>匹配任意字符，但只能匹配一个元素</li></ul></li><li>.. 匹配任意字符，可以匹配任意多个元素，表示类时，必须和*联合使用</li><li><ul><li>必须跟在类名后面，如Horseman+，表示类本身和继承或扩展指定类的所有类</li></ul></li></ol><p>除了execution()，Spring中还支持其他多个函数，这里列出名称和简单介绍</p><ol><li>@annotation() 表示标注了指定注解的目标类方法</li><li>args() 通过目标类方法的参数类型指定切点</li><li>@args() 通过目标类参数的对象类型是否标注了指定注解指定切点</li><li>within() 通过类名指定，它将匹配指定类型</li><li>target() 通过类名指定，同时包含所有子类</li><li>@within() 匹配标注了指定注解的类及其子类，必须是在目标对象上声明这个注解，在接口上声明的对它不起作用</li><li>@target() 匹配标注了指定注解的类，必须是在目标对象上声明这个注解，在接口上声明的对它不起作用</li></ol><p>逻辑运算符</p><p>表达式可由多个切点函数通过逻辑运算组成，与(&amp;&amp;)、 或(||)、 非(!)</p><p>比如<code>execution(* chop(..)) &amp;&amp; target(Horseman) 表示Horseman及其子类的chop方法</code></p><h2 id="自定义注解"><a href="#自定义注解" class="headerlink" title="自定义注解"></a>自定义注解</h2><p>一般多用于某些特定的功能，我们来自定义一个注解：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UserAccess &#123;</span><br><span class="line">    <span class="function">String <span class="title">desc</span><span class="params">()</span> <span class="keyword">default</span> "无信息"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在Controller里加个方法：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/second"</span>)</span><br><span class="line"><span class="meta">@UserAccess</span>(desc = <span class="string">"second"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">second</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"second controller"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>创建一个新的切面类：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.JoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAccessAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut</span>(value = <span class="string">"@annotation(com.xncoding.aop.aspect.UserAccess)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">access</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"access()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deBefore</span><span class="params">(JoinPoint joinPoint)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"second before"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"@annotation(userAccess)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp, UserAccess userAccess)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//获取注解里的值</span></span><br><span class="line">        System.out.println(<span class="string">"second around:"</span> + userAccess.desc());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> pjp.proceed();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>主要看一下@Around注解这里，如果需要获取在controller注解中赋给UserAccess的desc里的值，就需要这种写法，这样UserAccess参数就有值了。</p><p>执行：<code>mvn spring-boot:run</code></p><p>启动项目，访问<code>http://localhost:8092/second</code>，看控制台：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">方法环绕start.....</span><br><span class="line">URL : http:&#x2F;&#x2F;localhost:8092&#x2F;second</span><br><span class="line">HTTP_METHOD : GET</span><br><span class="line">IP : 0:0:0:0:0:0:0:1</span><br><span class="line">CLASS_METHOD : com.xncoding.aop.controller.UserController.second</span><br><span class="line">ARGS : []</span><br><span class="line">second around:second</span><br><span class="line">second before</span><br><span class="line">方法环绕proceed，结果是 :second controller</span><br><span class="line">方法最后执行.....</span><br><span class="line">方法的返回值 : second controller</span><br></pre></td></tr></table></figure><p>通知结果可以看到，两个aop切面类都工作了，顺序呢就是下面的</p><p><img src= data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs= data-src="assets/1591543646-c24a8d72523ce63c315ba2010e0a1207.png" alt=""></p><p>spring aop就是一个同心圆，要执行的方法为圆心，最外层的order最小。从最外层按照AOP1、AOP2的顺序依次执行doAround方法，doBefore方法。然后执行method方法，最后按照AOP2、AOP1的顺序依次执行doAfter、doAfterReturn方法。也就是说对多个AOP来说，先before的，一定后after。</p><p>对于上面的例子就是，先外层的就是对所有controller的切面，内层就是自定义注解的。 那不同的切面，顺序怎么决定呢，尤其是同格式的切面处理，譬如两个execution的情况，那spring就是随机决定哪个在外哪个在内了。</p><p>所以大部分情况下，我们需要指定顺序，最简单的方式就是在Aspect切面类上加上@Order(1)注解即可，order越小最先执行，也就是位于最外层。像一些全局处理的就可以把order设小一点，具体到某个细节的就设大一点。</p><h2 id="GitHub源码"><a href="#GitHub源码" class="headerlink" title="GitHub源码"></a>GitHub源码</h2><p><a href="https://github.com/yidao620c/SpringBootBucket/tree/master/springboot-aop" target="_blank" rel="noopener">springboot-aop</a>   —已测试</p><h2 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h2><p><a href="https://www.xncoding.com/" target="_blank" rel="noopener">https://www.xncoding.com/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
    
      <category term="SpringBoot" scheme="https://zpengit.github.io/categories/SpringBoot/"/>
    
    
      <category term="springboot" scheme="https://zpengit.github.io/tags/springboot/"/>
    
      <category term="aop" scheme="https://zpengit.github.io/tags/aop/"/>
    
  </entry>
  
</feed>
